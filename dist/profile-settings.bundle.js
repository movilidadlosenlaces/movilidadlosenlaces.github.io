var ProfileSettings=function(){var e,a,t,n,s,r,d,l,i,o,c,u,p,m,h,v,f,C,g=$("#page-loader"),y=$("#hasPassword"),b={UpdateAccessSettings:"/api/User/UpdateAccessSettings",SetPassword:"/api/User/SetPassword",ChangeLanguage:"/api/User/UpdateLanguage",GetLicenseType:"/api/User/GetLicenseType",UpdateInvoiceData:"/api/User/UpdateInvoiceData",FetchInvoiceData:"/api/User/FetchInvoiceData"},w=function(){g.show()},T=function(){g.hide()},x=function(){function e(e){e?localStorage.setItem("checkAccountActive-"+a,"active"):(notify.message=locale.panel.accountNotActive,notify.type="inverse",notify.delay=1e4,notify.show())}var a=$("#idUser").val(),t=localStorage.getItem("checkAccountActive-"+a);null===t&&ApiGenially.executeCall("",b.checkAccountConfirmed,"GET",e)},k=function(){var e=navigator.language?navigator.language:navigator.userLanguage;moment.locale(e)},F=function(){$(window).scroll(function(e){var a=$(window).scrollTop();a>=200?$("div.scrollTop").fadeIn():a<200&&$("div.scrollTop").fadeOut()}),$("#scrollTop").on("click",function(e){$("html, body").animate({scrollTop:0},"slow")})},I=function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})},E=function(){function n(){setTimeout(function(){d.removeClass("bg-palette-blue").addClass("bgm-green"),d.find(".preloader").addClass("hidden"),d.find(".update-text").addClass("hidden"),d.find(".access-updated-text").removeClass("hidden"),setTimeout(function(){d.removeClass("bgm-green").addClass("bg-palette-blue"),d.find(".update-text").removeClass("hidden"),d.find(".access-updated-text").addClass("hidden"),d.removeClass("disabled")},1500)},800)}function r(){d.removeClass("bg-palette-blue").addClass("bgm-red"),d.find(".preloader").addClass("hidden"),d.find(".update-error").removeClass("hidden"),s.children(".password-mismatch").hide(),s.children(".update-error").show(),s.show(),setTimeout(function(){d.removeClass("bgm-red").addClass("bg-palette-blue"),d.find(".update-text").removeClass("hidden"),d.find(".update-error").addClass("hidden"),d.find(".access-updated-text").addClass("hidden"),d.removeClass("disabled")},1500)}var d=$(this),l=!1;if(""===e.val()?(e.parent().parent().addClass("has-error"),l=!0):e.parent().parent().hasClass("has-error")&&e.parent().parent().removeClass("has-error"),""===a.val()?(a.parent().parent().addClass("has-error"),l=!0):a.parent().parent().hasClass("has-error")&&a.parent().parent().removeClass("has-error"),""===t.val()?(t.parent().parent().addClass("has-error"),l=!0):t.parent().parent().hasClass("has-error")&&t.parent().parent().removeClass("has-error"),!l){if(a.val()!==t.val())return s.children(".password-mismatch").show(),s.children(".update-feedback").hide(),void s.show();s.hide(),d.addClass("disabled"),d.find(".preloader").removeClass("hidden"),d.find(".update-text").addClass("hidden");var i={OldPassword:e.val().trim(),NewPassword:a.val().trim(),ConfirmPassword:t.val().trim()};ApiGenially.executeCall(i,b.UpdateAccessSettings,"POST",n,r)}},P=function(){function e(){setTimeout(function(){r.removeClass("bg-palette-blue").addClass("bgm-green"),r.find(".preloader").addClass("hidden"),r.find(".update-text").addClass("hidden"),r.find(".access-updated-text").removeClass("hidden"),setTimeout(function(){r.removeClass("bgm-green").addClass("bg-palette-blue"),r.find(".update-text").removeClass("hidden"),r.find(".access-updated-text").addClass("hidden"),r.removeClass("disabled")},1500)},800)}function n(){r.removeClass("bg-palette-blue").addClass("bgm-red"),r.find(".preloader").addClass("hidden"),r.find(".update-error").removeClass("hidden"),s.children(".password-mismatch").hide(),s.children(".update-error").show(),s.show(),setTimeout(function(){r.removeClass("bgm-red").addClass("bg-palette-blue"),r.find(".update-text").removeClass("hidden"),r.find(".update-error").addClass("hidden"),r.find(".access-updated-text").addClass("hidden"),r.removeClass("disabled")},1500)}var r=$(this),d=!1;if(""===a.val()?(a.parent().parent().addClass("has-error"),d=!0):a.parent().parent().hasClass("has-error")&&a.parent().parent().removeClass("has-error"),""===t.val()?(t.parent().parent().addClass("has-error"),d=!0):t.parent().parent().hasClass("has-error")&&t.parent().parent().removeClass("has-error"),!d){if(a.val()!==t.val())return s.children(".password-mismatch").show(),s.children(".update-feedback").hide(),void s.show();s.hide(),r.addClass("disabled"),r.find(".preloader").removeClass("hidden"),r.find(".update-text").addClass("hidden");var l={NewPassword:a.val().trim(),ConfirmPassword:t.val().trim()};ApiGenially.executeCall(l,b.SetPassword,"POST",e,n)}},S=function(){var e=r.val();if("es"===e||"en"===e||"fr"===e){var a=new Date;a.setDate(a.getDate()+1e3),document.cookie="gen.lang="+e+"; expires="+a+"; path=/",locale=window.languageResources[fromShortToLongLanguage(e)],swal({title:locale.profile.LanguageProfileTitle,text:locale.profile.LanguageProfileDescription+"\n\r\n\r"+locale.profile.LanguageProfileDescriptionSub,type:"success"},function(){location.reload()})}},D=function(){"es-ES"===C?r.selectpicker("val","es"):"en-US"===C?r.selectpicker("val","en"):"fr-FR"===C?r.selectpicker("val","fr"):r.selectpicker("val","en")},L=function(e){var a=[locale.licenseFeatures.freeFeatures.Unlimited],t=a.concat([locale.licenseFeatures.proFeatures.Download,locale.licenseFeatures.proFeatures.Templates,locale.licenseFeatures.proFeatures.Privacidad,locale.licenseFeatures.proFeatures.ExtraFeatures]),n=t.concat([locale.licenseFeatures.masterFeatures.Watermark,locale.licenseFeatures.masterFeatures.Statistics,locale.licenseFeatures.masterFeatures.Transfer,locale.licenseFeatures.masterFeatures.Training]),s=n.concat([locale.licenseFeatures.teamFeatures.DesignSupport]),r=t,d=r.concat([locale.licenseFeatures.eduTeamFeatures.Training]);
// Display License features in the current language
switch(e){case 1:return a;case 2:return t;case 3:return n;case 4:return r;case 5:return d;case 6:return s}},A=function(){function e(e){var a="";switch(e.LicenseRecurrent){case 1:a=locale.recurrentPaymentTypeMonthly;break;case 2:a=locale.recurrentPaymentTypeAnnual}
// Set the License Type Name
switch(e.LicenseType){case 1:l.html(locale.licenseTypeName.free),o.remove(),u.hide();break;case 2:l.html(locale.licenseTypeName.pro+" "+a);break;case 3:l.html(locale.licenseTypeName.master+" "+a);break;case 4:l.html(locale.licenseTypeName.edu+" "+a);break;case 5:l.html(locale.licenseTypeName.eduTeam+" "+a);break;case 6:l.html(locale.licenseTypeName.team+" "+a);break;default:l.html(locale.licenseTypeName.free),o.remove(),u.hide()}switch(e.PaymentChannel){case 0:o.remove(),$("#update-payment-card").remove();break;case 1:/* 
                     * Check if this license will be canceled because the user
                     * Already tried (and succeded) to cancel this license previously.
                     */
e.WillBeCanceled&&(/*
                         * If this is true, then, we should remove the
                         * Cancel License Button to avoid user clicking onto it again.
                         */
o.remove(),c.remove(),$("#panel-valid-until").show(),$("#cancel-valid-until").html(new Date(e.ValidUntil).toLocaleDateString()));var t=function(e){function a(){return $.ajax({url:"/License/CancelSubscription",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json"})}function t(e){""!==e&&(notify.message=locale.panel.expiredTime+e+". ",notify.type="success",notify.delay=5e3,notify.show(),c.removeClass("disabled"))}function n(e){notify.message=locale.generic.mErrorProcessingMessage,notify.type="danger",notify.show(),c.removeClass("disabled")}e.preventDefault(),c.addClass("disabled"),a().done(t).fail(n)};c.attr("href","#"),c.click(t);break;case 2:
// Redirect to cancel paypal license page
c.attr("href","/License/Cancel"),$("#update-payment-card").remove()}
// Set the License Expiry Date
var n=new Date(e.ExpiryDate),s=new Date("01/01/2000");n<s?u.hide():i.html(new Date(e.ExpiryDate).toLocaleDateString());
// Generate the License Type
var r=L(e.LicenseType);r.forEach(function(e){d.append("<li>"+e+"</li>")})}ApiGenially.executeCall("",b.GetLicenseType,"GET",e)},B=function(){function e(){setTimeout(function(){t.removeClass("bg-palette-blue").addClass("bgm-green"),t.find(".preloader").addClass("hidden"),t.find(".update-invoice-text").addClass("hidden"),t.find(".invoice-updated-text").removeClass("hidden"),setTimeout(function(){t.removeClass("bgm-green").addClass("bg-palette-blue"),t.find(".update-invoice-text").removeClass("hidden"),t.find(".invoice-updated-text").addClass("hidden"),t.removeClass("disabled")},1500)},800)}function a(){t.removeClass("bg-palette-blue").addClass("bgm-red"),t.find(".preloader").addClass("hidden"),t.find(".update-invoice-error").removeClass("hidden"),setTimeout(function(){t.removeClass("bgm-red").addClass("bg-palette-blue"),t.find(".update-invoice-text").removeClass("hidden"),t.find(".update-invoice-error").addClass("hidden"),t.find(".invoice-updated-text").addClass("hidden"),t.removeClass("disabled")},1500)}var t=$(this),n=!1;if(""===p.val()?(p.parent().parent().addClass("has-error"),n=!0):p.parent().parent().hasClass("has-error")&&p.parent().parent().removeClass("has-error"),""===m.val()?(m.parent().parent().addClass("has-error"),n=!0):m.parent().parent().hasClass("has-error")&&m.parent().parent().removeClass("has-error"),""===h.val()?(h.parent().parent().addClass("has-error"),n=!0):h.parent().parent().hasClass("has-error")&&h.parent().parent().removeClass("has-error"),""===v.val()||null===v.val()?(v.parent().parent().next().removeClass("hidden"),n=!0):v.parent().parent().next().addClass("hidden"),!n){t.addClass("disabled"),t.find(".preloader").removeClass("hidden"),t.find(".update-invoice-text").addClass("hidden");var s={Name:p.val(),Cif:m.val(),Address:h.val(),Country:v.val()};ApiGenially.executeCall(s,b.UpdateInvoiceData,"POST",e,a)}},U=function(){"1"===y.val()?n.click(E):n.click(P),r.on("changed.bs.select",S),f.click(B)},G=function(){function e(e){p.val(e.Name),h.val(e.Address),m.val(e.Cif),v.val(e.Country),v.selectpicker("val",e.Country)}ApiGenially.executeCall("",b.FetchInvoiceData,"GET",e)},N=function(){w(),e=$(document.getElementById("account-current-password")),a=$(document.getElementById("account-new-password")),t=$(document.getElementById("account-again-password")),n=$(document.getElementById("account-update")),s=$(document.getElementById("error-feeback")).hide(),r=$(document.getElementById("account-language")),
// License Features Related Fields
d=$(document.getElementById("license-features")),l=$(".license-type-name"),i=$(document.getElementById("license-type-expiry")),o=$(document.getElementById("panel-cancel")),c=$(document.getElementById("button-cancel-final")),u=$(document.getElementById("license-expiry-block")),p=$(document.getElementById("invoice-business")),m=$(document.getElementById("invoice-tax-number")),h=$(document.getElementById("invoice-address")),v=$(document.getElementById("invoice-country")),f=$(document.getElementById("update-invoice-data")),helper.beautifulInputText(),helper.wavesButtons(),k(),F(),I(),r.selectpicker(),v.selectpicker(),U(),$(".contracted-logo").click(function(){$("html, body").animate({scrollTop:0},"slow")}),C=language,D(),A(),G(),setTimeout(function(){T()},300)};return{initialize:N,showLoader:w,hideLoader:T,checkAccountConfirmed:x}}();$(document).ready(function(){ProfileSettings.initialize();var e=$(window).scrollTop(),a=$("#header");e>20&&a.addClass("contracted"),e>180&&a.children(".brand").addClass("contracted")}),$(window).scroll(function(){var e=$(window).scrollTop(),a=$("#header");e>20?a.addClass("contracted"):a.removeClass("contracted"),e>180?a.children(".brand").addClass("contracted"):a.children(".brand").removeClass("contracted")});