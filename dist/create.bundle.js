var Panel=function(){var e,a,t=$("#page-loader"),s=$("#sectorChooser"),l=$(document.getElementById("preview-genially")),i=document.getElementById("displayPresentations"),n=document.getElementById("displayPosters"),o=document.getElementById("displayInfographics"),c=document.getElementById("displayInteractive"),d=document.getElementById("displayECard"),r=document.getElementById("displayCVs"),p=document.getElementById("displayCalendars"),m=document.getElementById("displayPhotoAlbums"),u=document.getElementById("displayMaps"),v=document.getElementById("displayCollages"),f=document.getElementById("displayGalleries"),y=document.getElementById("displayEducationType"),g=document.getElementById("displayInteractives"),h=$(document.getElementById("displayAll")),b=$(document.getElementById("displayProfessional")),C=$(document.getElementById("displayEducation")),w=$(document.getElementById("displayGeneral")),k=$(document.getElementById("displayNew")),I=$(document.getElementById("content-filters")),E=$("#create-geniallys"),G=[],P=[],B=[],T=[],U=[],x=[],F=[],S=[],O=[],L=[],A=[],D=[],z=$("#presentations"),V=$("#posters"),H=$("#infographics"),N=$("#interactiveImage"),R=$("#ecards"),_=$("#cvs"),M=$("#calendars"),j=$("#photo-albums"),q=$("#maps"),J=$("#collages"),K=$("#galleries"),Q=$("#edus"),W=$("#interactive-design"),X=$(".sector-selector"),Y=$("#validateSectorChoose"),Z="presentations",ee="all",ae=$(".type-creation"),te=$(".filter-type"),se={duplicateGenially:"/api/Panel/DuplicateGenially",removeGenially:"/api/Panel/RemoveGenially",transferGenially:"/api/Panel/TransferGenially",checkAccountConfirmed:"/api/User/CheckUserIsConfirmed",checkUpdatePolicy:"/api/User/UpdatePolicy",checkGeniallyOcupied:"/api/Panel/CheckGeniallyOcupied",updateSectorInfor:"/api/User/UpdateSectorInfo",getSectorStatus:"/api/User/GetSectorStatus"},le=function(e){setTimeout(function(){e.find(".lazy").lazyload({skip_invisible:!1,threshold:4e3})},400)},ie=function(){e.attr("href","/Panel/DirectCreate?type="+Z)},ne=function(){E.find(".fadeInUp").removeClass("fadeInUp").addClass("fadeOutDown").delay(800).removeClass("visible"),ee="all",Le("displayAll"),te.removeClass("active"),h.addClass("active"),"interactive"!==Z&&ie()},oe=function(){t.show()},ce=function(){t.hide()},de=function(){function e(e){e?localStorage.setItem("checkAccountActive-"+a,"active"):(notify.message=locale.panel.accountNotActive,notify.type="inverse",notify.delay=1e4,notify.show())}var a=$("#idUser").val(),t=localStorage.getItem("checkAccountActive-"+a);null===t&&ApiGenially.executeCall("",se.checkAccountConfirmed,"GET",e)},re=function(){var e=$("#policy").val();"v1"!==e&&(notify.delay=2e7,notify.message=locale.panel.accountPolicy,notify.type="inverse",notify.show(),$("#render-body").css({opacity:.1,"pointer-events":"none","user-select":"none"}),$(document).on("click",".accept-button",function(){function e(){$("#render-body").css({opacity:1,"pointer-events":"","user-select":""}),$(".alert").fadeOut()}ApiGenially.executeCall("",se.checkUpdatePolicy,"PUT",e)}))},pe=function(){function e(e){var a=$("#thumbPreview"),t=$("#dropperText"),s=$("#createImageHolder");if(e.stopPropagation(),e.preventDefault(),"drop"===e.type)var l=e.dataTransfer.files;else var l=e.target.files;if(l.length>1)return s.fadeOut(),a.css("background-color","#FFFFFF"),a.css("background-image","none"),void t.fadeIn();t.fadeOut();for(var i,n=0;i=l[n];n++)if(i.type.match("image.*")&&!i.type.match("image/svg.*")){var o=new FileReader;o.onload=function(e){return function(e){a.css("background-image","url("+e.target.result+")"),a.data("base",e.target.result),$("#imageToCreate").val(e.target.result)}}(i),o.readAsDataURL(i),$("#createImageHolder").fadeIn()}else $("#createImageHolder").fadeOut(),a.css("background-color","#FFFFFF;"),a.css("background-image","none"),t.fadeIn()}function a(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}var t=document.getElementById("imageDropper");t.addEventListener("dragover",a,!1),t.addEventListener("drop",e,!1),document.getElementById("dropFile").addEventListener("change",e,!1)},me=function(){function e(e){null===e||""===e?(s.addClass("fadeIn"),s.show(),s.find(".chooser-modal").addClass("bounceIn"),localStorage.setItem("new-sector-"+a,e)):(s.remove(),localStorage.setItem("new-sector-"+a,e))}var a=$("#idUser").val();null===localStorage.getItem("new-sector-"+a)||"null"===localStorage.getItem("new-sector-"+a)?ApiGenially.executeCall("",se.getSectorStatus,"GET",e):s.remove()},ue=function(){$(".sector-selector").removeClass("active"),$(this).addClass("active"),Y.addClass("selected-active"),ve(),setTimeout(function(){ve()},500)},ve=function(){function e(e){setTimeout(function(){var e=$("#sectorChooser");e.addClass("fadeOut"),e.remove(),e.find(".chooser-modal").addClass("bounceOut")},1e3)}var a=$(".sector-selector.active").length;if(0!==a){a=$(".sector-selector.active").attr("sector");var t={sector:a};ApiGenially.executeCall(t,se.updateSectorInfor,"POST",e)}},fe=function(){try{ga("send","event","FromCustom","ImageInteractive","ImageInteractive")}catch(e){}$(this).html('<div class="preloader pls-white"><svg class="pl-circular" viewBox="25 25 50 50"><circle class="plc-path" cx="50" cy="50" r="20"/></svg></div>'),$(this).css({"pointer-events":"none"})},ye=function(){try{ga("send","event","FromPlantillaFree",Z,$("#preview-genially").find("#idGeniallyTemplate").val())}catch(e){}},ge=function(){try{ga("send","event","FromPlantillaPayment",Z,$(this).attr("data-id"))}catch(e){}},he=function(){try{ga("send","event","FromPlantillaFree",Z,$(this).attr("data-id"))}catch(e){}},$e=function(){try{ga("send","event","FromPlantillaPayment",Z,$("#preview-genially").find("#idGeniallyTemplateToBuy").val())}catch(e){}},be=function(){var e=navigator.language?navigator.language:navigator.userLanguage;moment.locale(e)},Ce=function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})},we=function(){"presentations"!==Z&&(Z="presentations",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(i).addClass("active"),ne(),z.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(z),I.show())},ke=function(){"infographics"!==Z&&(Z="infographics",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(o).addClass("active"),ne(),H.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(H),I.show())},Ie=function(){"posters"!==Z&&(Z="posters",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(n).addClass("active"),ne(),V.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(V),I.show())},Ee=function(){"interactive"!==Z&&(Z="interactive",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(c).addClass("active"),ne(),N.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),I.hide())},Ge=function(){"edu"!==Z&&(Z="edu",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(y).addClass("active"),ne(),Q.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(Q),I.hide())},Pe=function(){"interactives-design"!==Z&&(Z="interactives-design",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(g).addClass("active"),ne(),W.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(W),I.show())},Be=function(){"ecard"!==Z&&(Z="ecard",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(d).addClass("active"),ne(),R.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(R),I.show())},Te=function(){"cvs"!==Z&&(Z="cvs",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(r).addClass("active"),ne(),_.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(_),I.show())},Ue=function(){"calendars"!==Z&&(Z="calendars",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(p).addClass("active"),ne(),M.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(M),I.show())},xe=function(){"photo-albums"!==Z&&(Z="photo-albums",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(m).addClass("active"),ne(),j.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(j),I.show())},Fe=function(){"maps"!==Z&&(Z="maps",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(u).addClass("active"),ne(),q.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(q),I.show())},Se=function(){"collages"!==Z&&(Z="collages",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(v).addClass("active"),ne(),J.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(J))},Oe=function(){"galleries"!==Z&&(Z="galleries",$("#create-geniallys").find(".flex-container").removeClass("visible"),ae.removeClass("active"),$(f).addClass("active"),ne(),K.removeClass("fadeOutDown").addClass("fadeInUp").delay(800).addClass("visible"),le(K),I.show())},Le=function(e){switch(e){case"displayAll":h.addClass("active"),k.removeClass("active"),b.removeClass("active"),C.removeClass("active"),w.removeClass("active"),ee="all";break;case"displayProfessional":b.addClass("active"),k.removeClass("active"),h.removeClass("active"),C.removeClass("active"),w.removeClass("active"),ee="professional";break;case"displayEducation":C.addClass("active"),k.removeClass("active"),b.removeClass("active"),h.removeClass("active"),w.removeClass("active"),ee="education";break;case"displayGeneral":w.addClass("active"),k.removeClass("active"),b.removeClass("active"),C.removeClass("active"),h.removeClass("active"),ee="general";break;case"displayNew":k.addClass("active"),w.removeClass("active"),b.removeClass("active"),C.removeClass("active"),h.removeClass("active"),ee="new";break;default:return}switch(Z){case"presentations":"all"===ee?$("#presentations").find("[template-subcategory]").show():"new"===ee?($("#presentations").find("[template-subcategory]").hide(),$("#presentations").find(".new-template").show()):($("#presentations").find("[template-subcategory]").hide(),$("#presentations").find("[template-subcategory*="+ee+"]").show());break;case"infographics":"all"===ee?$("#infographics").find("[template-subcategory]").show():"new"===ee?($("#infographics").find("[template-subcategory]").hide(),$("#infographics").find(".new-template").show()):($("#infographics").find("[template-subcategory]").hide(),$("#infographics").find("[template-subcategory*="+ee+"]").show());break;case"posters":"all"===ee?$("#posters").find("[template-subcategory]").show():"new"===ee?($("#posters").find("[template-subcategory]").hide(),$("#posters").find(".new-template").show()):($("#posters").find("[template-subcategory]").hide(),$("#posters").find("[template-subcategory*="+ee+"]").show());break;case"ecard":"all"===ee?$("#ecards").find("[template-subcategory]").show():"new"===ee?($("#ecards").find("[template-subcategory]").hide(),$("#ecards").find(".new-template").show()):($("#ecards").find("[template-subcategory]").hide(),$("#ecards").find("[template-subcategory*="+ee+"]").show());break;case"cvs":"all"===ee?$("#cvs").find("[template-subcategory]").show():"new"===ee?($("#cvs").find("[template-subcategory]").hide(),$("#cvs").find(".new-template").show()):($("#cvs").find("[template-subcategory]").hide(),$("#cvs").find("[template-subcategory*="+ee+"]").show());break;case"calendars":"all"===ee?$("#calendars").find("[template-subcategory]").show():"new"===ee?($("#calendars").find("[template-subcategory]").hide(),$("#calendars").find(".new-template").show()):($("#calendars").find("[template-subcategory]").hide(),$("#calendars").find("[template-subcategory*="+ee+"]").show());break;case"photo-albums":"all"===ee?$("#photo-albums").find("[template-subcategory]").show():"new"===ee?($("#photo-albums").find("[template-subcategory]").hide(),$("#photo-albums").find(".new-template").show()):($("#photo-albums").find("[template-subcategory]").hide(),$("#photo-albums").find("[template-subcategory*="+ee+"]").show());break;case"maps":"all"===ee?$("#maps").find("[template-subcategory]").show():"new"===ee?($("#maps").find("[template-subcategory]").hide(),$("#maps").find(".new-template").show()):($("#maps").find("[template-subcategory]").hide(),$("#maps").find("[template-subcategory*="+ee+"]").show());break;case"collages":"all"===ee?$("#collages").find("[template-subcategory]").show():"new"===ee?($("#collages").find("[template-subcategory]").hide(),$("#collages").find(".new-template").show()):($("#collages").find("[template-subcategory]").hide(),$("#collages").find("[template-subcategory*="+ee+"]").show());break;case"galleries":"all"===ee?$("#galleries").find("[template-subcategory]").show():"new"===ee?($("#galleries").find("[template-subcategory]").hide(),$("#galleries").find(".new-template").show()):($("#galleries").find("[template-subcategory]").hide(),$("#galleries").find("[template-subcategory*="+ee+"]").show());break;case"edu":"all"===ee?$("#edus").find("[template-subcategory]").show():"new"===ee?($("#edus").find("[template-subcategory]").hide(),$("#edus").find(".new-template").show()):($("#edus").find("[template-subcategory]").hide(),$("#edus").find("[template-subcategory*="+ee+"]").show());break;case"interactives-design":"all"===ee?$("#interactive-design").find("[template-subcategory]").show():"new"===ee?($("#interactive-design").find("[template-subcategory]").hide(),$("#interactive-design").find(".new-template").show()):($("#interactive-design").find("[template-subcategory]").hide(),$("#interactive-design").find("[template-subcategory*="+ee+"]").show());break;default:return}},Ae=function(){var e=$(this).attr("id");Le(e)},De=function(){$(".owl-carousel").owlCarousel({loop:!1,margin:0,nav:!0,dots:!1,responsiveClass:!0,responsive:{0:{items:1},600:{items:3},1e3:{items:6}}})},ze=function(){$("#preview-genially").on("show.bs.modal",function(e){var a=(e.relatedTarget.attributes["preview-id"].value,e.relatedTarget.attributes["template-id"].value),t=e.relatedTarget.attributes["to-buy"].value,s=e.relatedTarget.attributes["template-name"].value,i=e.relatedTarget.attributes["template-price"].value;l.find(".modal-title").html(s),l.find(".modal-body").html(""),l.find("#template-price-button").text(i+" €");var n=$("#typeSubscription").val();if("true"===t)if("1"===n){var o="/Buy/Index?id="+a;l.find("#previewButtonPurchase").attr("href",o).show(),l.find("#previewButtonPurchase").attr("data-id",a),l.find("#previewButtonUse").hide(),l.find("#goToPurchaseLicense").show()}else{l.find("#previewButtonPurchase").hide();var c="/Panel/CreateFromTemplateV2?idGeniallyTemplate="+a;l.find("#previewButtonUse").attr("href",c).show(),l.find("#previewButtonUse").attr("data-id",a)}else{l.find("#previewButtonPurchase").hide(),l.find("#goToPurchaseLicense").hide();var d="/Panel/CreateFromTemplateV2?idGeniallyTemplate="+a;l.find("#previewButtonUse").attr("href",d).show(),l.find("#previewButtonUse").attr("data-id",a)}}),$("#preview-genially").on("shown.bs.modal",function(e){var a=e.relatedTarget.attributes["preview-id"].value,t='<div style="width: 100%;"><div style="padding-bottom: 66.67%; padding-top: 0; height: 0;"><iframe frameborder="0" width="1200" height="800" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="/View/Index/{{$idGenially}}" type="text/html" allowscriptaccess="always" allowfullscreen="true" scrolling="yes" allownetworking="all"></iframe></div></div>';t=t.replace("{{$idGenially}}",a),l.find(".modal-body").html("").append(t)})},Ve=function(a,t){function s(e){return t(!0)}function l(t){var s=$("#typeSubscription").val();return $.each(t,function(e,a){switch(a.TypeSubscription=s,a.TemplateType){case"template-presentation":P.push(a);break;case"template-infographics":G.push(a);break;case"template-eposter":B.push(a);break;case"template-ecard":T.push(a);break;case"template-cvs":U.push(a);break;case"template-calendars":x.push(a);break;case"template-photoalbums":F.push(a);break;case"template-maps":S.push(a);break;case"template-collages":O.push(a);break;case"template-galleries":L.push(a);break;case"template-edu":A.push(a);break;case"template-interactive":D.push(a)}}),z.html(Genially.templates.template(P)),H.html(Genially.templates.template(G)),H.find(".create-blank").addClass("poster-infograph"),V.html(Genially.templates.template(B)),V.find(".create-blank").addClass("poster-infograph"),R.html(Genially.templates.template(T)),_.html(Genially.templates.template(U)),M.html(Genially.templates.template(x)),j.html(Genially.templates.template(F)),q.html(Genially.templates.template(S)),J.html(Genially.templates.template(O)),K.html(Genially.templates.template(L)),Q.html(Genially.templates.template(A)),W.html(Genially.templates.template(D)),e=$(".link-to-create"),a(!0)}var i={language:languageShort};ApiGenially.executeCall(i,"/api/Panel/GetAllTemplates","GET",l,s)},He=function(){$("#createInteractiveImage").click(fe),$(document).on("click",".statisticsLink",oe),X.click(ue),Y.click(ve),$("#previewButtonUse").click(ye),$("#previewButtonPurchase").click($e),$(document).on("click",".buy-click",ge),$(document).on("click",".use-click",he),i.addEventListener("click",we),o.addEventListener("click",ke),n.addEventListener("click",Ie),c.addEventListener("click",Ee),d.addEventListener("click",Be),y.addEventListener("click",Ge),g.addEventListener("click",Pe),r.addEventListener("click",Te),p.addEventListener("click",Ue),m.addEventListener("click",xe),u.addEventListener("click",Fe),v.addEventListener("click",Se),f.addEventListener("click",Oe),h.click(Ae),k.click(Ae),C.click(Ae),b.click(Ae),w.click(Ae),ze()},Ne=function(){$(".link-to-create").click(function(){try{ga("send","event","FromPlantillaFree",Z,Z)}catch(e){}})},Re=function(){Ve(function(e,a){e&&(z.find(".lazy").lazyload({skip_invisible:!1,threshold:2e3}),$(i).addClass("active"),z.addClass("visible"),Ne())}),s.hide(),helper.beautifulInputText(),helper.wavesButtons(),be(),Ce(),He(),pe(),$(document).on("click",".share-genially",function(){var e=$(this).data("id-genially");Share.shareGenially(e)}),$(".work-link").click(function(){window.open($(this).data("link"),"_blank")}),me(),Share.init(),$(".contracted-logo").click(function(){$("html, body").animate({scrollTop:0},"slow")}),De(),ce(),de(),re(),a=languageShort};return{initialize:Re,checkAccountConfirmed:de,checkAccountPolicy:re,showLoader:oe}}();