function currentMousePosAtImgInPX(){var e={x:0,y:0},t=$(".current-slide").find(".slide-page"),a=t.width(),n=t.height(),i=watching.scale,l=currentMousePos.x-t.offset().left,r=currentMousePos.y-t.offset().top;return e.x=Math.round(l/i),e.y=Math.round(r/i),e.x<0?e.x=0:e.x>a&&(e.x=a),e.y<0?e.y=0:e.y>n&&(e.y=n),e}function userLanguage(){navigator.language?navigator.language:navigator.userLanguage}function saveSelection(){if(window.getSelection){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount&&""!==sel.toString())return sel.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}function selectElementContents(e){var t=document.createRange();t.selectNodeContents(e);var a=window.getSelection();a.removeAllRanges(),a.addRange(t)}function restoreSelection(e){if(e)window.getSelection?(sel=window.getSelection(),sel.removeAllRanges(),sel.addRange(e)):document.selection&&e.select&&e.select();else if(0===Multidrag.countElements()){var t=$("#"+currentData.IdItem),a=t.find(".text-div")[0];if(!a)return;$(t).find(".text-div").attr("contenteditable","true"),selectElementContents(a),setTimeout(function(){sel=window.getSelection(),sel.removeAllRanges()},100)}}function removeDiacritics(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return diacriticsMap[e]||e})}function callbackFitJs(e,t){}var CustomFont=function(){var e=$("#textFontFamily"),t="/api/Custom/GetFonts",a="/api/Custom/GetPublicFonts",n=null,i=function(e){e.forEach(function(e){var t=document.createElement("style");t.appendChild(document.createTextNode("                    @font-face {                        font-family: "+e.Name+";                        src: url('"+e.UrlFont+"') format('"+e.Format+"');                    }            ")),document.head.appendChild(t)})},l=function(){if(n.length>0){var t='<ul id="custom-font-container" class="customFontContainer" role="option">';n.forEach(function(e){t=t+'<li class="customFont" data-font="'+e.Name+'" style="font-family: '+e.Name+';">'+e.DisplayName+"<li>"}),t+="</ul>",e.find('[role="listbox"]').prepend(t),$(".customFont").click(function(){var e=$(this).data("font");ToolbarText.activeFonts(e)})}},r=function(e){function r(){return $.ajax({url:t,type:"GET",contentType:"application/json; charset=utf-8"})}function o(e){n=e,i(n),l(n)}function s(){}function d(){return $.ajax({url:t,type:"GET",contentType:"application/json; charset=utf-8"})}function c(e){n=e,i(n)}function u(){}function p(){return $.ajax({data:{idUser:dataGenially.IdUser},url:m,type:"GET",contentType:"application/json; charset=utf-8"})}function g(e){n=e,i(n)}function f(){}if("editor"!==e||3!==typeSubscriptionUser&&6!==typeSubscriptionUser){if("panel"===e)d().done(c).fail(u);else if(3===dataGenially.TypeSubscription||6===dataGenially.TypeSubscription){var m="";m="yes"===$("#isView").val()?a:t,p().done(g).fail(f)}}else r().done(o).fail(s)};return{loadCustomFonts:r,loadEditorCustomFonts:l}}(),CustomColors=function(){var e="/api/Custom/GetColors",t=[],a=[["#000001","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],n=function(n){function i(){return $.ajax({url:e,type:"GET",contentType:"application/json; charset=utf-8"})}function l(e){e.forEach(function(e){t.push(e.Color)});var i=8,l=[];if(0===t.length)return n(!0);for(;t.length>0;)l.push(t.splice(0,i));return l.reverse(),l.forEach(function(e){a.unshift(e)}),n(!0)}function r(){return n(!0)}return 3!==typeSubscriptionUser&&6!==typeSubscriptionUser?n(!0):void i().done(l).fail(r)},i=function(){return a};return{loadCustomColors:n,getCustomColors:i}}(),currentMousePos={x:-1,y:-1};$(document).mousemove(function(e){currentMousePos.x=e.pageX,currentMousePos.y=e.pageY}),navigator.sayswho=function(){var e,t=navigator.userAgent,a=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(a[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE-"+(e[1]||"")):"Chrome"===a[1]&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),null!=e)?e.slice(1).join("-").replace("OPR","Opera"):(a=a[2]?[a[1],a[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&a.splice(1,1,e[1]),a.join("-"))}();var guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}();jQuery.fn.selectText=function(){var e=document,t=this[0];if(e.body.createTextRange){var a=document.body.createTextRange();a.moveToElementText(t),a.select()}else if(window.getSelection){var n=window.getSelection(),a=document.createRange();a.selectNodeContents(t),n.removeAllRanges(),n.addRange(a)}},jQuery.fn.pressEnter=function(e){return this.each(function(){$(this).bind("enterPress",e),$(this).keyup(function(e){13===e.keyCode&&$(this).trigger("enterPress")})})},!function(e){e.fn.classes=function(t){var a=[];if(e.each(this,function(e,t){var n=t.className.split(/\s+/);for(var i in n){var l=n[i];-1===a.indexOf(l)&&a.push(l)}}),"function"==typeof t)for(var n in a)t(a[n]);return a}}(jQuery);var PageTransitions=function(){function e(){function e(){return s=$(this).data("id"),70!==s&&68!==s&&74!==s&&75!==s&&(!u&&(s>70&&(s=1),t(s),void++s))}function a(){}o.each(function(){var e=$(this);e.data("originalClassList",e.attr("class"))}),o.eq(c).addClass("pt-page-current"),$(".effect-slide").hoverIntent(e,a)}function t(e){var t=e.animation?e.animation:parseInt(e);if(u)return!1;u=!0,i=o.eq(c),e.showPage?c=e.showPage<d-1?e.showPage:0:c<d-1?++c:c=0;var n=o.eq(c).addClass("pt-page-current"),r="",s="";switch(t){case 1:r="pt-page-moveToLeft",s="pt-page-moveFromRight";break;case 2:r="pt-page-moveToRight",s="pt-page-moveFromLeft";break;case 3:r="pt-page-moveToTop",s="pt-page-moveFromBottom";break;case 4:r="pt-page-moveToBottom",s="pt-page-moveFromTop";break;case 5:r="pt-page-fade",s="pt-page-moveFromRight pt-page-ontop";break;case 6:r="pt-page-fade",s="pt-page-moveFromLeft pt-page-ontop";break;case 7:r="pt-page-fade",s="pt-page-moveFromBottom pt-page-ontop";break;case 8:r="pt-page-fade",s="pt-page-moveFromTop pt-page-ontop";break;case 9:r="pt-page-moveToLeftFade",s="pt-page-moveFromRightFade";break;case 10:r="pt-page-moveToRightFade",s="pt-page-moveFromLeftFade";break;case 11:r="pt-page-moveToTopFade",s="pt-page-moveFromBottomFade";break;case 12:r="pt-page-moveToBottomFade",s="pt-page-moveFromTopFade";break;case 13:r="pt-page-moveToLeftEasing pt-page-ontop",s="pt-page-moveFromRight";break;case 14:r="pt-page-moveToRightEasing pt-page-ontop",s="pt-page-moveFromLeft";break;case 15:r="pt-page-moveToTopEasing pt-page-ontop",s="pt-page-moveFromBottom";break;case 16:r="pt-page-moveToBottomEasing pt-page-ontop",s="pt-page-moveFromTop";break;case 17:r="pt-page-scaleDown",s="pt-page-moveFromRight pt-page-ontop";break;case 18:r="pt-page-scaleDown",s="pt-page-moveFromLeft pt-page-ontop";break;case 19:r="pt-page-scaleDown",s="pt-page-moveFromBottom pt-page-ontop";break;case 20:r="pt-page-scaleDown",s="pt-page-moveFromTop pt-page-ontop";break;case 21:r="pt-page-scaleDown",s="pt-page-scaleUpDown pt-page-delay300";break;case 22:r="pt-page-scaleDownUp",s="pt-page-scaleUp pt-page-delay300";break;case 23:r="pt-page-moveToLeft pt-page-ontop",s="pt-page-scaleUp";break;case 24:r="pt-page-moveToRight pt-page-ontop",s="pt-page-scaleUp";break;case 25:r="pt-page-moveToTop pt-page-ontop",s="pt-page-scaleUp";break;case 26:r="pt-page-moveToBottom pt-page-ontop",s="pt-page-scaleUp";break;case 27:r="pt-page-scaleDownCenter",s="pt-page-scaleUpCenter pt-page-delay400";break;case 28:r="pt-page-rotateRightSideFirst",s="pt-page-moveFromRight pt-page-delay200 pt-page-ontop";break;case 29:r="pt-page-rotateLeftSideFirst",s="pt-page-moveFromLeft pt-page-delay200 pt-page-ontop";break;case 30:r="pt-page-rotateTopSideFirst",s="pt-page-moveFromTop pt-page-delay200 pt-page-ontop";break;case 31:r="pt-page-rotateBottomSideFirst",s="pt-page-moveFromBottom pt-page-delay200 pt-page-ontop";break;case 32:r="pt-page-flipOutRight",s="pt-page-flipInLeft pt-page-delay500";break;case 33:r="pt-page-flipOutLeft",s="pt-page-flipInRight pt-page-delay500";break;case 34:r="pt-page-flipOutTop",s="pt-page-flipInBottom pt-page-delay500";break;case 35:r="pt-page-flipOutBottom",s="pt-page-flipInTop pt-page-delay500";break;case 36:r="pt-page-rotateFall pt-page-ontop",s="pt-page-scaleUp";break;case 37:r="pt-page-rotateOutNewspaper",s="pt-page-rotateInNewspaper pt-page-delay500";break;case 38:r="pt-page-rotatePushLeft",s="pt-page-moveFromRight";break;case 39:r="pt-page-rotatePushRight",s="pt-page-moveFromLeft";break;case 40:r="pt-page-rotatePushTop",s="pt-page-moveFromBottom";break;case 41:r="pt-page-rotatePushBottom",s="pt-page-moveFromTop";break;case 42:r="pt-page-rotatePushLeft",s="pt-page-rotatePullRight pt-page-delay180";break;case 43:r="pt-page-rotatePushRight",s="pt-page-rotatePullLeft pt-page-delay180";break;case 44:r="pt-page-rotatePushTop",s="pt-page-rotatePullBottom pt-page-delay180";break;case 45:r="pt-page-rotatePushBottom",s="pt-page-rotatePullTop pt-page-delay180";break;case 46:r="pt-page-rotateFoldLeft",s="pt-page-moveFromRightFade";break;case 47:r="pt-page-rotateFoldRight",s="pt-page-moveFromLeftFade";break;case 48:r="pt-page-rotateFoldTop",s="pt-page-moveFromBottomFade";break;case 49:r="pt-page-rotateFoldBottom",s="pt-page-moveFromTopFade";break;case 50:r="pt-page-moveToRightFade",s="pt-page-rotateUnfoldLeft";break;case 51:r="pt-page-moveToLeftFade",s="pt-page-rotateUnfoldRight";break;case 52:r="pt-page-moveToBottomFade",s="pt-page-rotateUnfoldTop";break;case 53:r="pt-page-moveToTopFade",s="pt-page-rotateUnfoldBottom";break;case 54:r="pt-page-rotateRoomLeftOut pt-page-ontop",s="pt-page-rotateRoomLeftIn";break;case 55:r="pt-page-rotateRoomRightOut pt-page-ontop",s="pt-page-rotateRoomRightIn";break;case 56:r="pt-page-rotateRoomTopOut pt-page-ontop",s="pt-page-rotateRoomTopIn";break;case 57:r="pt-page-rotateRoomBottomOut pt-page-ontop",s="pt-page-rotateRoomBottomIn";break;case 58:r="pt-page-rotateCubeLeftOut pt-page-ontop",s="pt-page-rotateCubeLeftIn";break;case 59:r="pt-page-rotateCubeRightOut pt-page-ontop",s="pt-page-rotateCubeRightIn";break;case 60:r="pt-page-rotateCubeTopOut pt-page-ontop",s="pt-page-rotateCubeTopIn";break;case 61:r="pt-page-rotateCubeBottomOut pt-page-ontop",s="pt-page-rotateCubeBottomIn";break;case 62:r="pt-page-rotateCarouselLeftOut pt-page-ontop",s="pt-page-rotateCarouselLeftIn";break;case 63:r="pt-page-rotateCarouselRightOut pt-page-ontop",s="pt-page-rotateCarouselRightIn";break;case 64:r="pt-page-rotateCarouselTopOut pt-page-ontop",s="pt-page-rotateCarouselTopIn";break;case 65:r="pt-page-rotateCarouselBottomOut pt-page-ontop",s="pt-page-rotateCarouselBottomIn";break;case 66:r="pt-page-rotateSidesOut",s="pt-page-rotateSidesIn pt-page-delay200";break;case 67:r="pt-page-rotateSlideOut",s="pt-page-rotateSlideIn";break;case 68:r="pt-page-bookHalfHorizontalLeftOut",s="pt-page-bookHalfHorizontalIn";break;case 69:r="pt-page-bookHalfHorizontalRightOut",s="pt-page-bookHalfHorizontalIn";break;case 70:r="pt-page-bookHalfBottomOut",s="pt-page-bookHalfBottomIn";break;case 71:r="pt-page-bookHalfTopOut",s="pt-page-bookHalfBottomIn";break;case 72:r="pt-page-moveToLeftSlow",s="pt-page-moveFromRightSlow";break;case 73:r="pt-page-moveToRightSlow",s="pt-page-moveFromLeftSlow";break;case 74:r="",s="";break;case 75:r="",s=""}if(68===t||70===t){var f=i.index();f<d-1?++f:f=0,"undefined"!=typeof i.parent().children().eq(f).html()&&(l=i.clone(),i.children().hide(),i.append('<div class="top"><div class="front face"></div></div>'),i.find(".top").append('<div class="back face"><div class="inside"></div></div>'),i.find(".top").find(".front").append(l.html()),i.find(".top").find(".back .inside").append(i.parent().children().eq(f).html()),i.append('<div class="bottom"><div class="inside"></div></div>'),i.find(".bottom .inside").append(l.html()))}i.addClass(r).on(m,function(){i.off(m),p=!0,g&&a(i,n)}),n.addClass(s).on(m,function(){n.off(m),g=!0,p&&a(i,n)}),h||a(i,n)}function a(e,t){p=!1,g=!1,n(e,t),u=!1}function n(e,t){null!=e&&(e.children().show(),e.find(".top").remove(),e.find(".bottom").remove(),e.attr("class",e.data("originalClassList")),e.removeClass("pt-page-current")),null!=t&&t.attr("class",t.data("originalClassList")+" pt-page-current")}var i,l,r=$("#pt-main"),o=r.children("div.pt-page"),s=1,d=o.length,c=0,u=!1,p=!1,g=!1,f={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},m=f[Modernizr.prefixed("animation")],h=Modernizr.cssanimations;return e(),{init:e,nextPage:t}}();!function(){"use strict";function e(e,t,a){return e.splice(t,!a||1+a-t+(!(a<0^t>=0)&&(a<0||-1)*e.length)),e.length}var t=function(){var t,a,n=[],i=-1,l=0,r=!1;return a=function(e,t){return e&&"function"==typeof e[t]?(r=!0,e[t](),r=!1,this):this},{add:function(a){return r?this:(n.splice(i+1,n.length-i),n.push(a),l&&n.length>l&&e(n,0,-(l+1)),i=n.length-1,t&&t(),this)},setCallback:function(e){t=e},undo:function(){var e=n[i];return e?(a(e,"undo"),i-=1,t&&t(),this):this},redo:function(){var e=n[i+1];return e?(a(e,"redo"),i+=1,t&&t(),this):this},clear:function(){var e=n.length;n=[],i=-1,t&&e>0&&t()},hasUndo:function(){return i!==-1},hasRedo:function(){return i<n.length-1},getCommands:function(){return n},getIndex:function(){return i},setLimit:function(e){l=e},removeCurrent:function(){n.splice(i,1)}}};"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?module.exports=t:window.UndoManager=t}();var FakeText=function(){var e=function(){$("#fake-cursor1").remove(),$("#fake-cursor2").remove()},t=function(t){e();var a=$("#"+t);if(!a.hasClass("rotated-item")){var n=a.clone(),i=a.clone(),l=a.height();n.css("z-index",1e5),n.find(".text-wrapper").remove(),n.css("transform",""),n.css("height","5px"),n.css("position","absolute"),n.attr("id","fake-cursor1"),n.attr("class","fake-cursor"),i.css("z-index",1e5),i.find(".text-wrapper").remove(),i.css("transform",""),i.css("height","5px"),i.css("position","absolute"),i.attr("id","fake-cursor2"),i.attr("class","fake-cursor"),$("#"+currentData.IdSlide).append(n),$("#"+currentData.IdSlide).append(i),$("#fake-cursor2").css("top","+="+l+"px")}};return{setSelector:t,removeSelector:e}}(),UndoRedo=function(){function e(e){return"[object Array]"===Object.prototype.toString.call(e)}function t(e){var t=0;try{if(""===e)return 0;if(e.indexOf("deg")!==-1)return e;var a=e.split("(")[1],a=a.split(")")[0],a=a.split(","),n=a[0],i=a[1];a[2],a[3];return t=Math.round(Math.atan2(i,n)*(180/Math.PI))}catch(l){return t}}var a=new UndoManager,n=document.getElementById("permanentUndo");n.disabled=!0;var i=document.getElementById("permanentRedo");i.disabled=!0;var l=$("html"),r="/api/{{typeContent}}/{{typeOperation}}",o=function(e){function t(t){return $("#"+e.idSlide).find(".slide-page-container").find("img").css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height),$("#slide-clone-"+e.idSlide).find(".slide-page-clone-container").css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height),$("#"+e.idSlide).find(".slide-page-container").find("img").attr("data-x",e.dataX).attr("data-y",e.dataY),o={IdGenially:e.idGenially,IdSlide:e.idSlide,SizeBackground:{Width:e.width,Height:e.height},PositionBackground:{PositionLeft:e.left,PositionTop:e.top}},t(!0)}function a(t){$("#"+s).css("left",e.cssLeft).css("top",e.cssTop),$("#"+s).attr("data-x",e.dataX).attr("data-y",e.dataY),$("#fake-"+s).css("left",e.cssLeft).css("top",e.cssTop);e.top+","+e.left;return $("#"+s).attr("data-position",e.dataPosition),o={Id:s,IdGenially:e.idGenially,IdSlide:e.idSlide,Position:{PositionLeft:e.left,PositionTop:e.top}},t(!0)}function n(t){return $("#"+s).css("left",e.left).css("top",e.top),"undefined"!=typeof e.width&&$("#"+s).css("width",e.width),"undefined"!=typeof e.width&&$("#"+s).css("height",e.height),$("#"+s).attr("data-x",e.dataX).attr("data-y",e.dataY),$("#fake-"+s).css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height),o={Id:s,IdGenially:e.idGenially,IdSlide:e.idSlide,Size:{Width:e.width,Height:e.height},Position:{PositionLeft:e.left,PositionTop:e.top}},t(!0)}function i(){ApiGenially.executeCall(o,l,"PUT")}var l=r.replace("{{typeContent}}",e.typeContent);l=l.replace("{{typeOperation}}",e.typeOperation);var o={},s=e.idItem;switch(e.typeContent){case"background":t(function(t){l=r.replace("{{typeContent}}","background"),l=l.replace("{{typeOperation}}","UpdateBackgroundImagePositionAndSize"),t&&(i(),Canva.unselectItem(s),e.idSlide===currentData.IdSlide&&(Background.resizeCorners(),currentData.TypeItem="background",currentData.IdItem=null,$(".working").removeClass("working"),Block.checkBlock(),$("#tb-permanent").find("#permanentLock").prop("disabled",!1)))});break;case"pin":a(function(e){e&&(0===Multidrag.countElements()&&Canva.selectItem(s),i())});break;default:n(function(e){e&&i()})}},s=function(e){function t(t){return $("#"+e.idSlide).find(".slide-page-container").find("img").css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height),$("#slide-clone-"+e.idSlide).find(".slide-page-clone-container").css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height),$("#"+e.idSlide).find(".slide-page-container").find("img").attr("data-x",e.dataX).attr("data-y",e.dataY),l={IdGenially:e.idGenially,IdSlide:e.idSlide,SizeBackground:{Width:e.width,Height:e.height},PositionBackground:{PositionLeft:e.left,PositionTop:e.top}},t(!0)}function a(t){return $("#"+o).css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height),$("#"+o).attr("data-x",e.dataX).attr("data-y",e.dataY),$("#fake-"+o).css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height),l={Id:o,IdGenially:e.idGenially,IdSlide:e.idSlide,Size:{Width:e.width,Height:e.height},Position:{PositionLeft:e.left,PositionTop:e.top}},t(!0)}function n(){ApiGenially.executeCall(l,i,"PUT")}var i=r.replace("{{typeContent}}",e.typeContent);i=i.replace("{{typeOperation}}",e.typeOperation);var l={},o=e.idItem;switch(e.typeContent){case"background":t(function(t){i=r.replace("{{typeContent}}","background"),i=i.replace("{{typeOperation}}","UpdateBackgroundImagePositionAndSize"),t&&(n(),Canva.unselectItem(o),e.iddSlide===currentData.IdSlide&&(Background.resizeCorners(),currentData.TypeItem="background",currentData.IdItem=null,$(".working").removeClass("working"),Block.checkBlock(),$("#tb-permanent").find("#permanentLock").prop("disabled",!1)))});break;default:a(function(e){e&&n()})}},d=function(e){function t(t){return e.angle=""===e.angle?"rotate(0)":e.angle,$("#"+l).css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height).css("transform",e.angle),$("#"+l).attr("data-x",e.dataX).attr("data-y",e.dataY),$("#fake-"+l).css("left",e.left).css("top",e.top).css("width",e.width).css("height",e.height).css("transform",e.angle),i={Id:l,IdGenially:e.idGenially,IdSlide:e.idSlide,Size:{Width:e.width,Height:e.height},Position:{PositionLeft:e.left,PositionTop:e.top},Rotation:{Rotatione:e.angle}},t(!0)}function a(){ApiGenially.executeCall(i,n,"PUT")}var n=r.replace("{{typeContent}}",e.typeContent);n=n.replace("{{typeOperation}}",e.typeOperation);var i={},l=e.idItem;t(function(e){e&&a()})},c=function(e){function t(t){if(null===e.idItem||""===e.idItem)return t(!1);if("svg"!==e.typeContent)return t(!1);var a=e.idItem;return $("#"+a).find(".color"+e.whichColor).css("fill",e.previousColor),$("#fake-"+a).find(".color"+e.whichColor).css("fill",e.previousColor),$("#"+a).attr("data-color-"+e.whichColor,e.previousColor),i={Id:e.idItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Color:e.previousColor,WhichColor:e.whichColor},t(!0)}function a(){ApiGenially.executeCall(i,n,"PUT")}var n=r.replace("{{typeContent}}",e.typeContent);n=n.replace("{{typeOperation}}",e.typeOperation);var i={};e.idItem;t(function(e){e&&a()})},u=function(e){function t(t){if(null===e.idItem||""===e.idItem)return t(!1);if("text"!==e.typeContent)return t(!1);var a=(e.idItem,$("#"+e.idItem)),n=$("#fake-"+e.idItem);return 0===a.length?t(!1):(a.find(".text-div").html(e.TextMessage),n.find(".text-div").html(e.TextMessage),a.css({width:e.Size.Width?e.Size.Width:"200px",height:e.Size.Height?e.Size.Height:"200px",left:e.Position.PositionLeft?e.Position.PositionLeft:0,top:e.Position.PositionTop?e.Position.PositionTop:0,"font-family":e.FontFamily?e.FontFamily:"Roboto, sans-serif","font-size":e.FontSize?e.FontSize:"16px","background-color":e.Background?e.Background:"transparent"}),n.css({width:e.Size.Width?e.Size.Width:"200px",height:e.Size.Height?e.Size.Height:"200px",left:e.Position.PositionLeft?e.Position.PositionLeft:0,top:e.Position.PositionTop?e.Position.PositionTop:0,"font-family":e.FontFamily?e.FontFamily:"Roboto, sans-serif","font-size":e.FontSize?e.FontSize:"16px","background-color":e.Background?e.Background:"transparent"}),a.find(".text-div").css({opacity:e.Opacity?e.Opacity:1}),n.find(".text-div").css({opacity:e.Opacity?e.Opacity:1}),a.find(".text-wrapper").css({padding:e.Padding?e.Padding:"3px"}),n.find(".text-wrapper").css({padding:e.Padding?e.Padding:"3px"}),a.removeClass("text-align-left text-align-right text-align-center text-align-justify"),n.removeClass("text-align-left text-align-right text-align-center text-align-justify"),$.each(e.Classes,function(e,t){a.addClass(t),n.addClass(t)}),a.removeClass("text-effect-shadow"),n.removeClass("text-effect-shadow"),""!==e.Shadow&&(a.addClass(e.Shadow),n.addClass(e.Shadow)),i={Id:e.idItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:e.Size.Width?e.Size.Width:null,Height:e.Size.Height?e.Size.Height:null},Position:{PositionLeft:e.Position.PositionLeft?e.Position.PositionLeft:null,PositionTop:e.Position.PositionTop?e.Position.PositionTop:null},FontFamily:e.FontFamily?e.FontFamily:null,FontSize:e.FontSize?e.FontSize:null,TextMessage:e.TextMessage?e.TextMessage:null,Classes:e.Classes?e.Classes:null,Background:e.Background?e.Background:null,Opacity:e.Opacity?e.Opacity:null,Padding:e.Padding?e.Padding:null,Shadow:e.Shadow?e.Shadow:null},t(!0))}function a(){ApiGenially.executeCall(i,n,"PUT")}var n=r.replace("{{typeContent}}",e.typeContent.toProperCase());n=n.replace("{{typeOperation}}",e.typeTextUpdate);var i={},o=e.idItem;t(function(t){if(t){if("UpdateText"===e.typeTextUpdate&&currentData.IdItem!==e.IdItem){var n=$("#"+currentData.IdItem);n.addClass("element-draggable element"),n.find(".text-div").attr("contenteditable",!1),$(".working").removeClass("working"),Canva.selectItem(e.idItem),Block.checkBlock(),l.removeClass("editing-text")}null===currentData||l.hasClass("editing-text")||(Canva.selectItem(o),Block.checkBlock()),a()}})},p=function(e){if("background"===e.typeContent&&0!==$("#"+e.idSlide).length){$("#"+e.idSlide).css({"background-color":e.backgroundColor}),$("#slide-clone-"+e.idSlide).css({"background-color":e.backgroundColor}),ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements();var t={IdSlide:e.idSlide,BackgroundColor:e.backgroundColor};ApiGenially.executeCall(t,"/api/Background/UpdateBackgroundImage","PUT")}},g=function(e){if("background"===e.typeContent&&0!==$("#"+e.idSlide).length){var t=$("#"+e.idSlide).find(".current-background-slide");t.css({width:e.width,height:e.height,top:e.top,left:e.left,opacity:e.opacity}),$("#"+e.idSlide).css("background-color",e.backgroundColor),$("#slide-clone-"+e.idSlide).css("background-color",e.backgroundColor),t.attr("src",e.backgroundImage),t.attr("data-x",e.left),t.attr("data-y",e.top),$("#slide-clone-"+e.idSlide).find(".slide-page-clone-container").attr("src",e.backgroundImage).css({width:e.width,height:e.height,top:e.top,left:e.left,opacity:e.opacity}),ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements();var a={IdGenially:currentData.IdGenially,IdSlide:e.idSlide,Source:e.backgroundImage,BackgroundColor:e.backgroundColor,OpacityBackground:e.opacity,SizeBackground:{Width:e.width,Height:e.height},PositionBackground:{PositionLeft:e.left,PositionTop:e.top}};currentData.IdSlide===e.idSlide&&"background"===currentData.TypeItem&&setTimeout(function(){Background.resizeCorners()},200),Background.refreshRender(e.idSlide),ApiGenially.executeCall(a,"/api/Background/UpdateBackgroundImage","PUT")}},f=function(e){if("background"===e.typeContent&&0!==$("#"+e.idSlide).length){var t=$("#"+e.idSlide).find(".current-background-slide");t.css("opacity",e.opacity),ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements();var a={IdGenially:currentData.IdGenially,IdSlide:e.idSlide,OpacityBackground:e.opacity};if($("#slide-clone-"+e.idSlide).find(".slide-page-clone-container").css("opacity",e.opacity),e.idSlide===currentData.IdSlide)try{var n=100*e.opacity;$("#backgroundOpacitySlider")[0].noUiSlider.set(n)}catch(i){}ApiGenially.executeCall(a,"/api/Background/UpdateBackgroundImage","PUT")}},m=function(e){if(null!==e.idItem&&""!==e.idItem){var a=$("#"+e.idItem);if(0!==a.length){var n="content"!==e.typeContent?t(e.angle):"0";if(a.css({width:e.width,height:e.height,top:e.top,left:e.left,transform:e.angle}),a.hasClass("pin-draggable")||(a.attr("data-y",e.dataY),a.attr("data-x",e.dataX)),a.hasClass("svg-draggable")&&"true"===a.attr("data-aspect-ratio")){var i=a[0].style.transform;a[0].style.transform="",a.css("height","");var l=a.find(".wrapper-svg");l.css("height","");var r=parseInt(a.find("svg")[0].getBoundingClientRect().height/watching.scale);DesignMode.designDOM.height.val(r),a.css("height",r),l.css("width",e.width),l.css("height",r),a[0].style.transform=i}if(a.hasClass("svg-draggable")&&"false"===a.attr("data-aspect-ratio")){var o=a.find(".wrapper-svg");o.css("width",e.width),o.css("height",e.height)}0===Multidrag.countElements()?(Canva.selectItem(e.idItem),Block.checkBlock()):(""!==DesignMode.designDOM.width.val()&&DesignMode.designDOM.width.val(e.width.split("px")[0]),""!==DesignMode.designDOM.height.val()&&DesignMode.designDOM.height.val(e.height.split("px")[0]),""!==DesignMode.designDOM.rotation.val()&&"content"!==e.typeContent&&DesignMode.designDOM.rotation.val(n));var s={Id:e.idItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")}};"content"!==e.TypeContent&&(s.Rotation={Rotatione:Canva.getRotationStyle(a)});var d="/api/"+e.typeContent+"/SaveAll";ApiGenially.executeCall(s,d,"PUT")}}},h=function(e){function t(){}function a(){}switch(e.typeRemove){case"recreate":t();break;case"remove":a()}},v=function(e){if("image"===e.typeContent&&0!==$("#"+e.idItem).length){var t=$("#"+e.idItem),a=t.find("img"),n=$("#fake-"+e.idItem),i=n.find("img"),l={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:e.idItem,Frame:e.Frame};a.attr("class",e.Frame),i.attr("class",e.Frame),ApiGenially.executeCall(l,"/api/image/UpdateFrame","PUT")}},y=function(t){if($("html").hasClass("editing-text")&&Text.finishEditingText(),e(t))$.each(t,function(e,t){var a=!1;if("background"!==t.typeContent?$("#"+t.idItem).length>0&&(a=!0):$("#"+t.idSlide).length>0&&(a=!0),a)switch(t.typeOperation){case"UpdateSize":s(t);break;case"UpdatePosition":o(t);break;case"UpdateRotation":d(t);break;case"UpdateColor":c(t);break;case"UpdateText":u(t);break;case"BackgroundImage":g(t);break;case"DesignChange":m(t);break;case"ImageEffect":v(t)}});else{var n=!1;if("background"!==t.typeContent?$("#"+t.idItem).length>0&&(n=!0):$("#"+t.idSlide).length>0&&(n=!0),n)switch(t.typeOperation){case"UpdateSize":s(t);break;case"UpdatePosition":o(t);break;case"UpdateRotation":d(t);break;case"UpdateColor":c(t);break;case"UpdateText":u(t);break;case"BackgroundColor":p(t);break;case"BackgroundImage":g(t);break;case"BackgroundOpacity":f(t);break;case"DesignChange":m(t);break;case"RemoveElement":h(t);break;case"ImageEffect":v(t)}else a.removeCurrent()}try{"undefined"!=typeof t&&I(t)}catch(i){}},I=function(t){if(n.disabled=!a.hasUndo(),i.disabled=!a.hasRedo(),null!==t&&"undefined"!=typeof t)if(e(t))try{var r=t[0].idSlide;if($("#"+r).length>0){if(r!==currentData.IdSlide){var o=$("#slidesContent").find("#slide-preview-"+r);EventsEditor.goToSlide(o)}Multidrag.clearElements(),Canva.hideAllMenus(),AnimationsEditor.enableMultiDrag(),Toolbar.hideAll();var s=0;t.forEach(function(e){var t=$("#"+e.idItem);t.length>0&&(Multidrag.addElement(t),t.addClass("multidrag-element"),t.prepend('<div class="multidrag-selector"></div>'),s++)}),s>0&&(l.addClass("multidrag multidragging"),Multidrag.allSame("text")?(l.addClass("tb-general tb-text"),ToolbarText.changeDynamicElements()):Multidrag.allSame("image")?(l.addClass("tb-general tb-image"),ToolbarImage.changeDynamicElements()):Multidrag.allSame("svg")?(l.addClass("tb-general tb-svg"),ToolbarSVG.changeDynamicElements()):Multidrag.allSame("pin")?(l.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements()):Multidrag.allSame("area")?(l.addClass("tb-general tb-area"),ToolbarArea.changeDynamicElements()):Multidrag.allSame("content")&&l.addClass("tb-general"))}}catch(d){}else if(Multidrag.clearElements(),l.removeClass("multidrag multidragging"),t.idSlide!==currentData.IdSlide){if("background"===t.typeContent){if($("#"+t.idSlide).length>0){var c=$("#slidesContent").find("#slide-preview-"+t.idSlide);EventsEditor.goToSlide(c),setTimeout(function(){Background.selectBackground()},200)}}else if($("#"+t.idItem).length>0&&$("#"+t.idSlide).length>0){var c=$("#slidesContent").find("#slide-preview-"+t.idSlide);EventsEditor.goToSlide(c),Canva.selectItem(t.idItem),Block.checkBlock(),Background.hideSelector()}}else"background"===t.typeContent?$("#"+t.idSlide).length>0&&Background.selectBackground():$("#"+t.idItem).length>0&&$("#"+t.idSlide).length>0&&(Canva.selectItem(t.idItem),Block.checkBlock(),Background.hideSelector())},b=function(e,t){a.add({undo:function(){y(e)},redo:function(){y(t)}})},C=function(){a.clear()};return a.setCallback(I),{undoManager:a,createElement:b,clearUndoRedo:C}}(),zoomArray={},zoomCssArray={},ZoomGenially=function(){function e(e){var t=$("#slideHolder-"+currentData.IdSlide);$("#selector").hide(),t[0].style.transform="",t[0].style.transformOrigin="",fitJs[e].trigger(),$("#wrapperHolder").css({overflow:""}),r=0,o.text("100%"),"background"===currentData.TypeItem&&Background.hideSelector(),null!==currentData.IdItem&&setTimeout(function(){Canva.setPositionSelector(document.getElementById(currentData.IdItem)),$("#selector").show()},100),s.removeClass("has-scroll")}function t(e){"undefined"==typeof e&&(e=currentData.IdSlide),null!==currentData.IdItem&&Canva.setPositionSelector(document.getElementById(currentData.IdItem)),$("#"+e).css({transform:zoomCssArray[e],overflow:"hidden"})}function a(){if(!(r>20)){var e=$("html");(e.hasClass("multidrag")||e.hasClass("multidragging"))&&(e.removeClass("multidrag multidragging"),$(".multidrag-element").removeClass("multidrag-element"),$(".multidrag-selector").remove(),currentData.IdItem=null,Toolbar.hideAll(),Multidrag.clearElements()),r+=1;var t=$("#wrapperHolder"),a=$("#slideHolder-"+currentData.IdSlide),n=1+r/10;a[0].style.transform="scale("+n+","+n+")",r<=0?(a[0].style.transformOrigin="",t.css({overflow:""}),s.removeClass("has-scroll")):(a[0].style.transformOrigin=50/n+"px  "+50/n+"px",t.css({overflow:"auto"}),s.addClass("has-scroll"));var i=document.getElementById("slideHolder-"+currentData.IdSlide).getBoundingClientRect();
t.scrollLeft((i.width-t.width())/2),t.scrollTop((i.height-t.height())/2),Editor.loadCurrentScale(),"background"===currentData.TypeItem&&Background.hideSelector(),null!==currentData.IdItem&&Canva.setPositionSelector(document.getElementById(currentData.IdItem))}}function n(){if(!(r===-10||document.getElementById("slideHolder-"+currentData.IdSlide).getBoundingClientRect().width<200)){var e=$("html");(e.hasClass("multidrag")||e.hasClass("multidragging"))&&(e.removeClass("multidrag multidragging"),$(".multidrag-element").removeClass("multidrag-element"),$(".multidrag-selector").remove(),currentData.IdItem=null,Toolbar.hideAll(),Multidrag.clearElements()),r-=1;var t=$("#wrapperHolder"),a=$("#slideHolder-"+currentData.IdSlide),n=1-r*-1/10;a[0].style.transform="scale("+n+","+n+")",r<=0?(a[0].style.transformOrigin="",t.css({overflow:""}),s.removeClass("has-scroll")):(a[0].style.transformOrigin=50/n+"px  "+50/n+"px",t.css({overflow:"auto"}),s.addClass("has-scroll"));var i=document.getElementById("slideHolder-"+currentData.IdSlide).getBoundingClientRect();t.scrollLeft((i.width-t.width())/2),t.scrollTop((i.height-t.height())/2),Editor.loadCurrentScale(),null!==currentData.IdItem&&Canva.setPositionSelector(document.getElementById(currentData.IdItem)),"background"===currentData.TypeItem&&Background.hideSelector()}}function i(){$("#moreZoom").click(a),$("#lessZoom").click(n)}function l(){i()}var r=0,o=$("#zoomPercent"),s=$("html");return{start:l,resetZoom:t,resetAllZoom:e}}(),CopyPaste=function(){var e=$("#permanentCopy"),t=$("#permanentPaste"),a="/api/Slide/DuplicateItems",n=[],i=function(){return n.length},l=function(){n.splice(0,i())},r=function(e){var a=$("html");if(e||!(a.hasClass("modal-open")||a.hasClass("editing-text")||inInput)){if(l(),0===Multidrag.countElements()){if(null===currentData.IdItem||""===currentData.IdItem)return;var i=$("#"+currentData.IdItem),r=i.clone();r.css("top","+=10px"),r.css("left","+=10px");var o=parseInt(r.attr("data-x")),s=parseInt(r.attr("data-y"));o+=10,s+=10,r.attr("data-x",o),r.attr("data-y",s),r.attr("copy-object",!0),r.removeClass("working"),n.push(r)}else $.each(Multidrag.multiElements,function(e,t){if($(t).hasClass("content-draggable"))return!0;var a=$(t).clone();a.css("top","+=10px"),a.css("left","+=10px");var i=parseInt(a.attr("data-x")),l=parseInt(a.attr("data-y"));i+=10,l+=10,a.attr("data-x",i),a.attr("data-y",l),n.push(a)});t.prop("disabled",!1).removeClass("disabled")}},o=function(e){function t(e,t){return parseInt(e.css("z-index"))<parseInt(t.css("z-index"))?-1:parseInt(e.css("z-index"))>parseInt(t.css("z-index"))?1:0}function o(e){Multidrag.clearElements(),$.each(e,function(e,t){var a=$(n[e]),l=a.clone(),r={title:"",idItem:t,typeItem:a.attr("data-type"),icon:"",blocked:a.data("blocked")?"active":"",visible:"",zIndex:parseInt(a.css("z-index"),10)};switch(a.attr("data-type")){case"text":r.title=a.attr("data-layer-title")?"Copy - "+a.attr("data-layer-title"):"Copy - Text Element",r.icon="title";break;case"svg":r.title=a.attr("data-layer-title")?"Copy - "+a.attr("data-layer-title"):"Copy - SVG Element",r.icon="wallpaper";break;case"image":r.title=a.attr("data-layer-title")?"Copy - "+a.attr("data-layer-title"):"Copy - Image Element",r.icon="wallpaper";break;case"content":r.title=a.attr("data-layer-title")?"Copy - "+a.attr("data-layer-title"):"Copy Rich Content",r.icon="airplay";break;case"area":r.title=a.attr("data-layer-title")?"Copy - "+a.attr("data-layer-title"):"Copy Interactive Area",r.icon="crop_free"}if("pin"!==r.typeItem&&DesignLayers.pushLayer(r),a.attr("id",t),l.attr("id","fake-"+t),$("#"+currentData.IdSlide).append(n[e]),$("#slide-clone-"+currentData.IdSlide).append(l),"text"===a.attr("data-type")&&$("#"+t).addClass("element"),i()>1)Multidrag.addElement(a),d.removeClass("blocked");else{Canva.selectItem(t),Block.checkBlock(),"pin"!==r.typeItem&&DesignLayers.selectLayer(t);var o=$("#"+t);o.removeClass("multidrag-element"),o.find(".multidrag-selector").remove()}window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}),DesignLayers.reorder(),l(),r(),$("#permanentPaste").prop("disabled",!1).removeClass("disabled")}try{"paste"===e.type&&(e=void 0)}catch(s){}var d=$("html");if((e||!(d.hasClass("modal-open")||d.hasClass("editing-text")||$("input").is(":focus")))&&0!==i()){var c=[];$("#permanentPaste").prop("disabled",!0).addClass("disabled"),n.sort(t),$.each(n,function(e,t){var a=$(t).attr("data-type"),i=$(t).attr("id");if("content"===a||0===$("#"+i).length)return!0;var l=ZIndex.getMaximum();ZIndex.newDivZIndex();var r={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,OldId:i,Type:a,ZIndex:l};$(n[e]).css({"z-index":l}),c.push(r)}),c.length>0&&ApiGenially.executeCall(c,a,"POST",o)}},s=function(){function a(){r(!0)}function n(){o(!0)}e.click(a),t.click(n);try{var i=navigator.sayswho,l=i.split("-");"Firefox"===l[0]?$(document).keyup(function(e){var t=e||window.event;return 67===t.which&&(t.ctrlKey||e.metaKey)?void r():86===t.which&&(t.ctrlKey||e.metaKey)?void o():void 0}):($("html").bind("paste",o),$("html").bind("copy",r))}catch(s){}t.prop("disabled",!0).addClass("disabled")};return{start:s,copy:r,paste:o,copyElements:n,countCopyElements:i,clearCopyElements:l}}(),CropImage=function(){function e(e){p=e,s.show(),d=currentData.IdItem,$("#image").remove();var t=$("#"+currentData.IdItem),a=t.find("img").attr("img-original");"undefined"==typeof a&&t.find("img").attr("img-original",t.find("img").attr("src")),$(".img-container").append('<img id="image" src="'+t.find("img").attr("img-original")+'" />');var n=$("#image"),i=n.clone();n.remove(),$(".img-container").html(i),CustomCropper.init(e)}function t(e,t){var a=new Image;return a.src=e.toDataURL("image/"+t),a}function a(){$("#image").cropper("setAspectRatio",NaN);var e=$("#image").cropper("getImageData"),t=e.naturalWidth,a=e.naturalHeight;"undefined"!=typeof a&&"undefined"!=typeof t&&$("#image").cropper("setData",{width:t,height:a,x:0,y:0})}function n(){var e=$("#"+d),a=e.find("img"),n=a.css("opacity");e.append('<div class="loader-image"></div>'),e.css("pointer-events","none"),a.css({opacity:"0.5"}),e.addClass("div-loader-image");var i,l=$("#image"),r=l.cropper("getCroppedCanvas"),c=l.cropper("getData");if($("#imageCrop, #blockFileReplace").css("pointer-events","none").addClass("disabled"),1===p){var u=l.attr("src").substr(-4);i=".png"===u?"image/png":".jpg"===u?"image/jpeg":".gif"===u?"image/gif":"image/jpeg"}else i="image/png";var g=t(r,i);g.onload=function(e){function t(e){var t=$("#"+d),a=$("#fake-"+d),r=t;1===p?(t.css({width:i,height:l}),a.css({width:i,height:l})):(r.find("img").removeAttr("img-original-replace"),r.find("img").removeAttr("img-original")),t.find("img").attr("src",e),a.find("img").attr("src",e),r.removeClass("div-loader-image"),r.find(".loader-image").remove(),r.find("img").css({opacity:n}),r.css({"pointer-events":""}),Canva.setPositionSelector(t[0]),$("#closebt-container").click(),s.hide(),2===p&&(document.getElementById("fileReplace").value=""),$("#imageCrop, #blockFileReplace").css("pointer-events","").removeClass("disabled")}function a(){var e=$("#"+d),t=e;t.removeClass("div-loader-image"),t.find(".loader-image").remove(),t.find("img").css({opacity:n}),t.css({"pointer-events":""}),s.hide(),SaveDisplay.showErrorImage(),2===p&&(document.getElementById("fileReplace").value=""),$("#imageCrop, #blockFileReplace").css("pointer-events","").removeClass("disabled")}var i=c.width+"px",l=c.height+"px";2===p&&(i=null,l=null);var r={Id:currentData.IdItem,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially,Source:$(g).attr("src"),Size:{Width:i,Height:l}};ApiGenially.executeCall(r,o,"PUT",t,a)}}function i(){if(2===p){var e=$("#"+d).find("img");e.removeAttr("img-original-replace"),e.removeAttr("img-original"),document.getElementById("fileReplace").value=""}}function l(){r.click(n),c.click(i),u.click(a)}var r=$("#saveCrop"),o="/api/image/UploadImageCropped/",s=$("#cropImage"),d=null,c=($("#imageCrop"),$("#closebt-container")),u=$("#aspectRatioCrop"),p=0;return{showCropper:e,saveCropper:n,start:l}}(),CustomCropper=function(){function e(e){var t=0,a=859,n=400;if(2===e){var i=$("#"+currentData.IdItem);t=i.width()/i.height(),a=i.width(),n=i.height()}var l=$("#image"),r=$("#dataX"),o=$("#dataY"),s=$("#dataHeight"),d=$("#dataWidth"),c=$("#dataRotate"),u=$("#dataScaleX"),p=$("#dataScaleY"),g={aspectRatio:t,preview:".img-preview",minContainerWidth:a,minContainerHeight:n,crop:function(e){r.val(Math.round(e.x)),o.val(Math.round(e.y)),s.text(Math.round(e.height)),d.text(Math.round(e.width)),c.val(e.rotate),u.val(e.scaleX),p.val(e.scaleY)}};l.on({}).cropper(g);var f=$("#"+currentData.IdItem).find("img").attr("class"),m=$("#cropImage").find(".cropper-view-box");"none"!==f&&""!==f&&(m.addClass(f),setTimeout(function(){m=$("#cropImage").find(".cropper-view-box"),m.addClass(f)},500)),$(".docs-toggles").on("change","input",function(){var e,t,a=$(this),n=a.attr("name"),i=a.prop("type");l.data("cropper")&&("checkbox"===i?(g[n]=a.prop("checked"),e=l.cropper("getCropBoxData"),t=l.cropper("getCanvasData"),g.built=function(){l.cropper("setCropBoxData",e),l.cropper("setCanvasData",t)}):"radio"===i&&(g[n]=a.val()),l.cropper("destroy").cropper(g))}),$(".docs-buttons").on("click","[data-method]",function(){var e,t,a=$(this),n=a.data();if(!a.prop("disabled")&&!a.hasClass("disabled")&&l.data("cropper")&&n.method){if(n=$.extend({},n),"undefined"!=typeof n.target&&(e=$(n.target),"undefined"==typeof n.option))try{n.option=JSON.parse(e.val())}catch(i){}switch(t=l.cropper(n.method,n.option,n.secondOption),n.method){case"scaleX":case"scaleY":$(this).data("option",-n.option);break;case"getCroppedCanvas":t&&$("#getCroppedCanvasModal").modal().find(".modal-body").html(t)}if($.isPlainObject(t)&&e)try{e.val(JSON.stringify(t))}catch(i){}}}),$(document.body).on("keydown",function(e){if(l.data("cropper")&&!(this.scrollTop>300))switch(e.which){case 37:e.preventDefault(),l.cropper("move",-1,0);break;case 38:e.preventDefault(),l.cropper("move",0,-1);break;case 39:e.preventDefault(),l.cropper("move",1,0);break;case 40:e.preventDefault(),l.cropper("move",0,1)}})}return{init:e}}(),Center=function(){function e(){var e=$("#"+currentData.IdItem),t={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:0,left:0}),e.attr("data-x",0),e.attr("data-y",0),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var a=Object.assign({},t);a.top=e.css("top"),a.left=e.css("left"),a.dataX=e.attr("data-x"),a.dataY=e.attr("data-y"),UndoRedo.createElement(t,a)}function t(){var e=$("#"+currentData.IdItem),t=$("#"+currentData.IdSlide).width()-e.width(),a={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:0,left:t}),e.attr("data-x",t),e.attr("data-y",0),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var n=Object.assign({},a);n.top=e.css("top"),n.left=e.css("left"),n.dataX=e.attr("data-x"),n.dataY=e.attr("data-y"),UndoRedo.createElement(a,n)}function a(){var e=$("#"+currentData.IdItem),t=$("#"+currentData.IdSlide).width()/2-e.width()/2,a={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:0,left:t}),e.attr("data-x",t),e.attr("data-y",0),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var n=Object.assign({},a);n.top=e.css("top"),n.left=e.css("left"),n.dataX=e.attr("data-x"),n.dataY=e.attr("data-y"),UndoRedo.createElement(a,n)}function n(){var e=$("#"+currentData.IdItem),t=$("#"+currentData.IdSlide).height()/2-e.height()/2,a=$("#"+currentData.IdSlide).width()/2-e.width()/2,n={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:t,left:a}),e.attr("data-x",a),e.attr("data-y",t),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var i=Object.assign({},n);i.top=e.css("top"),i.left=e.css("left"),i.dataX=e.attr("data-x"),i.dataY=e.attr("data-y"),UndoRedo.createElement(n,i)}function i(){var e=$("#"+currentData.IdItem),t=$("#"+currentData.IdSlide).height()/2-e.height()/2,a={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:t,left:0}),e.attr("data-x",0),e.attr("data-y",t),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var n=Object.assign({},a);n.top=e.css("top"),n.left=e.css("left"),n.dataX=e.attr("data-x"),n.dataY=e.attr("data-y"),UndoRedo.createElement(a,n)}function l(){var e=$("#"+currentData.IdItem),t=$("#"+currentData.IdSlide).height()/2-e.height()/2,a=$("#"+currentData.IdSlide).width()-e.width(),n={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:t,left:a}),e.attr("data-x",a),e.attr("data-y",t),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var i=Object.assign({},n);i.top=e.css("top"),i.left=e.css("left"),i.dataX=e.attr("data-x"),i.dataY=e.attr("data-y"),UndoRedo.createElement(n,i)}function r(){var e=$("#"+currentData.IdItem),t=$("#"+currentData.IdSlide).height()-e.height(),a=0,n={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:t,left:a}),e.attr("data-x",a),e.attr("data-y",t),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var i=Object.assign({},n);i.top=e.css("top"),i.left=e.css("left"),i.dataX=e.attr("data-x"),i.dataY=e.attr("data-y"),UndoRedo.createElement(n,i)}function o(){var e=$("#"+currentData.IdItem),t=$("#"+currentData.IdSlide).height()-e.height(),a=$("#"+currentData.IdSlide).width()-e.width(),n={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:t,left:a}),e.attr("data-x",a),e.attr("data-y",t),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var i=Object.assign({},n);i.top=e.css("top"),i.left=e.css("left"),i.dataX=e.attr("data-x"),i.dataY=e.attr("data-y"),UndoRedo.createElement(n,i)}function s(){var e=$("#"+currentData.IdItem),t=$("#"+currentData.IdSlide).height()-e.height(),a=$("#"+currentData.IdSlide).width()/2-e.width()/2,n={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:e.css("width"),height:e.css("height"),top:e.css("top"),left:e.css("left"),angle:Canva.getRotationStyle(e),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:e.attr("data-x"),dataY:e.attr("data-y")};e.css({top:t,left:a}),e.attr("data-x",a),e.attr("data-y",t),Canva.saveDraggable(),Canva.setPositionSelector(e[0]);var i=Object.assign({},n);i.top=e.css("top"),i.left=e.css("left"),i.dataX=e.attr("data-x"),i.dataY=e.attr("data-y"),UndoRedo.createElement(n,i)}function d(){u.click(e),p.click(t),g.click(a),f.click(n),m.click(i),h.click(l),v.click(r),y.click(o),I.click(s)}function c(){d()}var u=$("#top-left"),p=$("#top-right"),g=$("#top-middle"),f=$("#middle-middle"),m=$("#middle-left"),h=$("#middle-right"),v=$("#bottom-left"),y=$("#bottom-right"),I=$("#bottom-middle");return{start:c}}(),Delete=function(){function e(e){if("undefined"!=typeof currentData.IdItem){$("html").removeClass("editing-text");var t=$("#"+e);if("undefined"!=typeof t.data("type")){var a=localStorage.getItem("copyValue");a===e&&(localStorage.setItem("copyValue",null),localStorage.setItem("copyValueClone",null),localStorage.setItem("typeCopy",null));var n="/api/"+t.data("type")+"/Delete",i={Id:e,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide};ApiGenially.executeCall(i,n,"DELETE"),$(t).remove(),$("#fake-"+e).remove(),ZIndex.deleteDivZIndex($(t)),currentData.IdItem=null,Canva.unselectItem(),DesignLayers.removeLayer(e,!0)}}}function t(){for(var e="/api/MultiElement/Delete",t=[],a=0;a<Multidrag.countElements();a++)t.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:$(Multidrag.multiElements[a]).attr("id"),TypeItem:$(Multidrag.multiElements[a]).attr("data-type")}),$("#fake-"+$(Multidrag.multiElements[a]).attr("id")).remove(),DesignLayers.removeLayer($(Multidrag.multiElements[a]).attr("id"),!1),$(Multidrag.multiElements[a]).remove();var n={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Elements:t};Multidrag.clearElements(),Toolbar.hideAll(),$("html").removeClass("multidrag multidragging"),ApiGenially.executeCall(n,e,"DELETE")}return{removeItem:e,removeMultiItems:t}}(),Pin=function(){function e(e){var t=e.css("-webkit-transform")||e.css("-moz-transform")||e.css("-ms-transform")||e.css("-o-transform")||e.css("transform");if("none"!==t)try{var a=t.split("(")[1].split(")")[0].split(","),n=a[0];n=Math.round(1e7*n)/1e7;var i=a[1];i=Math.round(1e7*i)/1e7;var l=i*-1;l=Math.round(1e7*l)/1e7;var r="matrix("+n+", "+i+", "+l+","+n+", 0, 0)";return r}catch(o){return t}return""}var t=$("html"),a=$("#magicWand"),n=$("#selector"),i=($("#textEditAction"),{startDraggable:null,endDraggable:null}),l=function(){var e="/api/"+currentData.TypeItem+"/UpdatePosition",t=$("#"+currentData.IdItem),a=watching.scale,n=parseFloat(t.attr("data-x"))+16/a,l=parseFloat(t.attr("data-y"))+32/a;$("#fake-"+currentData.IdItem).css({left:t.css("left"),top:t.css("top")});var r={Id:currentData.IdItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Position:{PositionLeft:n,PositionTop:l}},o={idItem:$(t).attr("id"),typeContent:$(t).attr("data-type"),typeOperation:"UpdatePosition",top:""+l,left:""+n,cssTop:$(t).css("top"),cssLeft:$(t).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(t).attr("data-x"),dataY:$(t).attr("data-y")};i.endDraggable=o,UndoRedo.createElement(i.startDraggable,i.endDraggable),ApiGenially.executeCall(r,e,"PUT")},r=function(l){t.hasClass("editing-text")&&Text.finishEditingText(),t.addClass("dragging"),a.hide(),n.hide(),Background.hideSelector();var r=$(l.target)[0];if(Canva.setItemType($(r)),AnimationsEditor.loadDataItem($(r)),$("#"+currentData.IdSlide).css({overflow:"visible"}),currentData.IdItem=$(l.target).attr("id"),Block.checkBlock(),Canva.hideSlideSideBar(),Canva.showInteractivity(),t.removeClass("tb-general tb-text tb-image tb-svg tb-pin tb-area tb-background"),t.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements(),$(t).hasClass("multidragging")||0!==Multidrag.countElements()){var o=[];$.each(Multidrag.multiElements,function(t,a){var n={};if("pin"===$(a).attr("data-type")){var i=$(a).attr("data-position"),l=i.split(",")[0],r=i.split(",")[1];n={idItem:$(a).attr("id"),typeContent:$(a).attr("data-type"),typeOperation:"UpdatePosition",top:r,left:l,cssTop:$(a).css("top"),cssLeft:$(a).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(a).attr("data-x"),dataY:$(a).attr("data-y"),dataPosition:i}}else n={idItem:$(a).attr("id"),typeContent:$(a).attr("data-type"),typeOperation:"UpdatePosition",width:$(a).css("width"),height:$(a).css("height"),top:$(a).css("top"),left:$(a).css("left"),angle:e($(a)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(a).attr("data-x"),dataY:$(a).attr("data-y")};o.push(n)}),i.startDraggable=o}else{var s=$(r).attr("data-position"),d=s.split(",")[0],c=s.split(",")[1],u={idItem:$(r).attr("id"),typeContent:$(r).attr("data-type"),typeOperation:"UpdatePosition",top:c,left:d,cssTop:$(r).css("top"),cssLeft:$(r).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(r).attr("data-x"),dataY:$(r).attr("data-y"),dataPosition:s};i.startDraggable=u}},o=function(e){if(t.hasClass("editing-text")&&Text.finishEditingText(),Multidrag.countElements()>0){for(var a=0;a<=Multidrag.countElements();a++)if($(l).attr("id")!==$(Multidrag.multiElements[a]).attr("id")){var n=(parseFloat($(Multidrag.multiElements[a]).attr("data-x"))||0)+e.dx/watching.scale,i=(parseFloat($(Multidrag.multiElements[a]).attr("data-y"))||0)+e.dy/watching.scale;$(Multidrag.multiElements[a]).attr("data-x",n),$(Multidrag.multiElements[a]).attr("data-y",i),$(Multidrag.multiElements[a]).css({left:n,top:i})}}else{var l=e.target,r=(parseFloat(l.getAttribute("data-x"))||0)+e.dx/watching.scale,o=(parseFloat(l.getAttribute("data-y"))||0)+e.dy/watching.scale;$(l).css({top:o,left:r}),l.setAttribute("data-x",r),l.setAttribute("data-y",o)}},s=function(e){var a=e.target;if($("html").hasClass("multidragging")){for(var n=[],r=[],o=0;o<Multidrag.countElements();o++)if("pin"===$(Multidrag.multiElements[o]).attr("data-type")){var s=parseFloat($(Multidrag.multiElements[o]).attr("data-x"))+16/watching.scale,d=parseFloat($(Multidrag.multiElements[o]).attr("data-y"))+32/watching.scale;$(Multidrag.multiElements[o]).attr("data-position",s+","+d),n.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:$(Multidrag.multiElements[o]).attr("id"),TypeItem:$(Multidrag.multiElements[o]).attr("data-type"),Position:{PositionLeft:s,PositionTop:d}}),$("#fake-"+$(Multidrag.multiElements[o]).attr("id")).css({left:s,top:d});var c={idItem:$(Multidrag.multiElements[o]).attr("id"),typeContent:$(Multidrag.multiElements[o]).attr("data-type"),typeOperation:"UpdatePosition",top:d,left:s,cssTop:$(Multidrag.multiElements[o]).css("top"),cssLeft:$(Multidrag.multiElements[o]).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(Multidrag.multiElements[o]).attr("data-x"),dataY:$(Multidrag.multiElements[o]).attr("data-y"),dataPosition:$(Multidrag.multiElements[o]).attr("data-position")};r.push(c)}else{n.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:$(Multidrag.multiElements[o]).attr("id"),TypeItem:$(Multidrag.multiElements[o]).attr("data-type"),Position:{PositionLeft:parseFloat($(Multidrag.multiElements[o]).attr("data-x")),PositionTop:parseFloat($(Multidrag.multiElements[o]).attr("data-y"))}}),$("#fake-"+$(Multidrag.multiElements[o]).attr("id")).css({left:parseFloat($(Multidrag.multiElements[o]).attr("data-x")),top:parseFloat($(Multidrag.multiElements[o]).attr("data-y"))});var c={idItem:$(Multidrag.multiElements[o]).attr("id"),typeContent:$(Multidrag.multiElements[o]).attr("data-type"),typeOperation:"UpdatePosition",top:$(Multidrag.multiElements[o]).css("top"),left:$(Multidrag.multiElements[o]).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(Multidrag.multiElements[o]).attr("data-x"),dataY:$(Multidrag.multiElements[o]).attr("data-y")};r.push(c)}setTimeout(function(){t.removeClass("dragging")},100),Multidrag.savePositioning(n),i.endDraggable=r,UndoRedo.createElement(i.startDraggable,i.endDraggable)}else{Canva.setPositionSelector(a),Canva.loadSelectorConfiguration($(a)),$(a).addClass("working"),$("#"+currentData.IdSlide).css({overflow:""}),l();var u=$("#"+currentData.IdItem),p=watching.scale,g=parseFloat(u.attr("data-x"))+16/p,f=parseFloat(u.attr("data-y"))+32/p;u.attr("data-position",g+","+f),setTimeout(function(){t.removeClass("dragging")},100)}},d=function(){interact(".pin-draggable").draggable({inertia:!1,autoScroll:!0,onstart:r,onmove:o,onend:s,maxPerElement:1})},c=function(){d()};return{start:c}}(),RichContent=function(){function e(e){function n(e){m.css({opacity:"1"}),m.attr("id",e),$("#fake-"+o).attr("id","fake-"+e),m.css({"pointer-events":""}),"undefined"!=typeof twttr&&twttr.widgets.load(),SecondaryActions.hide();var t={title:"Rich Content",idItem:e,typeItem:"content",icon:"airplay",blocked:"",visible:!1,zIndex:c};DesignLayers.pushLayer(t),DesignLayers.reorder()}e=e.replace(/(\r\n|\n|\r)/gm,""),e=e.trim();var i=t.width()/3,l=$("#"+currentData.IdSlide).height()/2-250,r=$("#"+currentData.IdSlide).width()/2-i/2,o=guid(),s=a+"CreateRichContent",d=[],c=ZIndex.getMaximum(),u={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Source:e,Size:{Width:i+"px",Height:"500px"},Rotation:{Rotatione:""},Position:{PositionLeft:r+"px",PositionTop:l+"px"},ZIndex:c,Id:o,Blocked:!1};d.push(u);var p=Genially.templates.richcontent(d),g=Genially.templates.richcontent_clone(d);try{$("#"+currentData.IdSlide).append(p),$("#slide-clone-"+currentData.IdSlide).append(g),SecondaryActions.forceHide()}catch(f){return $("#"+o).remove(),$("#insertContentUrl").val(""),void $("#noRichContent").show()}var m=$("#"+o);m.css("pointer-events","none"),m.css({opacity:"0.5"}),ZIndex.newDivZIndex(),Background.hideSelector();try{ApiGenially.executeCall(u,s,"POST",n)}catch(f){}}var t=$("#wrapperHolder"),a="/api/Content/";return{createContent:e}}(),Resources=function(){function e(){$("html").hasClass("touchevents")?interact(".svg-resource").on("tap",function(e){var t=$(e.target).data("id"),a=$(e.target).attr("src"),n=$("#"+currentData.IdSlide).height()/2-2*$(e.target).height()/2,i=$("#"+currentData.IdSlide).width()/2-2*$(e.target).width()/2;SvgImages.createSvg(i,n,t,a,2*$(e.target).width(),2*$(e.target).height(),$(e.target).attr("data-aspect-ratio")),SecondaryActions.forceHide()}):($(".svg-resource").off("click"),$(".svg-resource").on("click",function(e){var t=$(e.target).data("id"),a=$(e.target).attr("src"),n=$("#"+currentData.IdSlide).height()/2-2*$(e.target).height()/2,i=$("#"+currentData.IdSlide).width()/2-2*$(e.target).width()/2;SvgImages.createSvg(i,n,t,a,2*$(e.target).width(),2*$(e.target).height(),$(e.target).attr("data-aspect-ratio")),SecondaryActions.forceHide()})),$(".svg-resource").draggable({opacity:.7,helper:"clone",appendTo:"body",scroll:!1,zIndex:9999,stop:function(e,t){var a=currentMousePosAtImgInPX(),n=$(t.helper).data("id"),i=$(t.helper).attr("src");SvgImages.createSvg(a.x,a.y,n,i,2*$(t.helper).width(),2*$(t.helper).height(),$(t.helper).attr("data-aspect-ratio"))}}).delay(200).addClass("effect-hover")}function t(){$("html").hasClass("touchevents")?interact(".photo-resource").on("tap",function(e){var t=$(e.target).attr("data-id"),a=$(e.target).attr("src"),n=guid(),i=$("#"+currentData.IdSlide).height()/2-4*$(e.target).height()/2,l=$("#"+currentData.IdSlide).width()/2-4*$(e.target).width()/2;Images.createImgFromPicture(i,l,t,a,n,4*$(e.target).width(),4*$(e.target).height()),SecondaryActions.forceHide()}):($(".photo-resource").off("click"),$(".photo-resource").on("click",function(e){var t=$(e.target).attr("data-id"),a=$(e.target).attr("src"),n=guid(),i=$("#"+currentData.IdSlide).height()/2-4*$(e.target).height()/2,l=$("#"+currentData.IdSlide).width()/2-4*$(e.target).width()/2;Images.createImgFromPicture(i,l,t,a,n,4*$(e.target).width(),4*$(e.target).height()),SecondaryActions.forceHide()})),$(".photo-resource").draggable({opacity:.7,helper:"clone",appendTo:"body",scroll:!1,zIndex:9999,stop:function(e,t){var a=currentMousePosAtImgInPX(),n=$(t.helper).attr("data-id"),i=$(t.helper).attr("src"),l=guid();Images.createImgFromPicture(a.y,a.x,n,i,l,4*$(t.helper).width(),4*$(t.helper).height())}}).delay(200).addClass("effect-hover")}function a(){$("html").hasClass("touchevents")?interact(".image-resource").on("tap",function(e){var t=$(e.target).data("id"),a=$(e.target).attr("data-src"),n=$("#"+currentData.IdSlide).height()/2-2*$(e.target).height()/2,i=$("#"+currentData.IdSlide).width()/2-2*$(e.target).width()/2;Images.createImgFromResource(n,i,a,t,2*$(e.target).width(),2*$(e.target).height()),SecondaryActions.forceHide()}):($(".image-resource").off("click"),$(".image-resource").on("click",function(e){var t=$(e.target).data("id"),a=$(e.target).attr("data-src"),n=$("#"+currentData.IdSlide).height()/2-2*$(e.target).height()/2,i=$("#"+currentData.IdSlide).width()/2-2*$(e.target).width()/2;Images.createImgFromResource(n,i,a,t,2*$(e.target).width(),2*$(e.target).height()),SecondaryActions.forceHide()})),$(".image-resource").draggable({opacity:.7,helper:"clone",appendTo:"body",scroll:!1,zIndex:9999,stop:function(e,t){var a=currentMousePosAtImgInPX(),n=$(t.helper).data("id"),i=$(t.helper).attr("data-src");Images.createImgFromResource(a.y,a.x,i,n,2*$(t.helper).width(),2*$(t.helper).height())}}).delay(200).addClass("effect-hover")}function n(){W.page=W.page+1,h()}function i(e){if(x.html(""),P.hide(),$("#containerResources").masonry(),13===e.which){if(""===S.val())return;T.hide(),P.hide(),W.page=0,h()}}function l(){x.html(""),$("#containerResources").masonry(),T.hide(),P.hide(),W.page=0,h()}function r(){function t(t){for(var a=t.length,n=[],i=0,l=0;l<a;l++)n[l]=new Image,n[l].setAttribute("data-id",t[l].Id),n[l].setAttribute("data-aspect-ratio",t[l].AspectRatio),n[l].src=t[l].SourceSmall,n[l].className="resource svg-resource ui-draggable ui-draggable-handle",n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=a&&e()};k.hide()}x.html(""),ApiGenially.executeCall(null,B,"GET",t)}function o(){function t(t){for(var a=t.length,n=[],i=0,l=0;l<a;l++)n[l]=new Image,n[l].setAttribute("data-id",t[l].Id),n[l].setAttribute("data-aspect-ratio",t[l].AspectRatio),n[l].src=t[l].SourceSmall,n[l].className="resource svg-resource svg-lines-resource ui-draggable ui-draggable-handle",n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=a&&e()};k.hide()}x.html(""),ApiGenially.executeCall(null,M,"GET",t)}function s(t){function a(t){for(var a=t.length,n=[],i=0,l=0;l<a;l++)n[l]=new Image,n[l].setAttribute("data-id",t[l].Id),n[l].setAttribute("data-aspect-ratio",t[l].AspectRatio),n[l].src=t[l].SourceSmall,n[l].className="resource svg-resource svg-buttons-resource ui-draggable ui-draggable-handle",n[l].onload=function(){var t=document.createElement("div");t.className="half-size",$(t).append(this),$("#containerResources").append(t),i++,i>=a&&e()};k.hide(),25===a?(P.show(),T.hide()):(T.show(),P.hide())}0===W&&x.html("");var n=S.val();"undefined"!=typeof t&&(n=""),""===n&&(n="");var i={page:W.page,search:n};ApiGenially.executeCall(i,O,"GET",a)}function d(){function t(t){for(var a=t.length,n=[],i=0,l=0;l<a;l++)n[l]=new Image,n[l].setAttribute("data-id",t[l].Id),n[l].setAttribute("data-aspect-ratio",t[l].AspectRatio),n[l].src=t[l].SourceSmall,n[l].className="resource svg-resource svg-numbers-resource ui-draggable ui-draggable-handle",n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=a&&e()};k.hide()}x.html(""),ApiGenially.executeCall(null,U,"GET",t)}function c(t){function a(t){for(var a=t.length,n=[],i=0,l=0;l<a;l++)n[l]=new Image,n[l].setAttribute("data-id",t[l].Id),n[l].setAttribute("data-aspect-ratio",t[l].AspectRatio),n[l].src=t[l].SourceSmall,n[l].className="resource svg-resource ui-draggable ui-draggable-handle",
n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=a&&e()};k.hide(),25===a?(P.show(),T.hide()):(T.show(),P.hide())}0===W&&x.html("");var n=S.val();"undefined"!=typeof t&&(n="");var i={page:W.page,search:n};ApiGenially.executeCall(i,A,"GET",a)}function u(e){function t(e){for(var t=e.length,n=[],i=0,l=0;l<t;l++)n[l]=new Image,n[l].setAttribute("data-id",e[l].Id),n[l].setAttribute("data-src",e[l].Source),n[l].src=e[l].SourceSmall,n[l].className="resource image-resource ui-draggable ui-draggable-handle",n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=t&&a()};k.hide(),25===t?(P.show(),T.hide()):(T.show(),P.hide())}0===W&&x.html("");var n=S.val();"undefined"!=typeof e&&(n="");var i={page:W.page,search:n};ApiGenially.executeCall(i,R,"GET",t)}function p(){function e(e){for(var t=e.length,n=[],i=0,l=0;l<t;l++)n[l]=new Image,n[l].setAttribute("data-id",e[l].Id),n[l].setAttribute("data-src",e[l].UrlImage),n[l].src=e[l].UrlImage,n[l].className="resource image-resource ui-draggable ui-draggable-handle",n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=t&&a()};k.hide(),25===t?(P.show(),T.hide()):(T.show(),P.hide())}0===W&&x.html("");var t={page:W.page};ApiGenially.executeCall(t,z,"GET",e)}function g(e){function t(e){for(var t=e.length,n=[],i=0,l=0;l<t;l++)n[l]=new Image,n[l].setAttribute("data-id",guid()),n[l].setAttribute("data-src",e[l].Source.replace("http://","https://")),n[l].src=e[l].SourceSmall,n[l].className="resource image-resource ui-draggable ui-draggable-handle",n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=t-1&&a()};k.hide(),25===t?(P.show(),T.hide()):(T.show(),P.hide())}0===W&&x.html("");var n=S.val();"undefined"!=typeof e&&(n="funny"),""===n&&(n="funny");var i={page:W.page,search:n};ApiGenially.executeCall(i,L,"GET",t)}function f(e){function a(e){for(var a=e.length,n=[],i=0,l=0;l<a;l++)n[l]=new Image,n[l].setAttribute("data-id",e[l].Id),n[l].src=e[l].SourceSmall,n[l].className="resource photo-resource ui-draggable ui-draggable-handle",n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=a&&t()};k.hide(),25===a?(P.show(),T.hide()):(T.show(),P.hide())}0===W&&x.html("");var n=S.val();"undefined"!=typeof e&&(n="ipad"),""===n&&(n="ipad");var i={page:W.page,search:n};ApiGenially.executeCall(i,H,"GET",a)}function m(t){function a(t){for(var a=t.length,n=[],i=0,l=0;l<a;l++)n[l]=new Image,n[l].setAttribute("data-id",t[l].Id),n[l].setAttribute("data-aspect-ratio",t[l].AspectRatio),n[l].src=t[l].SourceSmall,n[l].className="resource svg-resource ui-draggable ui-draggable-handle",n[l].onload=function(){$("#containerResources").append(this).masonry("appended",this).masonry(),i++,i>=a&&e()};k.hide(),25===a?(P.show(),T.hide()):(T.show(),P.hide())}0===W&&x.html("");var n=S.val();"undefined"!=typeof t&&(n=""),""===n&&(n="");var i={page:W.page,search:n};ApiGenially.executeCall(i,F,"GET",a)}function h(e){return k.show(),"svg"===W.type&&"figures"===W.category?void r():"svg"===W.type&&"lines"===W.category?void o():"svg"===W.type&&"buttons"===W.category?void s(e):"svg"===W.type&&"numbers"===W.category?void d():"svg"===W.type&&"icons"===W.category?void c(e):"svg"===W.type&&"maps"===W.category?void m(e):"resources"===W.type?void u(e):"custom"===W.type?void p():"gifs"===W.type?void g(e):"photos"===W.type?void f(e):void 0}function v(e,t,a,n){return S.val(""),W.type=e,W.category=t,W.page=0,a===!0?(S.show(),w.show(),h("yes")):(S.hide(),w.hide()),a===!1&&n===!1?(h(),void x.html("")):a===!1&&n===!0?(h(),void x.html("")):(x.html(""),void $("#containerResources").masonry())}function y(){if($(this).data("open")!==!0){C.removeClass("active"),$(this).addClass("active"),T.hide(),P.hide(),C.data("open",!1),$(this).data("open",!0);var e=$(this).data("type"),t=$(this).data("category"),a=$(this).data("search"),n=$(this).data("getmore");v(e,t,a,n)}}function I(){C.click(y),S.keypress(i),D.click(l),P.click(n),$("#containerResources").masonry({itemSelector:".resource",columnWidth:".resource"}),$("#containerResources").masonry()}function b(){I()}var C=$(".shapeCategory"),x=$("#containerResources"),S=$("#inputSearchResources"),w=$("#insertForm"),k=$("#loaderResources"),D=$("#buttonSearchResources"),T=$("#noMoreResources"),P=$("#getMoreResources"),E="/api/Resource/",G="/api/Custom/",B=E+"GetFormsAndFigures",M=E+"GetLines",O=E+"GetButtons",U=E+"GetNumbers",A=E+"GetIcons",R=E+"GetResources",z=G+"GetImages",F=E+"GetMaps",L=E+"GetGifs",H=E+"GetImages",W={type:null,category:null,page:0,itemsPerPage:25};return{start:b}}(),inInput=!1,sel=null,range=null,holdingMetaKey=!1,startDragKeys=[],startDragKey={};$(document).on("focus","input[type=text],input[type=password], textarea",function(e){inInput=!0}),$(document).on("blur","input[type=text],input[type=password], textarea",function(e){inInput=!1}),window.addEventListener("keydown",function(e){var t=e||window.event,a=$("html");if(a.hasClass("modal-open")||a.hasClass("editing-text")||inInput===!0)return[9].indexOf(t.keyCode)>-1&&a.hasClass("editing-text")&&t.preventDefault(),!a.hasClass("modal-open")&&inInput===!1&&a.hasClass("editing-text")&&(90===t.keyCode&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),UndoRedo.undoManager.undo()),90===t.keyCode&&(t.ctrlKey||t.metakey)&&t.shiftKey&&(t.preventDefault(),UndoRedo.undoManager.redo())),!1;90===t.keyCode&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),UndoRedo.undoManager.undo()),90===t.keyCode&&(t.ctrlKey||t.metakey)&&t.shiftKey&&(t.preventDefault(),UndoRedo.undoManager.redo()),68!==t.keyCode||!t.ctrlKey&&!t.metaKey||a.hasClass("multidrag")||(t.preventDefault(),DesignMode.toggleDesignMode()),76!==t.keyCode||!t.ctrlKey&&!t.metaKey||a.hasClass("multidrag")||(t.preventDefault(),t.stopPropagation(),DesignLayers.toggleDesignLayers());var n=90;return(t.ctrlKey||t.metaKey)&&t.keyCode===n?(t.preventDefault(),!1):void([9,38,40].indexOf(t.keyCode)>-1&&t.preventDefault())},!1),$(document).keydown(function(e){var t=e||window.event,a=$("html");if(!a.hasClass("modal-open")){if(a.hasClass("editing-text"))return void(27===t.keyCode&&Text.finishEditingText());if(!a.hasClass("editing-layer")&&inInput!==!0)if(46!==t.keyCode&&8!==t.keyCode||a.hasClass("modal-open")){if(null!==currentData.IdItem&&"pin"!==currentData.TypeItem){if(0===$("#"+currentData.IdItem).length)return;if($("#"+currentData.IdItem).hasClass("blocked"))return;var n=$("#"+currentData.IdItem);if("undefined"==typeof n.css("left")||"undefined"==typeof n.css("top"))return;var i=parseInt(n.css("left").replace("px","")),l=parseInt(n.css("top").replace("px",""));switch($("html").hasClass("has-scroll")&&t.preventDefault(),t.keyCode){case 37:n.css({left:i-1}),n.attr("data-x",i-1);break;case 38:n.css({top:l-1}),n.attr("data-y",l-1);break;case 39:n.css({left:i+1}),n.attr("data-x",i+1);break;case 40:n.css({top:l+1}),n.attr("data-y",l+1);break;default:return}startDragKey.idItem!==currentData.IdItem&&(startDragKey={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:n.css("width"),height:n.css("height"),top:n.css("top"),left:n.css("left"),angle:Canva.getRotationStyle($("#"+currentData.IdItem)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:n.attr("data-x"),dataY:n.attr("data-y")}),DesignMode.setDesignObject(currentData.IdItem),Canva.setPositionSelector(n[0])}else 0===Multidrag.countElements()||Multidrag.allSame("pin")||($("html").hasClass("has-scroll")&&t.preventDefault(),$.each(Multidrag.multiElements,function(e,a){if("undefined"!=typeof a.css("left")&&"undefined"!=typeof a.css("top")){var n=parseInt(a.css("left").replace("px","")),i=parseInt(a.css("top").replace("px",""));switch(t.keyCode){case 37:a.css({left:n-1}),a.attr("data-x",n-1);break;case 38:a.css({top:i-1}),a.attr("data-y",i-1);break;case 39:a.css({left:n+1}),a.attr("data-x",n+1);break;case 40:a.css({top:i+1}),a.attr("data-y",i+1);break;default:return}for(var l=!1,r=0;r<startDragKeys.length&&!l;r++)startDragKeys[r].idItem===$(a).attr("id")&&(l=!0);if(!l){var o={idItem:$(a).attr("id"),typeContent:$(a).attr("data-type"),typeOperation:"UpdatePosition",width:$(a).css("width"),height:$(a).css("height"),top:$(a).css("top"),left:$(a).css("left"),angle:Canva.getRotationStyle($(a)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(a).attr("data-x"),dataY:$(a).attr("data-y")};startDragKeys.push(o)}}}));if("background"===currentData.TypeItem){var r=$("#"+currentData.IdSlide).find(".current-background-slide");if(0===r.length)return;if(r.hasClass("blocked"))return;var o=parseInt(r.css("left").replace("px","")),s=parseInt(r.css("top").replace("px",""));switch(t.keyCode){case 37:r.css({left:o-1});break;case 38:r.css({top:s-1});break;case 39:r.css({left:o+1});break;case 40:r.css({top:s+1});break;default:return}Background.resizeCorners()}}else(null!==currentData.IdItem||Multidrag.countElements()>0)&&swal({title:locale["delete"].titleConfirmDelete,text:locale["delete"].textConfirmDelete,type:"warning",showCancelButton:!0,confirmButtonColor:"#bc2360",confirmButtonText:locale["delete"].confirmButtonText,cancelButtonText:locale.generic.cancelButtonText,closeOnConfirm:!0},function(e){e&&(Multidrag.countElements()>0?Delete.removeMultiItems():Delete.removeItem(currentData.IdItem))})}}),$(document).keyup(function(e){var t=e||window.event,a=$("html");if(!a.hasClass("modal-open")&&!a.hasClass("editing-text")&&!a.hasClass("editing-layer")&&inInput!==!0){var n=[37,38,39,40];if(!(n.indexOf(t.keyCode)<0)){if(null!==currentData.IdItem&&"pin"!==currentData.TypeItem){if(0===$("#"+currentData.IdItem).length)return;if($("#"+currentData.IdItem).hasClass("blocked"))return;var i=$("#"+currentData.IdItem);Canva.setPositionSelector(i[0]),Canva.saveDraggable();var l={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:i.css("width"),height:i.css("height"),top:i.css("top"),left:i.css("left"),angle:Canva.getRotationStyle($("#"+currentData.IdItem)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:i.attr("data-x"),dataY:i.attr("data-y")};UndoRedo.createElement(startDragKey,l),startDragKey={}}else if(0!==Multidrag.countElements()&&!Multidrag.allSame("pin")){for(var r=[],o=[],s=0;s<Multidrag.countElements();s++){var d=$(Multidrag.multiElements[s]).css("left"),c=$(Multidrag.multiElements[s]).css("top"),u=$(Multidrag.multiElements[s]).css("left").replace("px",""),p=$(Multidrag.multiElements[s]).css("top").replace("px","");$(Multidrag.multiElements[s]).attr("data-position",u+","+p),r.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:$(Multidrag.multiElements[s]).attr("id"),TypeItem:$(Multidrag.multiElements[s]).attr("data-type"),Position:{PositionLeft:u,PositionTop:p}});var g={idItem:$(Multidrag.multiElements[s]).attr("id"),typeContent:$(Multidrag.multiElements[s]).attr("data-type"),typeOperation:"UpdatePosition",top:c,left:d,cssTop:$(Multidrag.multiElements[s]).css("top"),cssLeft:$(Multidrag.multiElements[s]).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(Multidrag.multiElements[s]).attr("data-x"),dataY:$(Multidrag.multiElements[s]).attr("data-y")};o.push(g)}UndoRedo.createElement(startDragKeys,o),Multidrag.savePositioning(r),startDragKeys=[]}if("background"===currentData.TypeItem){var f=$("#"+currentData.IdSlide).find(".current-background-slide");if(0===f.length)return;if(f.hasClass("blocked"))return;var m=parseInt(f.css("left").replace("px","")),h=parseInt(f.css("top").replace("px",""));Background.savePosition(m+"px",h+"px")}}}}),function(e){"object"==typeof module&&"object"==typeof module.exports?module.exports=function(t){e(t)}:e(_)}(function(e){function t(t){function a(){n(),u=JSON.parse(JSON.stringify(t))}function n(){e.each(p.generic,function(e){e(t,u)})}function i(t,a){e.each(p.create,function(e){e(t,a)})}function l(t,a,n){e.each(p.update,function(e){e(t,a,n)})}function r(t,a){e.each(p["delete"],function(e){e(t,a)})}function s(){var n=u.length,o=t.length;if(n!==o||JSON.stringify(u)!==JSON.stringify(t)){for(var s=Math.max(o,n)-1,d=s;d>=0;d--){var c=u[d],p=t[d];d>n-1?i(p,d):d>o-1?r(c,d):e.isEqual(p,c)||l(p,c,d)}a()}}function d(e,a){o?Object.defineProperty(t,e,{value:a}):t[e]=a}var c=!0,u=[],p={generic:[],create:[],update:[],"delete":[]};return d("pop",function(){s();var e=Array.prototype.pop.apply(this,arguments),t=this.length;return r(e,t),a(),e}),d("push",function(){s();var e=arguments[0],t=Array.prototype.push.apply(this,arguments);return i(e,t-1),a(),t}),d("reverse",function(){s();for(var t=this.length-1;t>=0;t--)r(this[t],t);var n=Array.prototype.reverse.apply(this,arguments);return e.each(this,i),a(),n}),d("shift",function(){s();var e=Array.prototype.shift.apply(this,arguments);return r(e,0),a(),e}),d("sort",function(){s();for(var t=this.length-1;t>=0;t--)r(this[t],t);var n=Array.prototype.sort.apply(this,arguments);return e.each(this,i),a(),n}),d("splice",function(t){s();for(var n=Array.prototype.slice.call(arguments,2),l=Array.prototype.splice.apply(this,arguments),o=l.length-1;o>=0;o--)r(l[o],t+o);return e.each(n,function(e,a){i(e,t+a)}),a(),l}),d("unshift",function(){s();var t=Array.prototype.unshift.apply(this,arguments);return e.each(arguments,function(e,t){i(e,t)}),a(),t}),{detectChanges:s,unbind:function(t,a){e.isUndefined(t)&&e.isUndefined(a)?e.each(p,function(e){e.length=0}):e.isString(t)&&e.isUndefined(a)?p[t].length=0:e.isFunction(t)&&e.isUndefined(a)?(a=t,t="generic",p[t]=e.without(p[t],a)):e.isString(t)&&e.isFunction(a)&&(p[t]=e.without(p[t],a))},bind:function(a,n){p[a].push(n),"generic"===a?n(t,u):"create"===a&&e.each(t,function(e,t){n(e,t)}),c&&(u=JSON.parse(JSON.stringify(t)),c=!1)}}}function a(){return r.length?(e.each(r,function(e){e.detectChanges()}),void n()):void(i=null)}function n(){i&&clearTimeout(i),i=setTimeout(a,250)}var i,l=[],r=[],o=!!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions);e.mixin({observe:function(a,i,o){if(!e.isArray(a))throw"subject should be a array";e.isFunction(i)&&(o=i,i="generic");var s=e.indexOf(l,a);if(s===-1){s=l.length,l.push(a);var d=new t(a);r.push(d)}return r[s].bind(i,o),n(),a},unobserve:function(t,a,n){if(!arguments.length)return e.each(r,function(e){e.unbind()}),l.length=0,void(r.length=0);if(!e.isArray(t))throw"subject should be a array";var i=e.indexOf(l,t);if(i!==-1)return r[i].unbind(a,n),t}})});var isSaving=!1,ApiGenially=function(){function e(){function e(){return $.ajax({data:t.dto,url:t.urlApi,type:t.method,contentType:"application/json; charset=utf-8"})}var t=n[0];"GET"!==t.method&&(t.dto=JSON.stringify(t.dto));var a=function(e){t.callBackOk(e),n.shift()},i=function(e){t.callBackFail(e),n.shift()};e().done(a).fail(i)}function t(e,t,a,i,l){function r(e,t,a){}function o(e,t,a){return 401===e.status?(window.onbeforeunload=null,void location.reload()):("timeout"===t&&(notify.message=locale.error.timeoutTitle,notify.type="danger",notify.delay=5e3,notify.show()),void SaveDisplay.showError())}SaveDisplay.show(),"undefined"==typeof i&&(i=r),"undefined"==typeof l&&(l=o);var s={dto:e,urlApi:t,method:a,callBackOk:i,callBackFail:l};n.push(s)}function a(e,t,a){function n(){}function i(){}function l(){return $.ajax({data:e,url:t,type:a,contentType:"application/json; charset=utf-8",xhrFields:{withCredentials:!0}})}"GET"!==a&&(e=JSON.stringify(e)),l().done(n).fail(i)}var n=[];return _.observe(n,"create",function(t,a){1===n.length&&(e(),isSaving=!0)}),_.observe(n,"delete",function(t,a){0!==n.length?e():(SaveDisplay.hide(),isSaving=!1)}),{executeCall:t,executeCallDirect:a}}(),Images=function(){function e(e,t,a,n,i,l){function o(){f.remove(),SaveDisplay.showErrorImage()}function s(e){f.removeClass("div-loader-image"),f.find(".loader-image").remove(),f.find("img").css({opacity:"1"}),f.attr("id",e),f.css({"pointer-events":""}),$("#fake-"+n).attr("id","fake-"+e);var t={title:"Image Element",idItem:e,typeItem:"image",icon:"wallpaper",blocked:"",visible:!1,zIndex:p};DesignLayers.pushLayer(t),DesignLayers.reorder()}var d="",c="",u=[],p=ZIndex.getMaximum(),g={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Source:a,Name:"",Size:{Width:i+"px",Height:l+"px"},Rotation:{Rotatione:""},EffectIn:"none",EffectOut:"none",EffectHover:"none",Effect:"none",DurationIn:"vel3",DurationOut:"vel3",DelayOut:0,DelayIn:0,Position:{PositionLeft:t+"px",PositionTop:e+"px"},ZIndex:p,Id:n,Blocked:!1};u.push(g),d+=Genially.templates.image_new(u),c+=Genially.templates.image_new_clone(u),$("#"+currentData.IdSlide).append(d),$("#slide-clone-"+currentData.IdSlide).append(c),ZIndex.newDivZIndex();var f=$("#"+n);f.append('<div class="loader-image"></div>');var m=r+"CreateImageFromResource";f.css("pointer-events","none"),f.find("img").css({opacity:"0.5"}),f.addClass("div-loader-image"),ApiGenially.executeCall(g,m,"POST",s,o)}function t(e,t,a,n,i,l,o){function s(){m.remove(),SaveDisplay.showErrorImage()}function d(e){m.removeClass("div-loader-image"),m.find(".loader-image").remove(),m.find("img").css({opacity:"1"}),m.find("img").attr("src",e.UrlImage),m.attr("id",e.IdImage),m.css({"pointer-events":""}),$("#fake-"+i).attr("id","fake-"+e.IdImage),$("#fake-"+e.IdImage).find("img").attr("src",e.UrlImage);var t={title:"Image Element",idItem:e.IdImage,typeItem:"image",icon:"wallpaper",blocked:"",visible:!1,zIndex:g};DesignLayers.pushLayer(t),DesignLayers.reorder()}if(0!==l&&0!==o){var c="",u="",p=[],g=ZIndex.getMaximum(),f={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Source:a,Name:"",Size:{Width:l+"px",Height:o+"px"},Rotation:{Rotatione:""},EffectIn:"none",EffectOut:"none",EffectHover:"none",Effect:"none",DurationIn:"vel3",DurationOut:"vel3",DelayOut:0,DelayIn:0,Position:{PositionLeft:t+"px",PositionTop:e+"px"},ZIndex:g,Id:i,Blocked:!1};p.push(f),c+=Genially.templates.image_new(p),u+=Genially.templates.image_new_clone(p),$("#"+currentData.IdSlide).append(c),$("#slide-clone-"+currentData.IdSlide).append(u),ZIndex.newDivZIndex();var m=$("#"+i);m.find("img").attr("src",n),m.append('<div class="loader-image"></div>');var h=r+"CreateImageFromPicture";m.css("pointer-events","none"),m.find("img").css({opacity:"0.5"}),m.addClass("div-loader-image"),ApiGenially.executeCall(f,h,"POST",d,s)}}function a(e,t,a,n,i,l){function o(){$("#fake-"+n).remove(),m.remove(),SaveDisplay.showErrorImage()}function s(e){m.removeClass("div-loader-image"),m.find(".loader-image").remove(),m.find("img").css({opacity:"1"}),m.find("img").attr("src",e.UrlImage),m.attr("id",e.IdImage),m.css({"pointer-events":""}),$("#fake-"+n).attr("id","fake-"+e.IdImage),$("#fake-"+e.IdImage).find("img").attr("src",e.UrlImage);var t={title:"Image Element",idItem:e.IdImage,typeItem:"image",icon:"wallpaper",blocked:"",visible:!1,zIndex:p};DesignLayers.pushLayer(t),DesignLayers.reorder()}if(0!==i&&0!==l){var d="",c="",u=[],p=ZIndex.getMaximum(),g=$(".current-slide").find(".slide-page").width();i>g&&(l=l*g/i,l=Math.ceil(1*l)/1,i=g);var f={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Source:a,Name:"",Size:{Width:i+"px",Height:l+"px"},Rotation:{Rotatione:""},EffectIn:"none",EffectOut:"none",EffectHover:"none",Effect:"none",DurationIn:"vel3",DurationOut:"vel3",DelayOut:0,DelayIn:0,Position:{PositionLeft:t+"px",PositionTop:e+"px"},ZIndex:p,Id:n,Blocked:!1};u.push(f),d+=Genially.templates.image_new(u),c+=Genially.templates.image_new_clone(u),$("#"+currentData.IdSlide).append(d),$("#slide-clone-"+currentData.IdSlide).append(c),ZIndex.newDivZIndex();var m=$("#"+n);m.append('<div class="loader-image"></div>');var h=r+"CreateImage";m.css("pointer-events","none"),m.find("img").css({opacity:"0.5"}),m.addClass("div-loader-image"),ApiGenially.executeCall(f,h,"POST",s,o)}}function n(e){var t=$("#thumbsPreview").find('[data-id="'+e+'"]');$("html").hasClass("touchevents")?interact(t[0]).on("tap",function(e){var n=$("#"+currentData.IdSlide).height()/2-t.height()/2,i=$("#"+currentData.IdSlide).width()/2-t.width()/2;a(n,i,$(e.target).attr("src"),$(e.target).data("id"),t.width(),t.height()),$(this).remove(),$(e.target).remove(),SecondaryActions.forceHide()}):t.on("click",function(e){var n=$("#"+currentData.IdSlide).height()/2-t.height()/2,i=$("#"+currentData.IdSlide).width()/2-t.width()/2;a(n,i,$(e.target).attr("src"),$(e.target).data("id"),t.width(),t.height()),$(this).remove(),$(e.target).remove(),SecondaryActions.forceHide()})}function i(){$(".image-preview").draggable({opacity:.7,helper:function(){var e=$(this).clone();return e.width($(this).width()),e.height($(this).height()),e},appendTo:"body",scroll:!1,stop:function(e,t){var n=currentMousePosAtImgInPX();a(n.y,n.x,t.helper.attr("src"),t.helper.data("id"),t.helper.width(),t.helper.height()),$(this).remove(),t.helper.remove(),0===$("#thumbsPreview").find(".image-preview").length&&SecondaryActions.forceHide()},zIndex:9e3})}function l(){i(),f.events()}var r="/api/image/",o=$("#loadingUrlImage"),s=$("#insertURLImageInput"),d=function(e,t,a){a=a||5e3;var n,i=!1,l=new Image;l.onerror=l.onabort=function(){i||(clearTimeout(n),t(e,"error"))},l.onload=function(){i||(clearTimeout(n),t(e,"success"))},l.src=e,n=setTimeout(function(){i=!0,l.src="//!!!!/test.jpg",t(e,"timeout")},a)},c=function(e,t){var a=new Image;a.src=e,a.onload=function(){t(this.width,this.height)}},u=function(e,t){var a=guid();"success"===t?c(e,function(t,n){var i=$("#"+currentData.IdSlide).height()/2-n/2,l=$("#"+currentData.IdSlide).width()/2-t/2;Images.createImgFromPicture(i,l,e,e,a,t,n),o.css({"pointer-events":""}),o.html("cloud_upload"),o.removeClass("animation-loader"),s.val("")}):(s.val(locale.image.invalid),o.css({"pointer-events":""}),o.html("cloud_upload"),o.removeClass("animation-loader"),$("#"+a).remove())},p=function(){var e=s.val();""!==e&&(o.css({"pointer-events":"none"}),o.html("cached"),o.addClass("animation-loader"),d(e,u,200))},g=function(){s.val()===locale.image.invalid&&s.val("")},f={events:function(){function e(e){window.File&&window.FileReader&&window.FileList&&window.Blob;var t=document.getElementById("thumbsPreview");e.stopPropagation(),e.preventDefault();var a;"drop"===e.type?a=e.dataTransfer.files:"change"===e.type&&(a=e.target.files);for(var l,r=0;l=a[r];r++)if(l.type.match("image.*")&&!l.type.match("image.bmp")){var o=new FileReader,s=l.size;s>5242880?swal({title:locale.image.titleImageTooBig,text:locale.image.textImageTooBigSome,type:"info",confirmButtonColor:"#bc2360",confirmButtonText:locale.image.confirmButtonText,closeOnConfirm:!0}):(o.onload=function(e){return function(e){var a=new Image;$(a).on("load",function(){$(a).attr("data-width",a.width),$(a).attr("data-height",a.height);var e=guid();$(a).attr("data-id",e),$(a).attr("title",locale.image.dragMe),$(a).addClass("image-preview"),$(t).append(a),i(),n(e)}),a.src=e.target.result}}(l),o.readAsDataURL(l))}document.getElementById("dropFiles").value=""}function t(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}var a=document.getElementById("imagesDropper");a.addEventListener("dragover",t,!1),a.addEventListener("drop",e,!1),document.getElementById("dropFiles").addEventListener("change",e,!1),$("#insertURLImageButton").click(p),s.focus(g)}};return{start:l,createImgFromResource:e,createImgFromPicture:t}}(),Slide=function(){function e(e){function t(e){for(var t=0;t<e.length;t++){var a=$("#slide-side-"+e[t].Id);a.find(".slide-preview").find(".order-number-slide").text(e[t].Order),a.attr("data-order",e[t].Order)}}function a(){SaveDisplay.showError()}$("#slide-side-"+e).parent().remove(),$("#slide-side-"+e).remove(),$("#slideHolder-"+e).remove();var n={IdGenially:currentData.IdGenially,IdSlide:e},i=l+"Delete";ApiGenially.executeCall(n,i,"DELETE",t,a)}function t(e){function t(t){dataGenially.Slides.push(t),Editor.loadSlides(t),EventsEditor.hideSlidesFromTemplate(),SvgImages.printColorsSvg(),Editor.blockElements(),setTimeout(function(){$("#slidesContent").scrollTop($("#slidesContent")[0].scrollHeight),$("#slide-side-"+e).removeClass("opacity-05").css("pointer-events","all"),$("#slide-preview-"+t.Id).click()},300)}function a(){SaveDisplay.showError()}var n={IdGenially:currentData.IdGenially,IdSlide:e},i=l+"DuplicateSlide";ApiGenially.executeCall(n,i,"POST",t,a)}function a(e,t){var a={Name:t,IdGenially:currentData.IdGenially,IdSlide:e},n=l+"UpdateName";ApiGenially.executeCall(a,n,"PUT")}function n(e){function t(e){var t=$.map(e,function(e){if("Tahoma"!==e.FontFamily&&e.FontFamily.indexOf("customgenially")===-1)return e.FontFamily}),a=$.unique(t);return a}function a(a){dataGenially.Slides.push(a),Editor.loadSlides(a),EventsEditor.hideSlidesFromTemplate(),SvgImages.printColorsSvg();var n=t(a.Texts);Editor.loadNewFonts(n),setTimeout(function(){$("#slidesContent").scrollTop($("#slidesContent")[0].scrollHeight),$("#slide-side-"+e).removeClass("opacity-05").css("pointer-events","all")},300)}function n(){SaveDisplay.showError()}var i,l="/api/Slide/CreateFromOtherSlide",r="/api/Slide/CreateBlankSlide";"undefined"==typeof e?(i={IdGenially:currentData.IdGenially},ApiGenially.executeCall(i,r,"PUT",a,n)):null!==e&&(i={IdSlide:e,IdGenially:currentData.IdGenially},ApiGenially.executeCall(i,l,"PUT",a,n))}function i(e,t){function a(e){for(var t=0;t<e.length;t++)$("#slide-preview-"+e[t].Id).find(".order-number-slide").text(e[t].Order),$("#slide-side-"+e[t].Id).attr("data-order",e[t].Order)}function n(){SaveDisplay.showError()}var i=l+"Reorder",r={IdSlide:t,IdGenially:currentData.IdGenially,Order:e};ApiGenially.executeCall(r,i,"PUT",a,n)}var l="/api/Slide/";return{deleteSlide:e,duplicateSlide:t,renameSlide:a,newSlide:n,updateOrder:i}}(),ZIndex=function(){function e(){p=1,g=0,m=[];var e=$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)");if(0!==e.length){e.each(function(){var e=parseInt($(this).css("z-index"),10);isNaN(e)&&(e=1);var t=[$(this).attr("id"),e,$(this).attr("data-type")];m.push(t)});var t=m.map(function(e,t){return e[1]});t.maximum=function(){return Math.max.apply(Math,this)},g=t.maximum()}}function t(e){var t={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,ListZIndexItems:e};ApiGenially.executeCall(t,f,"PUT")}function a(){var e=$("html");if(e.hasClass("multidrag")&&0!==Multidrag.countElements())$.each(Multidrag.multiElements,function(e,t){});else{var a=$("#"+currentData.IdItem),n=0;a.hasClass("blocked")?(a.removeClass("blocked"),n=parseInt(a.css("z-index")),a.addClass("blocked")):n=parseInt(a.css("z-index"));var i=[];if(n===g||1===$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").length)return;$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").each(function(){var e=0;$(this).hasClass("blocked")?($(this).removeClass("blocked"),e=parseInt($(this).css("z-index")),$(this).addClass("blocked")):e=parseInt($(this).css("z-index")),e===n+1&&($(this).css("z-index",n),DesignLayers.updateLayerZIndex($(this).attr("id"),n),i.push({IdElement:$(this).attr("id"),ZIndex:n,Type:$(this).attr("data-type")}))}),a.css("z-index",n+1),i.push({IdElement:a.attr("id"),ZIndex:n+1,Type:a.attr("data-type")}),DesignLayers.updateLayerZIndex(a.attr("id"),n+1),DesignLayers.reorder(),t(i)}}function n(){var e=$("html");if(e.hasClass("multidrag")&&0!==Multidrag.countElements());else{var a=$("#"+currentData.IdItem),n=0;a.hasClass("blocked")?(a.removeClass("blocked"),n=parseInt(a.css("z-index")),a.addClass("blocked")):n=parseInt(a.css("z-index"));var i=[];if(n===p||1===$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").length)return;$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").each(function(){var e=0;$(this).hasClass("blocked")?($(this).removeClass("blocked"),e=parseInt($(this).css("z-index")),$(this).addClass("blocked")):e=parseInt($(this).css("z-index")),e===n-1&&($(this).css("z-index",n),DesignLayers.updateLayerZIndex($(this).attr("id"),n),i.push({IdElement:$(this).attr("id"),ZIndex:n,Type:$(this).attr("data-type")}))}),a.css("z-index",n-1),i.push({IdElement:a.attr("id"),ZIndex:n-1,Type:a.attr("data-type")}),DesignLayers.updateLayerZIndex(a.attr("id"),n-1),DesignLayers.reorder(),t(i)}}function i(){var e=$("html");if(e.hasClass("multidrag")&&0!==Multidrag.countElements());else{var a=$("#"+currentData.IdItem),n=0;a.hasClass("blocked")?(a.removeClass("blocked"),n=parseInt(a.css("z-index")),a.addClass("blocked")):n=parseInt(a.css("z-index"));var i=[];if(n===g||1===$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").length)return;$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").each(function(){var e=0;if($(this).hasClass("blocked")?($(this).removeClass("blocked"),e=parseInt($(this).css("z-index")),$(this).addClass("blocked")):e=parseInt($(this).css("z-index")),e>n){var t=parseInt($(this).css("z-index"));$(this).css("z-index",t-1),DesignLayers.updateLayerZIndex($(this).attr("id"),t-1),i.push({IdElement:$(this).attr("id"),ZIndex:t-1,Type:$(this).attr("data-type")})}}),a.css("z-index",g),i.push({IdElement:a.attr("id"),ZIndex:g,Type:a.attr("data-type")}),DesignLayers.updateLayerZIndex(a.attr("id"),g),DesignLayers.reorder(),t(i)}}function l(){var e=$("html");if(e.hasClass("multidrag")&&0!==Multidrag.countElements());else{var a=$("#"+currentData.IdItem),n=[],i=0;if(a.hasClass("blocked")?(a.removeClass("blocked"),i=parseInt(a.css("z-index")),a.addClass("blocked")):i=parseInt(a.css("z-index")),i===p||1===$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").length)return;$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").each(function(){var e=0;if($(this).hasClass("blocked")?($(this).removeClass("blocked"),e=parseInt($(this).css("z-index")),$(this).addClass("blocked")):e=parseInt($(this).css("z-index")),e<i){var t=parseInt($(this).css("z-index"));$(this).css("z-index",t+1),DesignLayers.updateLayerZIndex($(this).attr("id"),t+1),n.push({IdElement:$(this).attr("id"),ZIndex:t+1,Type:$(this).attr("data-type")})}}),a.css("z-index",p),n.push({IdElement:a.attr("id"),ZIndex:p,Type:a.attr("data-type")}),DesignLayers.updateLayerZIndex(a.attr("id"),p),DesignLayers.reorder(),t(n)}}function r(){g<0&&(g*=-1),g+=1}function o(e){var a=[],n=0;e.hasClass("blocked")?(e.removeClass("blocked"),n=parseInt(e.css("z-index")),e.addClass("blocked")):n=parseInt(e.css("z-index")),$("#"+currentData.IdSlide).find(".element:not(.pin-draggable, .div-loader-image)").each(function(){var e=0;if($(this).hasClass("blocked")?($(this).removeClass("blocked"),e=parseInt($(this).css("z-index")),$(this).addClass("blocked")):e=parseInt($(this).css("z-index")),e>n){var t=parseInt($(this).css("z-index"));$(this).css("z-index",t-1),a.push({IdElement:$(this).attr("id"),ZIndex:t-1,Type:$(this).attr("data-type")})}}),g-=1,g<0&&(g*=-1),t(a)}function s(){return g<0&&(g*=-1),g+1}function d(){return p}function c(){$("#generalBringBackDiv").click(l),$("#generalBringFrontDiv").click(i),$("#generalUpDiv").click(a),$("#generalDownDiv").click(n)}function u(){c(),e()}var p=1,g=0,f="/api/ZIndex/Reorder",m=[];return{start:u,getMaximum:s,getMinimum:d,newDivZIndex:r,deleteDivZIndex:o,getCurrentValuesZIndex:e}}(),Setting=function(){function e(e){var t={IsDraggable:e,IdGenially:currentData.IdGenially},a=h+"UpdateDrag";ApiGenially.executeCall(t,a,"PUT")}function t(e){var t={IsPaintable:e,IdGenially:currentData.IdGenially},a=h+"UpdatePaint";ApiGenially.executeCall(t,a,"PUT")}function a(e){var t={ShowPage:e,IdGenially:currentData.IdGenially},a=h+"UpdatePagination";ApiGenially.executeCall(t,a,"PUT")}function n(e){var t={LoadMobile:e,IdGenially:currentData.IdGenially},a=h+"UpdateLoadMobile";ApiGenially.executeCall(t,a,"PUT")}function i(e){var t={DisableTitles:e,
IdGenially:currentData.IdGenially},a=h+"UpdateTooltip";ApiGenially.executeCall(t,a,"PUT")}function l(e,t,a){var n={ShowPage:e,IdGenially:currentData.IdGenially,AutoPagination:e,BucleAutoPagination:a,TimePagination:t},i=h+"UpdateAutoPagination";ApiGenially.executeCall(n,i,"PUT")}function r(e){var t={Public:e,IdGenially:currentData.IdGenially},a=h+"UpdatePublish";ApiGenially.executeCall(t,a,"PUT")}function o(e){var t={Password:e,IdGenially:currentData.IdGenially},a=h+"UpdatePassword";ApiGenially.executeCall(t,a,"PUT")}function s(e){var t={IdGenially:currentData.IdGenially,TooltTipStyle:e},a=h+"UpdateStyleToolTip";ApiGenially.executeCall(t,a,"PUT")}function d(e){var t={DisableShare:e,IdGenially:currentData.IdGenially},a=h+"UpdateShare";ApiGenially.executeCall(t,a,"PUT")}function c(e){var t={FullScreen:e,IdGenially:currentData.IdGenially},a=h+"UpdateFullScreen";ApiGenially.executeCall(t,a,"PUT")}function u(e){var t={Name:e,IdGenially:currentData.IdGenially},a=h+"updateName";dataGenially.Name=e,ApiGenially.executeCall(t,a,"PUT")}function p(e){var t={Description:e,IdGenially:currentData.IdGenially},a=h+"UpdateDescription";ApiGenially.executeCall(t,a,"PUT")}function g(e){var t={Tags:e,IdGenially:currentData.IdGenially},a=h+"UpdateTags";ApiGenially.executeCall(t,a,"PUT")}function f(e){var t={HideLogo:e,IdGenially:currentData.IdGenially},a=h+"UpdateHideLogo";ApiGenially.executeCall(t,a,"PUT")}function m(){var e=$("#widthSlide").val(),t=$("#heightSlide").val(),a={IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially,Size:{Width:e,Height:t}},n="/api/slide/resizeslide",i=document.getElementById(currentData.IdSlide),l=document.getElementById("slideHolder-"+currentData.IdSlide);$("#"+currentData.IdSlide).css({width:e,height:t}),$("#"+currentData.IdSlide).find(".slide-page-container").css({width:e,height:t}),Canva.unselectItem(),Canva.hideSettings(),fitJs[currentData.IdSlide]=fit(i,l,{hAlign:fit.CENTER,vAlign:fit.CENTER,cover:!1,watch:!0,apply:!0});var r=document.getElementById("slide-clone-"+currentData.IdSlide),o=document.getElementById("container-clone-"+currentData.IdSlide);$("#slide-clone-"+currentData.IdSlide).css({width:e,height:t}),fit(r,o,{hAlign:fit.CENTER,vAlign:fit.CENTER,cover:!1,watch:!1,apply:!0}),ZoomGenially.resetAllZoom(currentData.IdSlide),Editor.loadCurrentScale(),ApiGenially.executeCall(a,n,"PUT")}var h="/api/Settings/";return{updatePagination:a,updateTitles:i,updateVideoMode:l,updatePrivacy:r,updateTooltipStyle:s,updateName:u,updateDescription:p,updateSeoKeyWords:g,updateHideLogo:f,updateShare:d,updateFullScreen:c,updatePassword:o,updateSize:m,updateDrag:e,updatePaint:t,updateLoadMobile:n}}(),AnimationsEditor=function(){function e(e){var t=0;switch(e){case"vel5":t=4;break;case"vel4":t=3;break;case"vel3":t=2;break;case"vel2":t=1;break;case"vel1":t=0;break;default:t=2}return t}function t(){T.hide(),D.show()}function a(){D.hide(),T.show(),Q.click()}function n(){return te}function i(){var e=$("#"+currentData.IdItem);te={data_effect:e.attr("data-effect"),data_effect_hover:e.attr("data-effect-hover"),data_effect_out:e.attr("data-effect-out"),data_effect_in:e.attr("data-effect-in"),data_vel_out:e.attr("data-vel-out"),data_vel_in:e.attr("data-vel-in"),data_delay_in:e.attr("data-delay-in"),data_delay_out:e.attr("data-delay-out")},c(),V.addClass("effects-copied"),setTimeout(function(){V.removeClass("effects-copied")},500)}function l(){var e=[];if(Multidrag.countElements()>0){for(var t=0;t<Multidrag.countElements();t++)if(!$(Multidrag.multiElements[t]).hasClass("area-draggable")){var a=!1;$(Multidrag.multiElements[t]).attr("data-effect")===te.data_effect&&$(Multidrag.multiElements[t]).attr("data-effect-hover")===te.data_effect_hover&&$(Multidrag.multiElements[t]).attr("data-effect-out")===te.data_effect_out&&$(Multidrag.multiElements[t]).attr("data-effect-in")===te.data_effect_in&&$(Multidrag.multiElements[t]).attr("data-vel-out")===te.data_vel_out&&$(Multidrag.multiElements[t]).attr("data-vel-in")===te.data_vel_in&&$(Multidrag.multiElements[t]).attr("data-delay-in")===te.data_delay_in&&$(Multidrag.multiElements[t]).attr("data-delay-out")===te.data_delay_out||(a=!0),$(Multidrag.multiElements[t]).attr("data-effect",te.data_effect),$(Multidrag.multiElements[t]).attr("data-effect-hover",te.data_effect_hover),$(Multidrag.multiElements[t]).attr("data-effect-out",te.data_effect_out),$(Multidrag.multiElements[t]).attr("data-effect-in",te.data_effect_in),$(Multidrag.multiElements[t]).attr("data-vel-out",te.data_vel_out),$(Multidrag.multiElements[t]).attr("data-vel-in",te.data_vel_in),$(Multidrag.multiElements[t]).attr("data-delay-in",te.data_delay_in),$(Multidrag.multiElements[t]).attr("data-delay-out",te.data_delay_out),a&&e.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:$(Multidrag.multiElements[t]).attr("id"),TypeItem:$(Multidrag.multiElements[t]).attr("data-type"),Effect:$(Multidrag.multiElements[t]).attr("data-effect"),EffectIn:$(Multidrag.multiElements[t]).attr("data-effect-in"),EffectOut:$(Multidrag.multiElements[t]).attr("data-effect-out"),EffectHover:$(Multidrag.multiElements[t]).attr("data-effect-hover"),DurationIn:$(Multidrag.multiElements[t]).attr("data-vel-in"),DurationOut:$(Multidrag.multiElements[t]).attr("data-vel-out"),DelayIn:parseFloat($(Multidrag.multiElements[t]).attr("data-delay-in")),DelayOut:parseFloat($(Multidrag.multiElements[t]).attr("data-delay-out"))})}}else{var n=$("#"+currentData.IdItem);if(null===currentData.IdItem)return;var a=!1;n.attr("data-effect")===te.data_effect&&n.attr("data-effect-hover")===te.data_effect_hover&&n.attr("data-effect-out")===te.data_effect_out&&n.attr("data-effect-in")===te.data_effect_in&&n.attr("data-vel-out")===te.data_vel_out&&n.attr("data-vel-in")===te.data_vel_in&&n.attr("data-delay-in")===te.data_delay_in&&n.attr("data-delay-out")===te.data_delay_out||(a=!0),n.attr("data-effect",te.data_effect),n.attr("data-effect-hover",te.data_effect_hover),n.attr("data-effect-out",te.data_effect_out),n.attr("data-effect-in",te.data_effect_in),n.attr("data-vel-out",te.data_vel_out),n.attr("data-vel-in",te.data_vel_in),n.attr("data-delay-in",te.data_delay_in),n.attr("data-delay-out",te.data_delay_out),p(n),a&&e.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:n.attr("id"),TypeItem:n.attr("data-type"),Effect:n.attr("data-effect"),EffectIn:n.attr("data-effect-in"),EffectOut:n.attr("data-effect-out"),EffectHover:n.attr("data-effect-hover"),DurationIn:n.attr("data-vel-in"),DurationOut:n.attr("data-vel-out"),DelayIn:parseFloat(n.attr("data-delay-in")),DelayOut:parseFloat(n.attr("data-delay-out"))})}if(e.length>0){var i={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Elements:e};ApiGenially.executeCall(i,"/api/CopyAnimation/UpdateEffects","PUT")}K.addClass("effects-copied"),setTimeout(function(){K.removeClass("effects-copied")},500)}function r(){var e={opacity:.5,cursor:"not-allowed !important","pointer-events":"none"};P.css(e),E.css(e),U.css(e),M.css(e),O.css(e),G.css(e),B.css(e)}function o(){var e={opacity:1,cursor:"default","pointer-events":""};P.css(e),E.css(e),U.css(e),M.css(e),O.css(e),G.css(e),B.css(e)}function s(){V.show()}function d(){V.hide()}function c(){K.show()}function u(){K.hide()}function p(e){if($("html").hasClass("multidrag")||(o(),s(),c(),ne.click()),null===te&&u(),"area"===e.attr("data-type"))return void t();var n=e.attr("data-effect-in"),i=e.attr("data-vel-in"),l=e.attr("data-delay-in");if(T.find(".active").removeClass("active"),"none"===n||"undefined"===n||"undefined"==typeof F.find('input[data-class="'+n+'"]')[0])F.find('input[data-class="none"]')[0].checked=!0,G.find('button[data-speed="vel3"]').addClass("active"),j[0].noUiSlider.set(0);else{var r=F.find('input[data-class="'+n+'"]');r[0].checked=!0,G.find('button[data-speed="'+i+'"]').addClass("active"),j[0].noUiSlider.set(l)}var d=e.attr("data-effect-out"),p=e.attr("data-vel-out"),g=e.attr("data-delay-out");"none"===d||"undefined"===d||""===d||"undefined"==typeof L.find('input[data-class="'+d+'"]')[0]?(L.find('input[data-class="none"]')[0].checked=!0,B.find('button[data-speed="vel3"]').addClass("active"),N[0].noUiSlider.set(0)):(L.find('input[data-class="'+d+'"]')[0].checked=!0,B.find('button[data-speed="'+p+'"]').addClass("active"),N[0].noUiSlider.set(g));var f=e.attr("data-effect");"none"===f||"undefined"===f||""===f||"undefined"==typeof R.find('input[data-class="'+f+'"]')[0]?R.find('input[data-class="none"]')[0].checked=!0:R.find('input[data-class="'+f+'"]')[0].checked=!0;var m=e.attr("data-effect-hover");"none"===m||"undefined"===m||""===m||"undefined"==typeof z.find('input[data-class="'+m+'"]')[0]?z.find('input[data-class="none"]')[0].checked=!0:z.find('input[data-class="'+m+'"]')[0].checked=!0,a()}function g(){$("#selector").hide();var e=$("#"+currentData.IdItem);e[0].getBoundingClientRect().left<429&&q.addClass("previewing-animation"),e.addClass($(this).data("wrapper")),e.addClass("animated"),$("html").hasClass("touchevents")||e.addClass("infinite"),e.addClass("vel3")}function f(){q.removeClass("previewing-animation");var e=$("#"+currentData.IdItem);e.removeClass($(this).data("wrapper")),e.removeClass("animated"),e.removeClass("infinite"),e.removeClass("vel3"),$("#selector").show()}function m(){var t,a,n,i,l=currentData.IdItem,r="/api/"+currentData.TypeItem+"/",o=$(this).data("type"),s=$(this).data("class"),d={},c=$("#"+l);if("undefined"!=typeof c){switch(parseInt(o)){case 0:r+="UpdateEffect",d={Id:l,Effect:s,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},c.attr("data-effect",s),c.attr("data-effect",s);break;case 1:r+="UpdateEffectHover",d={Id:l,EffectHover:s,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},c.attr("data-effect-hover",s),c.attr("data-effect-hover",s);break;case 2:if(r+="UpdateEffectIn","none"===s)d={Id:l,EffectIn:s,DelayIn:0,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},G.find(".active").removeClass("active"),G.find('[data-speed="vel3"]').addClass("active"),j[0].noUiSlider.set(0),c.attr("data-effect-in",s),c.attr("data-effect-in",s),c.attr("data-delay-in",0),c.attr("data-delay-in",0);else{var u=c.attr("data-effect-out");"none"===u||""===u||null==u||"undefined"===u?(t=c.attr("data-delay-in"),0!==t&&""!==t&&null!==t&&"undefined"!==t||(t=0),d={Id:l,EffectIn:s,DelayIn:t,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},j[0].noUiSlider.set(t),c.attr("data-effect-in",s),c.attr("data-effect-in",s),c.attr("data-delay-in",t),c.attr("data-delay-in",t)):(t=c.attr("data-delay-in"),0!==t&&""!==t&&null!==t&&"undefined"!==t||(t=0),a=c.attr("data-delay-out"),n=e(c.attr("data-vel-in")),i=parseFloat(t)+parseFloat(n),i>=parseFloat(a)&&(a=i+.4,N[0].noUiSlider.set(a)),d={Id:l,EffectIn:s,DelayIn:t,DelayOut:a,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},N[0].noUiSlider.set(a),j[0].noUiSlider.set(t),c.attr("data-effect-in",s),c.attr("data-effect-in",s),c.attr("data-delay-in",t),c.attr("data-delay-in",t),c.attr("data-delay-out",a),c.attr("data-delay-out",a))}break;case 3:r+="UpdateEffectOut";var p=c.attr("data-effect-in");"none"===s?(d={Id:l,EffectOut:s,DelayOut:0,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},B.find(".active").removeClass("active"),B.find('[data-speed="vel3"]').addClass("active"),N[0].noUiSlider.set(0),c.attr("data-effect-out",s),c.attr("data-effect-out",s),c.attr("data-delay-out",0),c.attr("data-delay-out",0)):"none"===p||""===p||null===p||"undefined"===p?(a=c.attr("data-delay-out"),0!==a&&""!==a&&null!==a&&"undefined"!==a||(a=0),d={Id:l,EffectOut:s,DelayOut:a,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},N[0].noUiSlider.set(a),c.attr("data-effect-out",s),c.attr("data-effect-out",s),c.attr("data-delay-out",a),c.attr("data-delay-out",a)):(t=c.attr("data-delay-in"),a=c.attr("data-delay-out"),0!==a&&""!==a&&null!==a&&"undefined"!==a||(a=0),n=e(c.attr("data-vel-in")),i=parseFloat(t)+parseFloat(n),i>=a&&(a=i+.4),d={Id:l,EffectOut:s,DelayOut:a,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},N[0].noUiSlider.set(a),c.attr("data-effect-out",s),c.attr("data-effect-out",s),c.attr("data-delay-out",a),c.attr("data-delay-out",a))}ApiGenially.executeCall(d,r,"PUT")}}function h(){var t,a,n=currentData.IdItem,i="/api/"+currentData.TypeItem,l=0,r=j[0].noUiSlider.get().replace("s",""),o={},s=$("#"+n);if("undefined"!=typeof s){var d=s.attr("data-effect-in");if("none"===d||null===d||""===d||"undefined"===d)return void j[0].noUiSlider.set(0);var c=s.attr("data-effect-out");"none"===c||null===c||""===c||"undefined"===c?o={DelayIn:r,DelayOut:0,Id:n,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially}:(l=s.attr("data-delay-out"),t=e(s.attr("data-vel-in")),a=parseFloat(r)+parseFloat(t),a>=parseFloat(l)&&(l=a+.4,N[0].noUiSlider.set(l)),o={DelayIn:r,DelayOut:l,Id:n,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially}),i+="/UpdateEffectDelayIn",s.attr("data-delay-in",r),s.attr("data-delay-in",r),s.attr("data-delay-out",l),s.attr("data-delay-out",l),ApiGenially.executeCall(o,i,"PUT")}}function v(){var t,a,n=currentData.IdItem,i="/api/"+currentData.TypeItem+"/UpdateEffectDelayOut",l=N[0].noUiSlider.get().replace("s",""),r={},o=$("#"+n);if("undefined"!=typeof o){var s=o.attr("data-effect-out");if("none"===s||null===s||""===s||"undefined"===s)return void N[0].noUiSlider.set(0);var d=o.attr("data-effect-in");if("none"===d||null===d||""===d||"undefined"===d)r={DelayOut:l,Id:n,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially};else{var c=o.attr("data-delay-in");t=e(o.attr("data-vel-in")),a=parseFloat(c)+parseFloat(t),a>=l&&(l=a+.4,N[0].noUiSlider.set(l)),r={DelayOut:l,Id:n,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially}}o.attr("data-delay-out",l),o.attr("data-delay-out",l),ApiGenially.executeCall(r,i,"PUT")}}function y(){var t,a,n=currentData.IdItem,i="/api/"+currentData.TypeItem,l=$(this).attr("data-speed");i+="/UpdateEffectSpeedIn";var r=$("#"+n);if("undefined"!=typeof r){var o=r.attr("data-effect-in"),s={};if(""===o||"none"===o||null===o||"undefined"===o)return j[0].noUiSlider.set(0),G.find(".active").removeClass("active"),void G.find('[data-speed="vel3"]').addClass("active");var d=r.attr("data-delay-in"),c=r.attr("data-delay-out");t=e(l),a=parseFloat(d)+parseFloat(t),a>=c&&(c=a+.4,N[0].noUiSlider.set(c),r.attr("data-delay-out",c),r.attr("data-delay-out",c)),s={Id:n,DurationIn:l,DelayOut:c,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially},r.attr("data-vel-in",l),r.attr("data-vel-in",l),ApiGenially.executeCall(s,i,"PUT")}}function I(){var e=currentData.IdItem,t=$(this).attr("data-speed"),a="/api/"+currentData.TypeItem;a+="/UpdateEffectSpeedOut";var n=$("#"+e);if("undefined"!=typeof n){var i=n.attr("data-effect-out");if("none"===i||null===i||""===i||"undefined"===i)return N[0].noUiSlider.set(0),B.find(".active").removeClass("active"),void B.find('[data-speed="vel3"]').addClass("active");var l={Id:e,DurationOut:t,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially};n.attr("data-vel-out",t),n.attr("data-vel-out",t),ApiGenially.executeCall(l,a,"PUT")}}function b(){$(".effect-preview").hoverIntent(g,f),$(".effect-preview").click(m),j[0].noUiSlider.on("change",h),N[0].noUiSlider.on("change",v),G.find("button").click(y),B.find("button").click(I),$(".select-in-out").click()}function C(){a()}function x(){function e(){$(this).addClass("active"),ie.removeClass("active"),oe.removeClass("visible"),re.addClass("visible")}function t(){$(this).addClass("active"),ne.removeClass("active"),re.removeClass("visible"),oe.addClass("visible")}ne.click(e),ie.click(t)}function S(){function e(){$(this).addClass("active"),ce.removeClass("active"),ue.removeClass("active"),fe.removeClass("visible"),me.removeClass("visible"),ge.addClass("visible")}function t(){$(this).addClass("active"),de.removeClass("active"),ue.removeClass("active"),ge.removeClass("visible"),me.removeClass("visible"),fe.addClass("visible")}function a(){$(this).addClass("active"),de.removeClass("active"),ce.removeClass("active"),ge.removeClass("visible"),fe.removeClass("visible"),me.addClass("visible")}de.click(e),ce.click(t),ue.click(a)}function w(){function e(e){if("In"===e){var a=$("#"+currentData.IdItem);if(a.length<0)return;var n,i=a.attr("data-effect-in");"none"===i||"undefined"===i||"undefined"==typeof F.find('input[data-class="'+i+'"]')[0]?(E.find(".select-direction").removeClass("active"),ee.direction="stay",J.addClass("active"),t(ee)):(n=F.find('input[data-class="'+i+'"]').attr("data-direction"),E.find(".select-direction").removeClass("active"),$("#data-direction-"+n).addClass("active"),ee.direction=n,t(ee))}else if("Out"===e){var l,r=$("#"+currentData.IdItem);if(r.length<0)return;var o=r.attr("data-effect-out");"none"===o||"undefined"===o||""===o||"undefined"==typeof L.find('input[data-class="'+o+'"]')[0]?(E.find(".select-direction").removeClass("active"),ee.direction="stay",J.addClass("active"),t(ee)):(l=L.find('input[data-class="'+o+'"]').attr("data-direction"),E.find(".select-direction").removeClass("active"),$("#data-direction-"+l).addClass("active"),ee.direction=l,t(ee))}}function t(e){return A.hide(),"Hover"===e.behaviour||"Continuous"===e.behaviour?(a(),void("Hover"===e.behaviour?s():d())):(n(),null===e.direction&&(e.direction="stay"),"In"===e.behaviour?r():o(),"left"===e.direction&&p(),"right"===e.direction&&g(),"up"===e.direction&&f(),"down"===e.direction&&m(),"stay"===e.direction&&h(),"In"===e.behaviour?F.first('li[data-class="none"]').show():L.first('li[data-class="none"]').show(),void("content"===currentData.TypeItem?(T.find('button[data-behaviour="Continuous"]').hide(),T.find('button[data-behaviour="Hover"]').hide()):(T.find('button[data-behaviour="Continuous"]').show(),T.find('button[data-behaviour="Hover"]').show())))}function a(){E.hide(),G.hide(),B.hide(),M.hide(),O.hide()}function n(){E.hide(),G.hide(),B.hide(),E.show(),M.hide(),O.hide()}function r(){G.show(),M.show(),F.show()}function o(){B.show(),O.show(),L.show()}function s(){z.show()}function d(){R.show()}function c(){$(this).hasClass("active")||($("#animationsObject").find(".select-behaviour").removeClass("active"),$(this).addClass("active"),ee.behaviour=$(this).attr("data-behaviour"),t(ee),e(ee.behaviour))}function u(){ee.effect!==$(this).attr("data-effect")&&(ee.effect=$(this).attr("data-effect"),t(ee))}function p(){U.find("li").not('[data-search*="left"]').hide()}function g(){U.find("li").not('[data-search*="right"]').hide()}function f(){U.find("li").not('[data-search*="up"]').hide()}function m(){U.find("li").not('[data-search*="down"]').hide()}function h(){U.find('li[data-search*="left"]').hide(),U.find('li[data-search*="right"]').hide(),U.find('li[data-search*="up"]').hide(),U.find('li[data-search*="down"]').hide()}function v(){$(this).hasClass("active")||($("#animationsObject").find(".select-direction").removeClass("active"),$(this).addClass("active"),ee.direction=$(this).attr("data-direction"),t(ee))}function y(){var e=j[0].noUiSlider.get().replace("s","");ee.duration!==e&&(ee.duration=e)}function I(){var e=N[0].noUiSlider.get().replace("s","");ee.duration!==e&&(ee.duration=e)}function b(){$(this).hasClass("active")||($("#objectEffecSpeedIn").find(".select-speed").removeClass("active"),$(this).addClass("active"),ee.speed=$(this).attr("data-speed"))}function C(){$(this).hasClass("active")||($("#objectEffecSpeedOut").find(".select-speed").removeClass("active"),$(this).addClass("active"),ee.speed=$(this).attr("data-speed"))}H.click(c),W.click(u),_.click(v),Z.click(b),X.click(C),j[0].noUiSlider.on("change",y),N[0].noUiSlider.on("change",I),V.click(i),K.click(l),x(),S()}function k(){w(),b()}var D=$("#noAnimationSelected"),T=$("#animationSelected"),P=$("#objectBehaviour"),E=$("#objectEffectDirection"),G=($("#animationTypes"),$("#objectEffecSpeedIn")),B=$("#objectEffecSpeedOut"),M=$("#objectEffectDurationIn"),O=$("#objectEffectDurationOut"),U=$("#objectEffectTypes"),A=U.find("li"),R=U.find("li.effect-type-0"),z=U.find("li.effect-type-1"),F=U.find("li.effect-type-2"),L=U.find("li.effect-type-3"),H=$("#animationsObject").find(".select-behaviour"),W=$("#animationsObject").find(".select-effect"),j=$("#animationsObject").find("#selectDurationEffectIn"),N=$("#animationsObject").find("#selectDurationEffectOut"),_=$("#animationsObject").find(".select-direction"),Z=$("#objectEffecSpeedIn").find(".select-speed"),X=$("#objectEffecSpeedOut").find(".select-speed"),Y=$("#copyPasteEffect"),V=Y.find("#copyAnimation"),K=Y.find("#pasteAnimation"),J=$("#data-direction-stay"),q=$("#secondaryActions"),Q=$("#buttonIn"),ee={behaviour:null,effect:null,direction:null,speed:null,duration:null},te=null,ae=$(document.getElementById("tabbed-tabs")),ne=ae.children('[data-tab="element"]'),ie=ae.children('[data-tab="slide"]'),le=$(document.getElementById("tabbed-contents")),re=le.children('[data-tab="element"]'),oe=le.children('[data-tab="slide"]'),se=$(document.getElementById("tabbed-transitions")),de=se.children('[data-tab="horizontal"]'),ce=se.children('[data-tab="vertical"]'),ue=se.children('[data-tab="no-transition"]'),pe=$(document.getElementById("transition-contents")),ge=pe.children('[data-tab="horizontal"]'),fe=pe.children('[data-tab="vertical"]'),me=pe.children('[data-tab="no-transition"]');return{start:k,loadDataItem:p,hideAnimations:t,disableEffects:r,enableEffects:o,enableCopyButton:s,disableCopyButton:d,enablePasteButton:c,disablePasteButton:u,getCopyEffects:n,enableMultiDrag:C}}(),Settings=function(){function e(){function e(){event.preventDefault(),$("#levelGeniallyUp").css("visibility","hidden"),$(".pro-level-up").hide(),$(".master-level-up").css("width","100%"),$("#premiumFeatureOnly").modal()}O.click(e)}function t(){function e(){if(dataGenially.IdUser!==$("#idUser").val()){event.preventDefault(),$("#levelGeniallyUp").css("visibility","visible"),$(".master-level-up").css("width","100%");var e=$("#premiumFeatureOnly").find("#levelGeniallyUp");e.attr("href","/Buy/Professional/"+currentData.IdGenially),$(".pro-level-up").hide(),$("#premiumFeatureOnly").modal()}else{event.preventDefault(),$("#levelGeniallyUp").css("visibility","visible");var e=$("#premiumFeatureOnly").find("#levelGeniallyUp");e.attr("href","/Buy/Professional/"+currentData.IdGenially),$(".pro-level-up").show(),$("#premiumFeatureOnly").modal()}}U.click(e)}function a(){function e(e){e.stopPropagation(),e.preventDefault();var t=[];if("drop"===e.type?t=e.dataTransfer.files:"change"===e.type&&(t=e.target.files),!(t.length>1))for(var a,n=0;a=t[n];n++)if(a.type.match("image.*")&&!a.type.match("image.bmp")){var i=a.size;if(i>5242880)swal({title:locale.image.titleImageTooBig,text:locale.image.textImageTooBig,type:"info",confirmButtonColor:"#bc2360",confirmButtonText:locale.image.confirmButtonText,closeOnConfirm:!0});else{var l=new FileReader;l.onload=function(e){return function(e){S.attr("src",e.target.result),B=e.target.result}}(a),l.readAsDataURL(a),C.fadeIn()}}}function t(){function e(){setTimeout(function(){C.removeClass("updating"),C.html(locale.settings.logoUpdated),setTimeout(function(){T.show(),E.prop("disabled",!1),E.show(),C.html(a),C.prop("disabled",!1),C.hide()},2e3)},1e3)}function t(){T.show(),C.removeClass("updating").html(a),C.prop("disabled",!1),C.hide()}T.hide();var a=C.text(),n='<div class="preloader pls-white"><svg class="pl-circular" viewBox="25 25 50 50"><circle class="plc-path" cx="50" cy="50" r="20"></circle></svg></div>';C.addClass("updating").html(n),C.prop("disabled",!0);var i="/api/Settings/ReplaceLogotype",l={IdGenially:currentData.IdGenially,CustomLogotype:B};ApiGenially.executeCall(l,i,"PUT",e,t)}I.get(0).addEventListener("change",e,!1),C.click(t),function(){function e(e){var t="";null===e?t="https://genially.blob.core.windows.net/genially/version3.0/loader.gif":(t=e,E.prop("disabled",!1),E.show()),$(S).attr("src",t)}var t={idGenially:currentData.IdGenially},a="/api/Settings/GetCustomLogotype";ApiGenially.executeCall(t,a,"GET",e)}()}function n(){function e(e){e.stopPropagation(),e.preventDefault();var t=[];if("drop"===e.type?t=e.dataTransfer.files:"change"===e.type&&(t=e.target.files),!(t.length>1))for(var a,n=0;a=t[n];n++)if(a.type.match("image.*")&&!a.type.match("image.bmp")){var i=a.size;if(i>5242880)swal({title:locale.image.titleImageTooBig,text:locale.image.textImageTooBig,type:"info",confirmButtonColor:"#bc2360",confirmButtonText:locale.image.confirmButtonText,closeOnConfirm:!0});else{var l=new FileReader;l.onload=function(e){return function(e){w.attr("src",e.target.result),M=e.target.result}}(a),l.readAsDataURL(a),x.fadeIn()}}}function t(){function e(){setTimeout(function(){x.removeClass("updating"),x.html(locale.settings.watermarkUpdated),setTimeout(function(){P.show(),G.prop("disabled",!1),G.show(),x.html(a),x.prop("disabled",!1),x.hide(),D.fadeIn(),b.val("")},2e3)},1e3)}function t(){P.show(),x.removeClass("updating").html(a),x.prop("disabled",!1),x.hide(),b.val("")}P.hide(),G.hide();var a=x.text(),n='<div class="preloader pls-white"><svg class="pl-circular" viewBox="25 25 50 50"><circle class="plc-path" cx="50" cy="50" r="20"></circle></svg></div>';x.addClass("updating").html(n),x.prop("disabled",!0);var i="/api/Settings/ReplaceWatermark",l=k.val();if(""!==l){var r=new RegExp("(http://|https://)");r.test(l)||(l="http://"+l)}var o={IdGenially:currentData.IdGenially,CustomWatermark:M,WatermarkLink:l};ApiGenially.executeCall(o,i,"PUT",e,t)}function a(){var e="/api/Settings/ReplaceWatermarkLink",t=$(this).val();if(""!==t){var a=new RegExp("(http://|https://)");a.test(t)||(t="http://"+t);var n={idGenially:currentData.IdGenially,WatermarkLink:t};ApiGenially.executeCall(n,e,"PUT")}}b.get(0).addEventListener("change",e,!1),x.click(t);var n=_.debounce(a,2e3);k.on("keyup",n),k.on("focus",function(e){""===$(this).val()&&$(this).val("http://")}),function(){function e(e){var t="",a="";null!==e&&"undefined"!=typeof e&&"undefined"!=typeof e.WatermarkLink&&null!==e.WatermarkLink&&""!==e.WatermarkLink&&(a=e.WatermarkLink,D.show()),null===e||"undefined"==typeof e||"undefined"==typeof e.CustomWatermark||null===e.CustomWatermark||""===e.CustomWatermark?(t="https://genially.blob.core.windows.net/genially/version3.0/watermark.png",D.hide()):(t=e.CustomWatermark,G.prop("disabled",!1),G.show()),$(w).attr("src",t),$(k).val(a)}var t={idGenially:currentData.IdGenially},a="/api/Settings/GetCustomWatermark";ApiGenially.executeCall(t,a,"GET",e)}()}function i(){function e(){$(S).attr("src","https://genially.blob.core.windows.net/genially/version3.0/loader.gif"),E.prop("disabled",!1),E.hide()}var t="/api/Settings/RemoveCustomLogotype";ApiGenially.executeCall(currentData.IdGenially,t,"DELETE",e)}function l(){function e(){$(w).attr("src","https://genially.blob.core.windows.net/genially/version3.0/watermark.png"),$(k).val(""),G.prop("disabled",!1),G.hide(),D.hide()}var t="/api/Settings/RemoveCustomWatermark";ApiGenially.executeCall(currentData.IdGenially,t,"DELETE",e)}function r(){function r(){var e=$(this)[0].checked;Setting.updatePagination(e)}function o(){if(1!==dataGenially.TypeSubscription){var e=$(this)[0].checked;Setting.updateDrag(e)}}function s(){if(1!==dataGenially.TypeSubscription){var e=$(this)[0].checked;Setting.updatePaint(e)}}function d(){if(3===dataGenially.TypeSubscription||6===dataGenially.TypeSubscription){var e=$(this)[0].checked;Setting.updateLoadMobile(e)}}function c(){var e=!$(this)[0].checked;Setting.updateTitles(e)}function u(){var e=!$(this)[0].checked;Setting.updateShare(e)}function p(){var e=$(this)[0].checked;Setting.updateFullScreen(e)}function g(){var e=$("#settingVideoMode"),t=$("#settingBucleVideoMode"),a=t[0].checked,n=$("#durationVideoMode")[0].noUiSlider.get().replace("s",""),i=e[0].checked;e[0].checked?($("#durationVideoMode").show(),$("#bucleVideoMode").show()):($("#durationVideoMode").hide(),$("#bucleVideoMode").hide(),t[0].checked=!1,a=!1),Setting.updateVideoMode(i,n,a)}function f(){var e=$("#settingBucleVideoMode"),t=$("#settingVideoMode"),a=e[0].checked,n=$("#durationVideoMode")[0].noUiSlider.get().replace("s",""),i=t[0].checked;t[0].checked?($("#durationVideoMode").show(),$("#bucleVideoMode").show()):($("#durationVideoMode").hide(),$("#bucleVideoMode").hide(),e[0].checked=!1,a=!1),Setting.updateVideoMode(i,n,a)}function h(){var e=$(this)[0].checked;$(this)[0].checked?$("#settingPassword").hide():$("#settingPassword").show(),Setting.updatePrivacy(e)}function I(){var e=$(this).data("tooltip-class");Setting.updateTooltipStyle(e)}function b(){var e=$("#settingPassword").val();Setting.updatePassword(e)}function C(){var e=$(this).val();Setting.updateDescription(e)}function x(){var e=$(this).val();Setting.updateSeoKeyWords(e)}function S(){var e=$(this)[0].checked;Setting.updateHideLogo(e)}function w(e){e.preventDefault();var t=$("#editorBody").find("#settingsHolder");if($(this).hasClass("active"))$(this).removeClass("active"),t.removeClass("showSettings"),t.addClass("hideSettings"),SecondaryActions.forceHide();else{var a=$("#editorBody").find("#moreOptions");$(this).addClass("active"),a.removeClass("showOptions"),m.removeClass("active"),t.removeClass("hideSettings"),t.addClass("showSettings"),SecondaryActions.forceHide(),Canva.hideSlideSideBar()}}function k(){var e=$("#"+currentData.IdSlide);Setting.updateSize(e.width(),e.height())}function D(){"0"===$("#widthSlide").val()&&$("#widthSlide").val("1"),"0"===$("#heightSlide").val()&&$("#heightSlide").val("1")}function T(){D(),v=parseInt($("#widthSlide").val(),10),y=parseInt($("#heightSlide").val(),10)}function P(){D();var e=$("#slideAspectRatio").is(":checked");if(e){var t=$("#"+currentData.IdSlide).width()/$("#"+currentData.IdSlide).height(),a=parseInt($("#widthSlide").val(),10),n=parseInt($("#heightSlide").val(),10);if(v!==a||n!==y){var i=$(this).attr("id");"widthSlide"===i?$("#heightSlide").val(parseInt(a/t),10):$("#widthSlide").val(parseInt(n/t),10)}}}a(),n(),e(),t(),$("#settingPagination").change(r),$("#settingPaint").change(s),$("#settingDrag").change(o),$("#settingTitles").change(c),$("#settingShare").change(u),$("#settingFullScreen").change(p),$("#settingVideoMode").change(g),$("#settingBucleVideoMode").change(f),$("#settingPrivate").change(h),$("#settingHideLogo").change(S),$('input[name="tooltipStyle"]').change(I),$("#settingPassword").blur(b),$("#durationVideoMode")[0].noUiSlider.on("change",g),$("#descriptionGenially").blur(C),$("#seoTags").blur(x),$("#showSettings").click(w),$("#saveSize").click(k),$("#settingLoadMobile").click(d),$("#heightSlide").on("blur",P),$("#widthSlide").on("blur",P),$("#heightSlide").on("focus",T),$("#widthSlide").on("focus",T),$("#heightSlide").on("keyup",function(e){13===e.keyCode&&P()}),$("#widthSlide").on("keyup",function(e){13===e.keyCode&&P()}),G.click(l),E.click(i)}function o(){var e=$("#"+currentData.IdSlide);g.val(e.width()),h.val(e.height())}function s(){var e=$("#editorBody").find("#settingsHolder");$("#showSettings").removeClass("active"),e.removeClass("showSettings"),e.addClass("hideSettings")}function d(){f.hasClass("showOptions")?(f.removeClass("showOptions"),m.removeClass("active")):(f.addClass("showOptions"),m.addClass("active"))}function c(){f.hasClass("showOptions")&&(f.removeClass("showOptions"),m.removeClass("active"))}function u(){f.hasClass("showOptions")||(f.addClass("showOptions"),m.addClass("active"))}function p(){r()}var g=$("#widthSlide"),f=$("#editorBody").find("#moreOptions"),m=$("#showMoreOptions"),h=$("#heightSlide"),v=0,y=0,I=$("#customLogotypeImageFile"),b=$("#customWatermarkImageFile"),C=$("#setCustomLogo"),x=$("#setCustomWatermark"),S=$("#newLogotypePreviewer"),w=$("#newWatermarkPreviewer"),k=$("#customWatermarkUrl"),D=$("#customWatermarkUrlContainer"),T=$("#newLogoReplacement"),P=$("#newWatermarkReplacement"),E=$("#removeLogotype"),G=$("#removeWatermark"),B="",M="",O=$(".premium-only-overlay"),U=$(".premium-pro-only-overlay");return{start:p,loadCurrentSize:o,toggleMoreOptions:d,hideMoreOptions:c,showMoreOptions:u,hideSetting:s}}(),workingThumb=!1,Miniature=function(){function e(){function e(){workingThumb=!1;
}function t(){}if(workingThumb===!1){workingThumb=!0;var a=parseInt($("#"+currentData.IdSlide).width()),n=parseInt($("#"+currentData.IdSlide).height()),i=parseInt(436*n/a),l=$("#idUser").val();isNaN(i)&&(i=245);var r={idGenially:currentData.IdGenially,idSlide:$("#slidesContent li:first").attr("data-id"),width:"436px",height:i+"px",idUser:l};ApiGenially.executeCallDirect(r,"/api/Editor/CreateMiniature","GET",e,t)}}return{processFromUrl:e}}(),Background=function(){function e(e){$("#"+e).css({border:"2px solid #fff"}),$("#slide-clone-"+e).css({border:"2px solid #fff"}),setTimeout(function(){$("#"+e).css({border:0}),$("#slide-clone-"+e).css({border:0})},50)}function t(e){function t(t){$("#imageDropper").find(".loading").fadeOut(),$("#backgroundShapes").find(".loading").fadeOut();var a=document.getElementById("thumbPreview"),l=document.getElementById("dropperText");"background"===currentData.TypeItem&&i(),$("#SetSlideBackgroundImage").fadeOut(),$(a).css("background-color","#3F4652;"),$(a).css("background-image","none"),$(l).fadeIn(),$(t.target).find(".loading").fadeOut(),document.getElementById("dropFile").value="",ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements();var r={typeOperation:"BackgroundImage",typeContent:"background",backgroundImage:o,backgroundColor:f,width:s,height:u,left:p,top:g,idSlide:currentData.IdSlide,opacity:m},c=(n.css("background-color"),Object.assign({},r));c.width=M.SizeBackground.Width,c.height=M.SizeBackground.Height,c.left=M.PositionBackground.PositionLeft,c.top=M.PositionBackground.PositionTop,c.backgroundImage=e.Source,c.backgroundColor="#ffffff",c.opacity=1,UndoRedo.createElement(r,c),n.css("background-color","#ffffff"),setTimeout(function(){n.css("background-color","#ffffff")},10),d===!0&&(d=!1,SecondaryActions.forceHide()),Background.selectBackground()}function a(){SaveDisplay.showError()}var n=$("#"+currentData.IdSlide),r=n.find(".current-background-slide"),o=r.attr("src"),s=r.css("width"),u=r.css("height"),p=r.css("left"),g=r.css("top"),f=n.css("background-color"),m=r.css("opacity"),h=parseInt(e.SizeBackground.Width.split("p")[0]),v=parseInt(e.SizeBackground.Height.split("p")[0]),y=h/v,I=v/h,b=n.find(".slide-page-container").width(),C=n.find(".slide-page-container").height(),x=!1,S=!1;h>=b&&(x=!0),v>=C&&(S=!0);var w=0,k=0,D=h,T=v,P=b/h,E=C/v;if(x&&S||!x&&!S)P>E?(D=b,T=v*P,w=0,k=(T-C)/2*-1):(T=C,D=h*E,w=(D-b)/2*-1,k=0);else if(x&&!S){var G=C-v;T=C,D=h+G*y,w=(D-b)/2*-1,k=(T-C)/2*-1}else if(!x&&S){var B=b-h;D=b,T=v+B*I,w=(D-b)/2*-1,k=(T-C)/2*-1}n.find(".current-background-slide").attr({src:e.Source,"data-x":w,"data-y":k}).css({top:k,left:w,width:D,height:T,opacity:1}),$("#slide-clone-"+currentData.IdSlide).css({"background-color":l}),$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").attr("src",e.Source),$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").css({left:w,top:k,width:D,height:T,opacity:1});var M={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,SizeBackground:{Width:D+"px",Height:T+"px"},PositionBackground:{PositionLeft:w+"px",PositionTop:k+"px"}};ApiGenially.executeCall(M,c,"PUT",t,a)}function a(e){SaveDisplay.showError()}function n(e,t){var a={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};a.IdGenially=currentData.IdGenially,a.IdSlide=currentData.IdSlide,a.PositionBackground={PositionLeft:e,PositionTop:t},ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements(),ApiGenially.executeCall(a,u,"PUT"),i(event.target),p.show()}function i(e){var t=null;t="undefined"==typeof e||"string"!=typeof e?$("#"+currentData.IdSlide).find(".current-background-slide"):$("#slide-clone-"+e).find(".slide-page-clone-container"),p.css("left",t[0].getBoundingClientRect().left+"px"),p.css("top",t[0].getBoundingClientRect().top+"px"),p.css("width",t[0].getBoundingClientRect().width+"px"),p.css("height",t[0].getBoundingClientRect().height+"px"),p.show(),Canva.checkBackground()}var l,r,o=$("#backgroundTypes").find("#basicColors").find(".block-color"),s=($(".backgroundShape"),$("#backgroundTypes").find("#uploadPicture").find("button#SetSlideBackgroundImage")),d=!1,c="/api/Background/UpdateBackgroundImagePositionAndSize",u="/api/Background/UpdateBackgroundImage",p=$("#selectorBackground"),g=0,f=0,m=0,h=$("#position"),v=$("html"),y=$("#addNewColor"),I="https://genially.blob.core.windows.net/genially/backgroundStandard.png",b=$(document.getElementById("customBackground")),C=$(document.getElementById("customBackgroundShapes")),x="/api/Custom/GetBackgrounds",S='<div class="backgroundShape" style="background-image: url({{backgroundURL}})" data-background="{{backgroundURL}}"><div class="loading"></div></div>',w=function(t){if(!$(this).hasClass("new")){o.removeClass("selected"),$(t.target).addClass("selected");var a=t.target.attributes["data-color"].value,n=$("#"+currentData.IdSlide).css("background-color");if(n===a)return;var i=$("#"+currentData.IdSlide).find(".current-background-slide").attr("src"),l=$("#"+currentData.IdSlide).find(".current-background-slide"),r=l.css("width"),s=l.css("height"),d=l.css("top"),c=l.css("left"),p=l.css("opacity"),g={typeContent:"background",typeOperation:"BackgroundImage",backgroundColor:n,backgroundImage:i,idSlide:currentData.IdSlide,width:r,height:s,top:d,left:c,opacity:p},f=$("#"+currentData.IdSlide).find(".slide-page-container"),m=f.width(),h=f.height();$("#"+currentData.IdSlide).css({"background-color":a}),$("#"+currentData.IdSlide).find(".current-background-slide").attr("src",I),$("#"+currentData.IdSlide).find(".current-background-slide").css({opacity:1,width:m,height:h,left:0,top:0});var v={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};v.IdSlide=currentData.IdSlide,v.BackgroundColor=a,v.Source=I,v.SizeBackground.Width=m+"px",v.SizeBackground.Height=h+"px",v.OpacityBackground=1,v.PositionBackground.PositionLeft="0px",v.PositionBackground.PositionTop="0px",$("#slide-clone-"+currentData.IdSlide).css({"background-color":a}),$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").attr("src",I),$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").css({left:0,top:0,width:r,height:s,opacity:1}),ApiGenially.executeCall(v,u,"PUT"),ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements();var y=Object.assign({},g);y.backgroundColor=a,y.opacity=1,y.backgroundImage=I,y.width=m+"px",y.height=h+"px",y.left="0px",y.top="0px",UndoRedo.createElement(g,y),e(currentData.IdSlide),Background.selectBackground()}},k=function(t){o.removeClass("selected");var a=$("#"+currentData.IdSlide).css("background-color");if(a!==t){var n=$("#"+currentData.IdSlide).find(".current-background-slide").attr("src"),i=$("#"+currentData.IdSlide).find(".current-background-slide"),l=$("#"+currentData.IdSlide).find(".current-background-slide").css("opacity"),r=i.css("width"),s=i.css("height"),d=i.css("top"),c=i.css("left"),p={typeContent:"background",typeOperation:"BackgroundImage",backgroundColor:a,backgroundImage:n,idSlide:currentData.IdSlide,width:r,height:s,top:d,left:c,opacity:l},g=$("#"+currentData.IdSlide).find(".slide-page-container"),f=g.width(),m=g.height();$("#"+currentData.IdSlide).css({"background-color":t}),$("#"+currentData.IdSlide).find(".current-background-slide").attr("src",I),$("#"+currentData.IdSlide).find(".current-background-slide").css({opacity:1,width:f,height:m,left:0,top:0});var h={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};h.IdSlide=currentData.IdSlide,h.BackgroundColor=t,h.Source=I,h.OpacityBackground=1,h.SizeBackground.Width=f+"px",h.SizeBackground.Height=m+"px",h.PositionBackground.PositionLeft="0px",h.PositionBackground.PositionTop="0px",ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements(),ApiGenially.executeCall(h,u,"PUT"),$("#slide-clone-"+currentData.IdSlide).css({"background-color":t}),$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").attr("src",I),$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").css({opacity:1,width:f,height:m,left:0,right:0});var v=Object.assign({},p);v.backgroundColor=h.BackgroundColor,v.backgroundImage=I,v.opacity=1,v.width=f+"px",v.height=m+"px",v.left="0px",v.top="0px",UndoRedo.createElement(p,v),e(currentData.IdSlide),Background.selectBackground()}},D={image:null,tmpImage:null,set:function(e){$(e.target).find(".loading").fadeIn(),D.image=e.target.attributes["data-background"].value,D.tmpImage=new Image,D.tmpImage.src=D.image;var n=$(e.target).attr("id");$(D.tmpImage).on("load",function(){o.removeClass("selected");var e=this.width,i=this.height,l={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};if(l.IdGenially=currentData.IdGenially,l.IdSlide=currentData.IdSlide,l.Source=D.image,l.BackgroundColor="#ffffff",l.OpacityBackground=1,"undefined"!=typeof n){var r=$("#"+currentData.IdSlide).find(".slide-page-container");e=r.width(),i=r.height()}l.SizeBackground={Width:e+"px",Height:i+"px"},l.PositionBackground={PositionLeft:"0px",PositionTop:"0px"},l.SourceBase64=null,ApiGenially.executeCall(l,u,"PUT",t,a)})}},T={base64:null,tmpImage:null,set:function(){if("undefined"!=typeof FileReader){var e=document.getElementById("dropFile").files[0];if("undefined"!=typeof e){var n=0;if(n="undefined"!=typeof e?document.getElementById("dropFile").files[0].size:T.base64/137,e.type.match("image.bmp"))return $("#SetSlideBackgroundImage").fadeOut(),$("#thumbPreview").css("background-color","#3F4652;"),$("#thumbPreview").css("background-image","none"),$("#dropperText").fadeIn(),void(document.getElementById("dropFile").value="");if(n>5242880)return void swal({title:locale.image.titleImageTooBig,text:locale.image.textImageTooBig,type:"info",confirmButtonColor:"#bc2360",confirmButtonText:locale.image.confirmButtonText,closeOnConfirm:!0})}}$("#imageDropper").find(".loading").fadeIn(),T.tmpImage=new Image,T.tmpImage.src=T.base64,$(T.tmpImage).on("load",function(){var e=this.width,n=this.height,i={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};i.IdGenially=currentData.IdGenially,i.IdSlide=currentData.IdSlide,i.SizeBackground={Width:e+"px",Height:n+"px"},i.PositionBackground={PositionLeft:"0px",PositionTop:"0px"},i.Source=null,i.SourceBase64=T.base64,i.OpacityBackground=1,d=!0,ApiGenially.executeCall(i,u,"PUT",t,a)})}},P=function(e){var t=window.getSelection();if(t.removeAllRanges(),DesignLayers.layersContent.find(".layer").children(".title-identifier").attr("contenteditable",!1).blur(),!v.hasClass("editing-text")&&!v.hasClass("multidrag")){0!==$(".working").length&&$(".working").removeClass("working"),Canva.hideAllMenus(),v.addClass("tb-background"),currentData.TypeItem="background",currentData.IdItem=null,i(),Block.checkBlock();var a=$("#"+currentData.IdSlide).css("background-color");$("#tb-background").find(".sp-preview-inner").css("background-color",a),$("#tb-permanent").find("#permanentLock").prop("disabled",!1),$("#tb-permanent").find("#permanentDelete").prop("disabled",!1),$("#tb-permanent").find("#permanentCopy").prop("disabled",!0);var n=$("#"+currentData.IdSlide).find(".background-slide-class"),l=100*n[0].style.opacity;$("#backgroundOpacity")[0].noUiSlider.set(l),Canva.checkBackground()}},E=function(){function e(e){var t=document.getElementById("thumbPreview"),a=document.getElementById("dropperText");if(e.stopPropagation(),e.preventDefault(),"drop"==e.type)var n=e.dataTransfer.files;else if("change"==e.type)var n=e.target.files;if(n.length>1)return $("#SetSlideBackgroundImage").fadeOut(),$(t).css("background-color","#3F4652;"),$(t).css("background-image","none"),void $(a).fadeIn();$(a).fadeOut();for(var i,l=0;i=n[l];l++)if(i.type.match("image.*"))if(i.type.match("image.bmp"))$("#SetSlideBackgroundImage").fadeOut(),$(t).css("background-color","#3F4652;"),$(t).css("background-image","none"),$(a).fadeIn();else{var r=r=i.size;if(r>5242880)swal({title:locale.image.titleImageTooBig,text:locale.image.textImageTooBig,type:"info",confirmButtonColor:"#bc2360",confirmButtonText:locale.image.confirmButtonText,closeOnConfirm:!0}),$("#SetSlideBackgroundImage").fadeOut(),$(t).css("background-color","#3F4652;"),$(t).css("background-image","none"),$(a).fadeIn();else{var o=new FileReader;o.onload=function(e){return function(e){$(t).css("background-image","url("+e.target.result+")"),T.base64=e.target.result}}(i),o.readAsDataURL(i),$("#SetSlideBackgroundImage").fadeIn()}}else $("#SetSlideBackgroundImage").fadeOut(),$(t).css("background-color","#3F4652;"),$(t).css("background-image","none"),$(a).fadeIn()}function t(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}y.spectrum("destroy"),y.spectrum({containerClassName:"spectrumGenially",preferredFormat:"hex",showInput:!0,showPalette:!0,showAlpha:!0,showSelectionPalette:!0,hideAfterPaletteSelect:!0,showInitial:!1,chooseText:locale.spectrum.choose,cancelText:locale.spectrum.cancel,localStorageKey:"spectrum.genially"+$("#idGenially").val(),palette:CustomColors.getCustomColors(),change:function(e){k(e.toRgbString()),y.spectrum("set",e.toRgbString())},hide:function(){y.spectrum("set","")},show:function(e){y.spectrum("set",$("#"+currentData.IdSlide).css("background-color"))}}),o.on("click",w),$(document).on("click",".backgroundShape",D.set),s.on("click",T.set);var a=document.getElementById("imageDropper");a.addEventListener("dragover",t,!1),a.addEventListener("drop",e,!1),document.getElementById("dropFile").addEventListener("change",e,!1)},G=function(){function e(e){var t=e.target,a=(parseFloat(t.getAttribute("data-x"))||0)+e.dx/watching.scale,n=(parseFloat(t.getAttribute("data-y"))||0)+e.dy/watching.scale;t.style.left=a+"px",t.style.top=n+"px",t.setAttribute("data-x",a),t.setAttribute("data-y",n)}function t(e){ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements(),(v.hasClass("multidrag")||v.hasClass("multidragging"))&&(v.removeClass("multidrag multidragging"),$(".multidrag-element").removeClass("multidrag-element"),$(".multidrag-selector").remove(),currentData.IdItem=null,Toolbar.hideAll(),Multidrag.clearElements()),Canva.hideAllMenus(),p.hide(),currentData.TypeItem="background",r=$("#"+currentData.IdSlide).find(".current-background-slide"),c={idItem:null,typeContent:"background",typeOperation:"UpdatePosition",width:r.css("width"),height:r.css("height"),top:r.css("top"),left:r.css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:r.attr("data-x"),dataY:r.attr("data-y")},l=$("#"+currentData.IdSlide).css("background-color"),$("#tb-permanent").find("#permanentLock").prop("disabled",!1),v.addClass("dragging-background")}function a(e){r=$("#"+currentData.IdSlide).find(".current-background-slide"),$("#"+currentData.IdSlide).css({"background-color":l});var t={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};t.IdSlide=currentData.IdSlide,t.PositionBackground={PositionLeft:e.target.getAttribute("data-x")+"px",PositionTop:e.target.getAttribute("data-y")+"px"},ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements(),$("#slide-clone-"+currentData.IdSlide).css({"background-color":l}),$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").css({left:t.PositionBackground.PositionLeft,top:t.PositionBackground.PositionTop}),y={idItem:null,typeContent:"background",typeOperation:"UpdatePosition",width:r.css("width"),height:r.css("height"),top:r.css("top"),left:r.css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:r.attr("data-x"),dataY:r.attr("data-y")},UndoRedo.createElement(c,y),ApiGenially.executeCall(t,u,"PUT"),i(e.target),p.show(),setTimeout(function(){v.removeClass("dragging-background")},100)}function n(e){currentData.TypeItem="background",v.addClass("resizing"),r=$("#"+currentData.IdSlide).find(".current-background-slide"),m=r.outerWidth()-r.width(),g=$(e.target).height(),f=$(e.target).width(),p.find(".lines-resize").show(),h.show(),c={idItem:null,typeContent:"background",typeOperation:"UpdateSize",width:r.css("width"),height:r.css("height"),top:r.css("top"),left:r.css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:r.attr("data-x"),dataY:r.attr("data-y")},$("#tb-permanent").find("#permanentLock").prop("disabled",!1),ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements(),!e.edges.right&&!e.edges.left||e.edges.top||e.edges.bottom?!e.edges.top&&!e.edges.bottom||e.edges.left||e.edges.right||(interact("#selectorBackground").options.resize.preserveAspectRatio=!1,interact("#selectorBackground").options.resize.square=!1):(interact("#selectorBackground").options.resize.preserveAspectRatio=!1,interact("#selectorBackground").options.resize.square=!1)}function o(e){var t=e.target,a=0,n=0,i=0,l=0;t.style.width=e.rect.width+"px",t.style.height=e.rect.height+"px",a+=e.deltaRect.left,n+=e.deltaRect.top;var o=$(t).offset();$(t).offset({left:o.left+e.deltaRect.left,top:o.top+e.deltaRect.top}),t.setAttribute("data-x",a),t.setAttribute("data-y",n),i=e.rect.width/watching.scale,l=e.rect.height/watching.scale,h.css({left:p.css("left"),top:p.css("top")}),h.find("#one").text(parseInt(i)),h.find("#two").text(parseInt(l)),r.width(i),r.height(l),a=r.position().left/watching.scale+e.deltaRect.left/watching.scale,n=r.position().top/watching.scale+e.deltaRect.top/watching.scale,r.css("left",a),r.css("top",n),r.attr("data-x",a),r.attr("data-y",n)}function s(e){r=$("#"+currentData.IdSlide).find(".current-background-slide");var t=$("#"+currentData.IdSlide).find(".current-background-slide"),a={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};a.IdSlide=currentData.IdSlide,a.PositionBackground={PositionLeft:t.css("left"),PositionTop:t.css("top")},a.SizeBackground={Width:t.css("width"),Height:t.css("height")},ToolbarBackground.setAllSameBackground(!1),ToolbarBackground.changeDynamicElements(),y={idItem:null,typeContent:"background",typeOperation:"UpdatePosition",width:r.css("width"),height:r.css("height"),top:r.css("top"),left:r.css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:r.attr("data-x"),dataY:r.attr("data-y")},UndoRedo.createElement(c,y),ApiGenially.executeCall(a,u,"PUT"),i(),h.hide(),p.find(".lines-resize").hide(),$("#slide-clone-"+currentData.IdSlide).css({"background-color":l}),$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").css({left:a.PositionBackground.PositionLeft,top:a.PositionBackground.PositionTop,width:a.SizeBackground.Width,height:a.SizeBackground.Height}),interact("#selectorBackground").options.resize.preserveAspectRatio=!0,interact("#selectorBackground").options.resize.square=!0,setTimeout(function(){v.removeClass("resizing")},100)}function d(){Text.finishEditingText(),P(),SecondaryActions.processHideAll()}window.dragMoveListener=e;var c,y;interact("#selectorBackground").resizable({max:1,preserveAspectRatio:!0,square:!1,edges:{left:!0,right:!0,bottom:!0,top:!0},onstart:n,onmove:o,onend:s}),interact(".resize-drag").draggable({onmove:window.dragMoveListener,onstart:t,onend:a,restrict:{restriction:"parent"}}),interact(".current-background-slide").on("tap",d)},B=function(){p.hide()},M=function(){function e(e){return 0===e.length?(b.hide(),!1):(e.forEach(function(e,t){var a=S.replace(/{{backgroundURL}}/g,e.UrlBackground);C.append(a)}),!0)}return 3!==typeSubscriptionUser&&6!==typeSubscriptionUser?(b.hide(),!1):void ApiGenially.executeCall("",x,"GET",e)},O=function(){E(),G()};return{init:O,pattern:D,upload:T,hideSelector:B,resizeCorners:i,savePosition:n,selectBackground:P,fetchCustomBackgrounds:M,refreshRender:e}}(),Block=function(){function e(e,t){if(t)a(e.idItem,e.typeItem,!0);else{if("background"===currentData.TypeItem){r.addClass("blocked");var n=$("#"+currentData.IdSlide).find(".current-background-slide");return n.addClass("blocked"),void n.removeClass("resize-drag")}a(currentData.IdItem,currentData.TypeItem,!0)}}function t(e,t){if(t)a(e.idItem,e.typeItem,!1);else{if("background"===currentData.TypeItem){r.removeClass("blocked");var n=$("#"+currentData.IdSlide).find(".current-background-slide");return n.removeClass("blocked"),void n.addClass("resize-drag")}a(currentData.IdItem,currentData.TypeItem,!1)}}function a(e,t,a){var n=$("#"+e),r="/api/"+t+"/UpdateBlocked",o={Id:e,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Blocked:a};ApiGenially.executeCall(o,r,"PUT"),a?i(n):l(n)}function n(){if("background"===currentData.TypeItem)return Multidrag.clearElements(),void($("#"+currentData.IdSlide).find(".current-background-slide").hasClass("blocked")?r.addClass("blocked"):r.removeClass("blocked"));var e=$("#"+currentData.IdItem);e.hasClass("blocked")?i(e):l(e)}function i(e){r.addClass("blocked"),e.addClass("blocked"),e.hasClass("pin-element")?e.removeClass("pin-draggable"):e.removeClass("element-draggable"),e.attr("data-blocked",!0)}function l(e){r.removeClass("blocked"),e.hasClass("pin-element")?e.addClass("pin-draggable"):e.addClass("element-draggable"),e.removeClass("blocked"),e.attr("data-blocked",!1)}var r=$("html");return{blockDiv:e,unBlockDiv:t,checkBlock:n}}(),TransitionSlides=function(){function e(){var e,t=$("input[name=transitionType]:checked").val();l[0].checked?(e=i+"UpdateTransitionToAll",$(".slide-page").data("transition",t),$(".slide-page").attr("data-transition",t)):(e=i+"UpdateTransition",$("#"+currentData.IdSlide).data("transition",t),$("#"+currentData.IdSlide).attr("data-transition",t));var a={IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially,Transition:t};ApiGenially.executeCall(a,e,"PUT")}function t(){$(".select-page-transition").click(e)}function a(){var e=$(".current-slide").find(".slide-page").data("transition");if(0!==e){var t=$("#transitionSlide-"+e);if(t.length>0){var a=$(document.getElementById("tabbed-transitions")),n=a.children('[data-tab="horizontal"]'),i=a.children('[data-tab="vertical"]'),l=a.children('[data-tab="no-transition"]');switch(t[0].checked=!0,t.attr("data-type")){case"horizontal":n.click();break;case"vertical":i.click();break;case"no-transition":l.click()}}}}function n(){t(),a()}var i="/api/slide/",l=$("#transitionToAllSlides");return{start:n,loadCurrentTransition:a}}();jQuery.fn.selectText=function(){var e=document,t=this[0];if(e.body.createTextRange){var a=document.body.createTextRange();a.moveToElementText(t),a.select(),t.focus()}else if(window.getSelection){var n=window.getSelection(),a=document.createRange();a.selectNodeContents(t),n.removeAllRanges(),n.addRange(a),t.focus()}};for(var Text=function(){function e(e){var t=$("#"+e).find(".text-div");t[0].removeEventListener("paste",b,!0),t[0].addEventListener("paste",b,!0)}function t(e,t,a,n,l){function r(e){$(".working").removeClass("working"),$("#"+o).css("pointer-events",""),$("#"+o).attr("id",e),$("#fake-"+o).attr("id","fake-"+e),$("#"+e).addClass("working"),m.hasClass("multidragging")||Canva.selectItem(e),Canva.hideSideBars(),Background.hideSelector(),m.removeClass("blocked");var t={title:"Text Element",idItem:e,typeItem:"text",icon:"title",blocked:"",visible:!1,zIndex:y};DesignLayers.pushLayer(t),DesignLayers.reorder(),i($("#"+e)),Canva.setPositionSelectorText()}var o=guid(),s=$(l.target).clone(),d=localStorage.getItem("previousTextColor");null===d&&(d="#666666"),s.css("color",d);var c="",u="",p=350;switch(n){case 1:c=locale.text.mTitle,p=250;break;case 2:c=locale.text.mSubTitle,p=250;break;case 3:c=locale.text.mParagraph,p=300;break;case 4:c=locale.text.mListPoint,p=250;break;case 5:c=locale.text.mListEnum,p=250}var g="",f="",h=[],y=ZIndex.getMaximum();"none"!==localStorage.getItem("font-family")&&s.css("font-family",localStorage.getItem("font-family"));var I={TextMessage:c,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Color:s.css("color"),FontSize:s.css("font-size"),FontFamily:s.css("font-family"),Size:{Width:p+"px",Height:s.css("height")},Background:s.css("background"),Padding:s.css("padding-top"),EffectIn:"none",EffectOut:"none",EffectHover:"none",Effect:"none",DurationIn:"vel3",DurationOut:"vel3",DelayOut:0,DelayIn:0,Type:n,Rotation:{Rotatione:""},Position:{PositionLeft:t+"px",PositionTop:a+"px"},ZIndex:y,Shadow:u,Id:o,Blocked:!1};h.push(I),g+=Genially.templates.text(h),f+=Genially.templates.text_clone(h),$("#"+currentData.IdSlide).append(g),$("#slide-clone-"+currentData.IdSlide).append(f),ZIndex.newDivZIndex();var b=$("#"+o);I.Size.Height=b.height()+"px";var C=v+"CreateText";b.css("pointer-events","none"),I.Id=null,ApiGenially.executeCall(I,C,"POST",r)}function a(){m.hasClass("touchevents")?interact(".text-example").on("tap",function(e){var a=$(e.target).attr("style"),n=$(e.target).data("type"),i=$("#"+currentData.IdSlide).height()/2-100,l=$("#"+currentData.IdSlide).width()/2-160;t(a,l,i,n,e),SecondaryActions.forceHide()}):$(".text-example").click(function(e){var a=$(e.target).attr("style"),n=$(e.target).data("type"),i=$("#"+currentData.IdSlide).height()/2-100,l=$("#"+currentData.IdSlide).width()/2-160;t(a,l,i,n,e),SecondaryActions.forceHide()}),$(".text-example").draggable({opacity:.7,helper:"clone",appendTo:"body",scroll:!1,stop:function(e,a){var n=currentMousePosAtImgInPX(),i=$(a.helper).attr("style"),l=$(a.helper).data("type");t(i,n.x,n.y,l,e)},zIndex:9e3})}function n(){if(m.hasClass("touchevents")){var e=$("#tb-text");e.addClass("floating");var t=$("#selector"),a=t.css("top"),n=(t.css("left"),$("#wrapperHolder")),i=n.width(),l=(n.offset().left,e.width()),r=t.offset().left;if(r+l>i){var o=i-l;e.css({top:a,left:o})}else{var s=r-l/2;s<110&&(s=110),e.css({top:a,left:s})}}}function i(t){if(!(m.hasClass("multidrag")&&t.hasClass("blocked")||(m.hasClass("touchevents")||t.hasClass("blocked")||Selectable.destroy(),Canva.hideSideBars(),m.hasClass("blocked")||m.hasClass("editing-text")))){n(),currentData.IdItem=t.attr("id"),currentIdTextEditing=currentData.IdItem,m.addClass("editing-text"),$("#selector").hide(),FakeText.setSelector(currentData.IdItem),I.beforeTextChange=o(t[0]),t[0].classList.remove("element-draggable"),t[0].classList.add("editable"),t.find(".text-div").attr("contenteditable","true"),t.removeClass("element");var a=t[0];a.focus();var i=a.firstChild,l=0,r=document.createRange();if(null!==i){r.setStart(i,l),r.setEnd(i,l);var s=window.getSelection();s.removeAllRanges(),s.addRange(r)}var d=t.find(".text-div").text();d="<span>"+d+"</span>",d!==locale.text.mTitle&&d!==locale.text.mSubTitle&&d!==locale.text.mParagraph&&d!==locale.text.mListPoint&&d!==locale.text.mListEnum||t.find(".text-div").selectText();var c=t.attr("id");e(c),Canva.hideAllMenusWithoutUnselectText()}}function l(){interact(".text-draggable").on("tap",function(t){if(m.addClass("inside-text"),!(m.hasClass("multidrag")&&$(t.target).hasClass("blocked")||t.shiftKey||t.ctrlKey||t.metaKey||(m.hasClass("touchevents")||$(t.target).hasClass("blocked")||Selectable.destroy(),Canva.hideSideBars(),m.hasClass("blocked")||m.hasClass("editing-text")))){y=t,n(),currentData.IdItem=$(t.currentTarget).attr("id"),currentIdTextEditing=currentData.IdItem,m.addClass("editing-text"),FakeText.setSelector(currentData.IdItem),I.beforeTextChange=o(t.currentTarget),t.currentTarget.classList.remove("element-draggable"),t.currentTarget.classList.add("editable"),$(t.currentTarget).find(".text-div").attr("contenteditable","true"),$(t.currentTarget).removeClass("element");var a=t.target;a.focus();var i=a.firstChild,l=0,r=document.createRange();if(null!==i){r.setStart(i,l),r.setEnd(i,l);var s=window.getSelection();s.removeAllRanges(),s.addRange(r)}var d=$(t.currentTarget).find(".text-div").text();d="<span>"+d+"</span>",d===locale.text.mTitle||d===locale.text.mSubTitle||d===locale.text.mParagraph?$(t.currentTarget).find(".text-div").selectText():$(t.currentTarget).find(".text-div").focus();var c=$(t.currentTarget).attr("id");e(c),Canva.hideAllMenusWithoutUnselectText()}})}function r(){if(0===Multidrag.countElements())return null;var e=[];return $.each(Multidrag.multiElements,function(t,a){var n={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateTextMessage",idItem:a.attr("id"),idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":"",TextMessage:a.find(".text-div").html()},i=a.attr("class").split(" "),l=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(i,function(e,t){l.indexOf(t)!==-1&&n.Classes.push(t)}),e.push(n)}),e}function o(e){var t=$(e),a={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateTextMessage",idItem:t.attr("id"),idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),Classes:[],Background:t.css("background-color"),Opacity:t.css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":"",TextMessage:t.find(".text-div").html()},n=t.attr("class").split(" "),i=["text-align-left","text-align-right","text-align-center","text-align-justify"];return $.each(n,function(e,t){i.indexOf(t)!==-1&&a.Classes.push(t)}),a}function s(e){var t="/api/Text/UpdateTextMessage",a=$("#"+e),n=a.find(".text-div").html();if('<ul style="list-style-type:decimal;"></ul>'!==n&&'<ul style="list-style-type:point;"></ul>'!==n||(a.find(".text-div").html("<br><br>"),n="<br><br>"),null===e)return m.removeClass("editing-text"),void Canva.unselectItem();var i={Id:e,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},TextMessage:n};$("#fake-"+i.Id).css({width:i.Size.Width,height:i.Size.Height,left:i.Position.PositionLeft,top:i.Position.PositionTop}).find(".text-div").html(i.TextMessage),ApiGenially.executeCall(i,t,"PUT")}function d(){if(0!==Multidrag.countElements()){var e="/api/Text/MultiUpdateTextMessage",t=[];$.each(Multidrag.multiElements,function(e,a){var n=a.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==n&&'<ul style="list-style-type:point;"></ul>'!==n||(a.find(".text-div").html("<br><br>"),n="<br><br>");var i={Id:a.attr("id"),IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},TextMessage:n};$("#fake-"+i.Id).css({width:i.Size.Width,height:i.Size.Height,left:i.Position.PositionLeft,top:i.Position.PositionTop}).find(".text-div").html(i.TextMessage),t.push(i)}),ApiGenially.executeCall(t,e,"PUT")}}function c(e){var t="/api/Text/UpdateTextMessage",a=$("#"+e),n=a.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==n&&'<ul style="list-style-type:point;"></ul>'!==n||(a.find(".text-div").html("<br><br>"),
n="<br><br>");var i={Id:e,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},TextMessage:n};$("#fake-"+i.Id).css({width:i.Size.Width,height:i.Size.Height,left:i.Position.PositionLeft,top:i.Position.PositionTop}).find(".text-div").html(i.TextMessage),ApiGenially.executeCall(i,t,"PUT")}function u(){m.removeClass("editing-text"),m.removeClass("blocked");var e=$("#"+currentIdTextEditing);e.css({height:""}),e.css({height:e.height()+"px"}),Canva.selectItem(currentIdTextEditing);var t=$(".editable");e.hasClass("blocked")||t.addClass("element-draggable"),t.removeClass("editable"),s(currentIdTextEditing),document.getSelection().removeAllRanges(),e.find(".text-div").attr("contenteditable","false"),e.addClass("element"),DesignMode.showSettings().enabled&&DesignMode.showDesignMode(),h=0,Selectable.init(),FakeText.removeSelector()}function p(){return y}function g(){function e(){FakeText.setSelector(currentData.IdItem)}a(),l(),$(document).on("input",".text-div",function(t){m.hasClass("editing-text")&&(I.afterTextChange=Object.assign({},I.beforeTextChange),I.afterTextChange.TextMessage=$(t.target).html(),UndoRedo.createElement(I.beforeTextChange,I.afterTextChange),I.beforeTextChange=I.afterTextChange,_.debounce(Canva.setPositionSelectorText,300)(),_.debounce(e,300)())})}function f(){g()}var m=($("#tb-text").find("#textBold"),$("#tb-text").find("#textItalic"),$("#tb-text").find("#textUnderlined"),$("html")),h=!0,v="/api/Text/",y=null,I={beforeTextChange:null,afterTextChange:null},b=function(e){e.stopPropagation(),e.preventDefault();var t=e.clipboardData||window.clipboardData,a=t.getData("Text");document.execCommand("insertText",!1,a)};return{start:f,currentEditingText:p,finishEditingText:u,saveText:s,saveTextWithoutFinish:c,getPreviousStateObject:o,getMultiPreviousStateObject:r,saveMultidragTextWithoutFinish:d,copyPasteJustTextEvent:e}}(),Area=function(){function e(e,t){function i(e){$("#"+o).css("pointer-events",""),$("#"+o).attr("id",e),$("#fake-"+o).attr("id","fake-"+e),$("html").hasClass("multidragging")||(Background.hideSelector(),Canva.selectItem(e),Block.checkBlock());var t={title:"Interactive Area",idItem:e,typeItem:"area",icon:"crop_free",blocked:"",visible:!1,zIndex:c};DesignLayers.pushLayer(t),DesignLayers.reorder()}function l(e){SaveDisplay.showError()}var o=guid(),s="",d="",c=ZIndex.getMaximum(),u=[],p={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:a,Height:n},Position:{PositionLeft:e+"px",PositionTop:t+"px"},ZIndex:c,Id:o,TypeContent:0,Background:"background: rgba(201, 79, 127, 0.5)",Blocked:!1};u.push(p),s=Genially.templates.area(u),d=Genially.templates.area_clone(u),$("#"+currentData.IdSlide).append(s),$("#slide-clone-"+currentData.IdSlide).append(d),ZIndex.newDivZIndex();var g=$("#"+o);g.css("pointer-events","none"),p.Id=null,ApiGenially.executeCall(p,r,"POST",i,l)}var t,a="200px",n="100px",i=200,l=100,r=(ZIndex.getMaximum(),"/api/Area/CreateArea"),o=function(t){$(this).hasClass("active")||($(".pin-type").removeClass("active"),$(this).addClass("active"),$("#pinsHolder").html('<div id="area-item" class="d-block m-t-10 m-b-10 area-draggable" style="width: 271px; height: 170px; background: rgba(201,79,127,0.5); margin:0 auto;"></div>'),$("html").hasClass("touchevents")?interact("#area-item").on("tap",function(t){var a=$("#"+currentData.IdSlide).height()/2-l/2,n=$("#"+currentData.IdSlide).width()/2-i/2;e(n,a),SecondaryActions.forceHide()}):$("#area-item").click(function(t){var a=$("#"+currentData.IdSlide).height()/2-l/2,n=$("#"+currentData.IdSlide).width()/2-i/2;e(n,a),SecondaryActions.forceHide()}),$("#area-item").draggable({opacity:.7,helper:"clone",appendTo:"body",scroll:!1,stop:function(t,a){var n=currentMousePosAtImgInPX();e(n.x,n.y)},zIndex:9e3}))},s=function(){t=$(".area-type"),t.click(o)},d=function(){s()};return{init:d}}(),SvgImages=function(){function e(){function e(e,t,a){$(a).find(e).css("fill",t)}$(".svg-draggable, .svg-clone-draggable").each(function(){var t=parseInt($(this).attr("data-num-color"));switch(t){case 1:e(".color1",$(this).attr("data-color-1"),this);break;case 2:e(".color1",$(this).attr("data-color-1"),this),e(".color2",$(this).attr("data-color-2"),this);break;case 3:e(".color1",$(this).attr("data-color-1"),this),e(".color2",$(this).attr("data-color-2"),this),e(".color3",$(this).attr("data-color-3"),this)}})}function t(e){function t(e,t,a){$(a).find(e).css("fill",t)}e.find(".svg-draggable, .svg-clone-draggable").each(function(){var e=parseInt($(this).attr("data-num-color"));switch(e){case 1:t(".color1",$(this).attr("data-color-1"),this);break;case 2:t(".color1",$(this).attr("data-color-1"),this),t(".color2",$(this).attr("data-color-2"),this);break;case 3:t(".color1",$(this).attr("data-color-1"),this),t(".color2",$(this).attr("data-color-2"),this),t(".color3",$(this).attr("data-color-3"),this)}})}function a(e,t,a,i,l,r,o){function s(e){v.css({opacity:"1"}),v.find(".wrapper-svg").find("img").remove(),v.find(".wrapper-svg").append(e.SourceSvg),y.find(".wrapper-svg").append(e.SourceSvg),v.attr("data-num-color",e.colorsCount),v.attr("id",e.Id),$("#fake-"+d).attr("id","fake-"+e.Id);for(var t=0;t<e.Colors.length;t++)v.attr("data-color-"+parseInt(t+1),e.Colors[0]),$("#fake-"+e.Id).attr("data-color-"+parseInt(t+1),e.Colors[0]);v.css({"pointer-events":""});var a={title:"SVG Element",idItem:e.Id,typeItem:"svg",icon:"wallpaper",blocked:"",visible:!1,zIndex:g};DesignLayers.pushLayer(a),DesignLayers.reorder()}if(0!==l&&0!==r){var d=guid(),c="",u="",p=[],g=ZIndex.getMaximum(),f=$("#containerResources").find('[data-id="'+a+'"]');if(f.hasClass("svg-lines-resource")){var m=l/r;l=300,r=l/m}var h={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,ColorsCount:1,Colors:["#ffffff"],Size:{Width:l+"px",Height:r+"px"},EffectIn:"none",EffectOut:"none",EffectHover:"none",Effect:"none",DurationIn:"vel3",DurationOut:"vel3",DelayOut:0,DelayIn:0,Rotation:{Rotatione:""},Position:{PositionLeft:e+"px",PositionTop:t+"px"},ZIndex:g,IdSvg:a,AspectRatio:o,Id:d};p.push(h),c+=Genially.templates.svgs(p),u+=Genially.templates.svgs_clone(p),$("#"+currentData.IdSlide).append(c),$("#slide-clone-"+currentData.IdSlide).append(u);var v=$("#"+d),y=$("#fake-"+d);v.find(".wrapper-svg").append('<img style="width:100%; src="'+i.replace('"',"")+'" />'),ZIndex.newDivZIndex();var I=n+"CreateSvg";v.css("pointer-events","none"),v.css({opacity:"0.5"}),ApiGenially.executeCall(h,I,"POST",s)}}var n="/api/Svg/";return{printColorsSvg:e,createSvg:a,printColorsSvgCustom:t}}(),Canva=function(){function e(e,a,n,i){var l=null,r=null,o=null,s=null;if(null!==e){var d=$(e);a={left:e.getBoundingClientRect().left,top:e.getBoundingClientRect().top},n=e.getBoundingClientRect().width,i=e.getBoundingClientRect().height,l=d.outerWidth(!0),r=d.outerHeight(!0),o=t(d.css("left")),s=t(d.css("top"))}return[{type:"h",left:a.left,top:a.top,realLeft:o,realTop:s},{type:"h",left:a.left,top:a.top+i,realLeft:o,realTop:s+r},{type:"v",left:a.left,top:a.top,realLeft:o,realTop:s},{type:"v",left:a.left+n,top:a.top,realLeft:o+l,realTop:s},{type:"h",left:a.left,top:a.top+i/2,realLeft:o,realTop:s+r/2},{type:"v",left:a.left+n/2,top:a.top,realLeft:o+l/2,realTop:s}]}function t(e){return parseInt(e.replace("px",""))}function a(e){var t=e.attr("id"),a="";e.hasClass("text-draggable")?a="text":e.hasClass("image-draggable")?a="image":e.hasClass("svg-draggable")?a="svg":e.hasClass("area-draggable")?a="area":e.hasClass("pin-draggable")?a="pin":e.hasClass("content-draggable")&&(a="content"),currentData.IdItem=t,currentData.TypeItem=a}function n(e){ae.hide(),e.hasClass("text-draggable")?(ae.css({transform:"rotate(0)"}),ae.show(),ee.find(".pointer9").show(),ee.find(".pointers").show(),ee.find(".rotate-line").show(),ToolbarText.changeDynamicElements()):e.hasClass("image-draggable")?(ae.css({transform:"rotate(0)"}),ae.show(),ee.find(".pointer9").show(),ee.find(".pointers").show(),ee.find(".rotate-line").show(),ToolbarImage.changeDynamicElements()):e.hasClass("svg-draggable")?(ee.find(".pointer9").show(),ee.find(".pointers").show(),ee.find(".rotate-line").show(),ToolbarSVG.changeDynamicElements(),ae.css({transform:"rotate(0)"}),ae.show()):e.hasClass("area-draggable")?(ae.css({transform:"rotate(0)"}),ae.show(),ee.find(".pointer9").hide(),ee.find(".pointers").show(),ee.find(".rotate-line").hide(),ToolbarArea.changeDynamicElements()):e.hasClass("pin-draggable")?(ae.css({transform:"rotate(0)"}),ae.show(),ee.find(".pointer9").hide(),ee.find(".pointers").hide(),ee.find(".rotate-line").hide(),ToolbarPin.changeDynamicElements()):e.hasClass("content-draggable")&&(ee.find(".pointer9").hide(),ee.find(".pointers").show(),ee.find(".rotate-line").hide(),oe.prop("disabled",!1),re.prop("disabled",!0),se.prop("disabled",!1),de.prop("disabled",!1)),ee.show(),d(e)}function i(e){var t=0;try{var a=e.css("-webkit-transform")||e.css("-moz-transform")||e.css("-ms-transform")||e.css("-o-transform")||e.css("transform");if("none"!==a){var n=a.split("(")[1].split(")")[0].split(","),i=n[0],l=n[1];t=Math.round(Math.atan2(l,i)*(180/Math.PI))}else t=0;return t}catch(r){return t}}function l(){if("text"===currentData.TypeItem){var e=$("#"+currentData.IdItem),t=$(e).clone();t.css("transform","none"),t.css("display","block"),$("#"+currentData.IdSlide).append(t),ee.css("left",t[0].getBoundingClientRect().left+"px"),ee.css("top",t[0].getBoundingClientRect().top+"px"),ee.css("width",t.find(".text-div")[0].getBoundingClientRect().width+"px"),ee.css("height",t.find(".text-div")[0].getBoundingClientRect().height+"px"),t.remove();var a=i(e);ee.css("transform","rotate("+a+"deg)");var n=ee.css("width").split("px")[0]/2;ae.css("transform","rotate("+a+"deg)"),ae.css("left",ee.css("left")).css("left","+="+(n-15)),ae.css("top",ee.css("top").split("px")[0]-45+"px"),ee.show()}}function r(e){if("text"===currentData.TypeItem){var t=$("#"+currentData.IdItem);t.css({height:""}),t.css({height:t.height()+"px"})}var a=$(e).clone();a.css("transform","none"),a.css("display","block"),$("#"+currentData.IdSlide).append(a),ee.css("left",a[0].getBoundingClientRect().left+"px"),ee.css("top",a[0].getBoundingClientRect().top+"px"),ee.css("width",a[0].getBoundingClientRect().width+"px"),ee.css("height",a[0].getBoundingClientRect().height+"px"),a.remove();var n=ee.css("width").split("px")[0]/2;ae.css("transform","rotate("+i($(e))+"deg)"),ae.css("left",ee.css("left")).css("left","+="+(n-15)),ae.css("top",ee.css("top").split("px")[0]-45+"px"),ee.css("transform","rotate("+i($(e))+"deg)"),ee.show(),$(".working").removeClass("working"),$(e).addClass("working")}function o(e){if(null!==e){var t=$("#"+e);a(t),r(t[0]),n(t),AnimationsEditor.loadDataItem(t),T(),DesignMode.setDesignObject(e),le.removeClass("tb-general tb-text tb-image tb-svg tb-pin tb-area tb-background"),"text"===currentData.TypeItem?(le.addClass("tb-general tb-text"),ToolbarText.changeDynamicElements()):"image"===currentData.TypeItem?(le.addClass("tb-general tb-image"),ToolbarImage.changeDynamicElements()):"svg"===currentData.TypeItem?(le.addClass("tb-general tb-svg"),ToolbarSVG.changeDynamicElements()):"pin"===currentData.TypeItem?(le.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements()):"area"===currentData.TypeItem?(le.addClass("tb-general tb-area"),ToolbarArea.changeDynamicElements()):"content"===currentData.TypeItem&&le.addClass("tb-general")}}function s(e){var t=e[0].style.transform;if(""===t)return t;try{if("none"!==t){if(t.indexOf("matrix")===-1)return t;try{var a=t.split("(")[1].split(")")[0].split(","),n=a[0];n=Math.round(1e7*n)/1e7;var i=a[1];i=Math.round(1e7*i)/1e7;var l=i*-1;l=Math.round(1e7*l)/1e7;var r="matrix("+n+", "+i+", "+l+","+n+", 0, 0)";return r}catch(o){return t}}}catch(o){return""}}function d(e){"svg"===$(e).attr("data-type")&&"true"===$(e).attr("data-aspect-ratio")||$(e).hasClass("rotated-item")?(ee.find(".pointer-north").hide(),ee.find(".pointer-east").hide(),ee.find(".pointer-west").hide(),ee.find(".pointer-south").hide()):$(e).hasClass("text-draggable")?(ee.find(".pointers").hide(),ee.find(".pointer-east").show(),ee.find(".pointer-west").show()):(ee.find(".pointer-north").show(),ee.find(".pointer-east").show(),ee.find(".pointer-west").show(),ee.find(".pointer-south").show()),"pin"===$(e).attr("data-type")&&ee.find(".pointers").hide()}function c(){var e="/api/"+currentData.TypeItem+"/UpdateSize",t=$("#"+currentData.IdItem),a=s(t);if("svg"===currentData.TypeItem)try{var n=t.css("height").replace("px",""),i=t.find("svg").height();n<i&&t.css("height",i)}catch(l){}var r={Id:currentData.IdItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},Rotation:{Rotatione:a}};if(null!==r.Id){$("#fake-"+currentData.IdItem).css({width:t.css("width"),height:t.css("height"),left:t.css("left"),top:t.css("top"),transform:t.css("transform")});var o={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdateSize",width:t.css("width"),height:t.css("height"),top:t.css("top"),left:t.css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:t.attr("data-x"),dataY:t.attr("data-y")};ce.endResize=o,UndoRedo.createElement(ce.startResize,ce.endResize),ApiGenially.executeCall(r,e,"PUT")}}function u(e){_=$("#"+currentData.IdItem);var t=_.attr("data-aspect-ratio");!e.edges.right&&!e.edges.left||e.edges.top||e.edges.bottom?!e.edges.top&&!e.edges.bottom||e.edges.left||e.edges.right||"true"!==t&&(interact("#selector").options.resize.preserveAspectRatio=!1,interact("#selector").options.resize.square=!1):"true"!==t&&(interact("#selector").options.resize.preserveAspectRatio=!1,interact("#selector").options.resize.square=!1),_.hasClass("svg-draggable")&&(X=_.find(".wrapper-svg")),le.addClass("resizing"),_.addClass("opacity-class"),Q=_.outerWidth()-_.width(),V=$(e.target).height(),K=$(e.target).width(),$(".lines-resize").show(),ne.show(),ae.hide();var a={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdateSize",width:_.css("width"),height:_.css("height"),top:_.css("top"),left:_.css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:_.attr("data-x"),dataY:_.attr("data-y")};ce.startResize=a,DesignMode.setDesignObject(currentData.IdItem),SecondaryActions.processHide()}function p(e){_.removeClass("opacity-class"),$(".lines-resize").hide();var t=$("#"+currentData.IdItem);c(),ne.hide(),setTimeout(function(){le.removeClass("resizing")},100),interact("#selector").options.resize.preserveAspectRatio=!0,interact("#selector").options.resize.square=!0,r(t),n(t),DesignMode.setDesignObject(currentData.IdItem),"text"===currentData.TypeItem&&le.hasClass("editing-text")&&FakeText.setSelector(currentData.IdItem)}function g(e){var t,a,n=(_.attr("data-aspect-ratio"),e.target),i=0,l=0;if(_.hasClass("rotated-item")){n=e.target,t=$(e.target).width()+e.deltaRect.width,a=V*t/K,n.style.width=e.rect.width+"px",n.style.height=e.rect.height+"px",$(n).width(t),$(n).height(a);var r=t/watching.scale,o=a/watching.scale;ne.css({left:ee.css("left"),top:ee.css("top")}),ne.find("#one").text(parseInt(r)),ne.find("#two").text(parseInt(o)),_.width(parseInt(r)),_.height(parseInt(o)),_.hasClass("svg-draggable")&&(X.width(parseInt(r)),X.height(parseInt(o)))}else if(_.hasClass("text-draggable")){n.style.width=parseInt(e.rect.width)+"px",i+=e.deltaRect.left;var s=$(n).offset();$(n).offset({left:s.left+e.deltaRect.left}),e.edges.left&&e.edges.bottom&&!e.edges.top&&!e.edges.right,n.setAttribute("data-x",i),t=parseInt(e.rect.width)/watching.scale,ne.css({left:ee.css("left")}),ne.find("#one").text(parseInt(t)),_.width(parseInt(t)),i=parseFloat(_.position().left)/watching.scale+e.deltaRect.left/watching.scale,_.css("left",i),_.attr("data-x",i)}else{n.style.width=e.rect.width+"px",n.style.height=e.rect.height+"px",i+=e.deltaRect.left,l+=e.deltaRect.top;var s=$(n).offset();if($(n).offset({left:s.left+e.deltaRect.left,top:s.top+e.deltaRect.top}),e.edges.left&&e.edges.bottom&&!e.edges.top&&!e.edges.right,n.setAttribute("data-x",i),n.setAttribute("data-y",l),t=e.rect.width/watching.scale,a=e.rect.height/watching.scale,ne.css({left:ee.css("left"),top:ee.css("top")}),ne.find("#one").text(parseInt(t)),ne.find("#two").text(parseInt(a)),_.width(t),_.height(a),i=_.position().left/watching.scale+e.deltaRect.left/watching.scale,l=_.position().top/watching.scale+e.deltaRect.top/watching.scale,_.css("left",i),_.css("top",l),_.attr("data-x",i),_.attr("data-y",l),_.hasClass("svg-draggable")&&(X.width(t),X.height(a)),"content"===currentData.TypeItem){var d=_.attr("id");$("#fake-"+d).find("iframe").css({height:_.height()}),_.find("iframe").css({height:_.height()})}}}function f(){interact("#selector").resizable({max:1,preserveAspectRatio:!0,edges:{left:!0,right:!0,bottom:!0,top:!0},onstart:u,onmove:g,onend:p})}function m(){var e="/api/"+currentData.TypeItem+"/UpdateRotation",t=$("#"+currentData.IdItem),a=s(t),n={Id:currentData.IdItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},Rotation:{Rotatione:a}};if(null!==n.Id){$("#fake-"+currentData.IdItem).css({width:t.css("width"),height:t.css("height"),left:t.css("left"),top:t.css("top"),transform:t.css("transform")}),ApiGenially.executeCall(n,e,"PUT");var i={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdateRotation",width:t.css("width"),height:t.css("height"),top:t.css("top"),left:t.css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:t.attr("data-x"),dataY:t.attr("data-y"),angle:a};ce.endRotate=i,UndoRedo.createElement(ce.startRotate,ce.endRotate)}}function h(e){var t=180*Math.atan2(Z.posY-e.pageY,Z.posX-e.pageX)/Math.PI,a=parseInt(t)+Y;0!==a?_.addClass("rotated-item"):_.removeClass("rotated-item"),_.css({transform:"rotate("+a+"deg)"}),ee.css({transform:"rotate("+a+"deg)"}),ie.css({left:ee.css("left"),top:ee.css("top")}),ie.find("span.angle").html(parseInt(a,10)),ie.show()}function v(e){le.addClass("rotating"),FakeText.removeSelector();var t=e.interactable.getRect(e.target.parentNode);_=$(".working"),_.addClass("opacity-class"),Z={posX:t.left+t.width/2,posY:t.top+t.height/2};var a=180*Math.atan2(Z.posY-e.pageY,Z.posX-e.pageX)/Math.PI;Y=i(_)-a,Y=parseInt(Y);var n={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdateRotation",width:_.css("width"),height:_.css("height"),top:_.css("top"),left:_.css("left"),angle:s(_),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially};ae.hide(),DesignMode.setDesignObject(currentData.IdItem),ce.startRotate=n}function y(e){_.removeClass("opacity-class"),ie.hide(),m(),setTimeout(function(){le.removeClass("rotating")},100),"text"===currentData.TypeItem&&FakeText.setSelector(currentData.IdItem),n(_),DesignMode.setDesignObject(currentData.IdItem)}function I(){interact(".pointer9").draggable({max:1,onmove:h,onstart:v,onend:y})}function b(){var e="/api/"+currentData.TypeItem+"/UpdatePosition",t=$("#"+currentData.IdItem),a=s(t),n={Id:currentData.IdItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},Rotation:{Rotatione:a}};$("#fake-"+currentData.IdItem).css({width:t.css("width"),height:t.css("height"),left:t.css("left"),top:t.css("top"),transform:t.css("transform")}),null!==n.Id&&ApiGenially.executeCall(n,e,"PUT")}function C(){var e="/api/"+currentData.TypeItem+"/SaveAll",t=$("#"+currentData.IdItem),a=s(t),n={};n="content"===currentData.TypeItem||"area"===currentData.TypeItem?{Id:currentData.IdItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")}}:{Id:currentData.IdItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},Rotation:{Rotatione:a}},null!==n.Id&&ApiGenially.executeCall(n,e,"PUT")}function x(t){if(0===Multidrag.countElements()){if(le.hasClass("editing-text"))return;le.removeClass("selected-items");var a={top:{dist:J+1},left:{dist:J+1}},n=$(t.target)[0],i={top:t.pageY-N,left:t.pageX-j},l=n.getBoundingClientRect().width,o=n.getBoundingClientRect().height,s=e(null,i,l,o);$.each(q,function(e,t){$.each(s,function(e,n){if(t.type==n.type){var l="h"==t.type?"top":"left",r=Math.abs(n[l]-t[l]);r<a[l].dist&&(a[l].dist=r,a[l].offset=(n[l]-i[l])/watching.scale,a[l].guide=t)}})});var d=$(t.target),c=(parseFloat(d[0].getAttribute("data-x"))||0)+t.dx/watching.scale,u=(parseFloat(d[0].getAttribute("data-y"))||0)+t.dy/watching.scale,p=0,g=0,f=0,m=0;if(a.top.dist<=J?($("#guide-h").css("top",a.top.guide.top).show(),p=a.top.guide.realTop-a.top.offset,d.css("top",p),m=p):($("#guide-h").hide(),d.css("top",u),m=u),a.left.dist<=J?($("#guide-v").css("left",a.left.guide.left).show(),g=a.left.guide.realLeft-a.left.offset,d.css("left",g),f=g):($("#guide-v").hide(),d.css("left",c),f=c),ne.css({left:i.left,top:i.top}),ne.find("#one").text(parseInt(c)),ne.find("#two").text(parseInt(u)),d[0].setAttribute("data-x",c),d[0].setAttribute("data-y",u),d.hasClass("text-draggable")&&r(d[0]),d.hasClass("fake-cursor")){r(d[0]);var h=$("#"+currentData.IdItem);h.css({left:f,top:m}),h[0].setAttribute("data-x",f),h[0].setAttribute("data-y",m)}}else for(var v=0;v<Multidrag.countElements();v++)if("pin"!==$(t).attr("data-type")&&$(t).attr("id")!==$(Multidrag.multiElements[v]).attr("id")){var y=(parseFloat($(Multidrag.multiElements[v]).attr("data-x"))||0)+t.dx/watching.scale,I=(parseFloat($(Multidrag.multiElements[v]).attr("data-y"))||0)+t.dy/watching.scale;$(Multidrag.multiElements[v]).attr("data-x",y),$(Multidrag.multiElements[v]).attr("data-y",I),$(Multidrag.multiElements[v]).css({left:y,top:I})}}function S(t){le.hasClass("editing-text")&&Text.finishEditingText();var n=$(t.target),i=null;n.hasClass("fake-cursor")?(i=$("#"+currentData.IdItem),n.css("height",i.height())):i=n,document.getSelection().removeAllRanges(),$(".svgColor").spectrum("hide"),le.addClass("dragging"),ae.hide(),i.hasClass("text-draggable")||ee.hide(),ne.show(),A(),Background.hideSelector();var l=i[0];a($(l)),$(le).hasClass("multidragging")||AnimationsEditor.loadDataItem($(l));var r={left:t.pageX-l.getBoundingClientRect().left,top:t.pageY-l.getBoundingClientRect().top};if(q=$(t.target).hasClass("rotated-item")?[]:ue?$.map($(".current-slide .element").not(t.target).not(".rotated-item"),e):$.map($(".current-slide .element, .current-slide .slide-page-container").not(t.target).not(".rotated-item"),e),j=r.left,N=r.top,a(i),$("#"+currentData.IdSlide).css({overflow:"visible"}),$(le).hasClass("multidragging")?(currentData.IdItem=null,currentData.TypeItem=null):currentData.IdItem=i.attr("id"),Block.checkBlock(),T(),R(),_=$("#"+currentData.IdItem),_.addClass("opacity-class"),0===Multidrag.countElements()){var o={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:_.css("width"),height:_.css("height"),top:_.css("top"),left:_.css("left"),angle:s($("#"+currentData.IdItem)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:_.attr("data-x"),dataY:_.attr("data-y")};ce.startDraggable=o,DesignMode.setDesignObject(currentData.IdItem),SecondaryActions.processHide(),DesignLayers.selectLayer(currentData.IdItem),le.removeClass("tb-general tb-text tb-image tb-svg tb-pin tb-area tb-background"),"text"===currentData.TypeItem?(le.addClass("tb-general tb-text"),ToolbarText.changeDynamicElements()):"image"===currentData.TypeItem?(le.addClass("tb-general tb-image"),ToolbarImage.changeDynamicElements()):"svg"===currentData.TypeItem?(le.addClass("tb-general tb-svg"),ToolbarSVG.changeDynamicElements()):"pin"===currentData.TypeItem?(le.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements()):"area"===currentData.TypeItem?(le.addClass("tb-general tb-area"),ToolbarArea.changeDynamicElements()):"content"===currentData.TypeItem&&le.addClass("tb-general")}else{var d=[];$.each(Multidrag.multiElements,function(e,t){var a={};if("pin"===$(t).attr("data-type")){var n=$(t).attr("data-position"),i=n.split(",")[0],l=n.split(",")[1];a={idItem:$(t).attr("id"),typeContent:$(t).attr("data-type"),typeOperation:"UpdatePosition",top:l,left:i,cssTop:$(t).css("top"),cssLeft:$(t).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(t).attr("data-x"),dataY:$(t).attr("data-y"),dataPosition:n}}else a={idItem:$(t).attr("id"),typeContent:$(t).attr("data-type"),typeOperation:"UpdatePosition",width:$(t).css("width"),height:$(t).css("height"),top:$(t).css("top"),left:$(t).css("left"),angle:s($(t)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(t).attr("data-x"),dataY:$(t).attr("data-y")};$("html").addClass("multidragging-current"),d.push(a)}),ce.startDraggable=d}}function w(e){_.removeClass("opacity-class");var t=e.target;if(ne.hide(),0===Multidrag.countElements()){var a=null;$(t).hasClass("fake-cursor")?(a=$("#"+currentData.IdItem),a.addClass("working")):a=$(e.target),r(a[0]),n(a),$("#guide-v, #guide-h").hide(),$(".working").removeClass("working"),a.addClass("working"),$("#"+currentData.IdSlide).css({overflow:""}),setTimeout(function(){le.removeClass("dragging"),FakeText.removeSelector()},100),DesignMode.setDesignObject(currentData.IdItem),b();var i={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdatePosition",width:_.css("width"),height:_.css("height"),top:_.css("top"),left:_.css("left"),angle:s($("#"+currentData.IdItem)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:_.attr("data-x"),dataY:_.attr("data-y")};ce.endDraggable=i,UndoRedo.createElement(ce.startDraggable,ce.endDraggable)}else{for(var l=[],o=[],d=0;d<Multidrag.countElements();d++)if("pin"===$(Multidrag.multiElements[d]).attr("data-type")){var c=parseFloat($(Multidrag.multiElements[d]).attr("data-x"))+16/watching.scale,u=parseFloat($(Multidrag.multiElements[d]).attr("data-y"))+32/watching.scale;$(Multidrag.multiElements[d]).attr("data-position",c+","+u),l.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:$(Multidrag.multiElements[d]).attr("id"),TypeItem:$(Multidrag.multiElements[d]).attr("data-type"),Position:{PositionLeft:c,PositionTop:u}}),$("#fake-"+$(Multidrag.multiElements[d]).attr("id")).css({left:c,top:u});var i={idItem:$(Multidrag.multiElements[d]).attr("id"),typeContent:$(Multidrag.multiElements[d]).attr("data-type"),typeOperation:"UpdatePosition",top:u,left:c,cssTop:$(Multidrag.multiElements[d]).css("top"),cssLeft:$(Multidrag.multiElements[d]).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(Multidrag.multiElements[d]).attr("data-x"),dataY:$(Multidrag.multiElements[d]).attr("data-y")};o.push(i)}else{l.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:$(Multidrag.multiElements[d]).attr("id"),TypeItem:$(Multidrag.multiElements[d]).attr("data-type"),Position:{PositionLeft:parseFloat($(Multidrag.multiElements[d]).attr("data-x")),PositionTop:parseFloat($(Multidrag.multiElements[d]).attr("data-y"))}}),$("#fake-"+$(Multidrag.multiElements[d]).attr("id")).css({left:parseFloat($(Multidrag.multiElements[d]).attr("data-x")),top:parseFloat($(Multidrag.multiElements[d]).attr("data-y"))});var i={idItem:$(Multidrag.multiElements[d]).attr("id"),typeContent:$(Multidrag.multiElements[d]).attr("data-type"),typeOperation:"UpdatePosition",top:$(Multidrag.multiElements[d]).css("top"),left:$(Multidrag.multiElements[d]).css("left"),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(Multidrag.multiElements[d]).attr("data-x"),dataY:$(Multidrag.multiElements[d]).attr("data-y"),width:$(Multidrag.multiElements[d]).css("width"),height:$(Multidrag.multiElements[d]).css("height")};o.push(i)}setTimeout(function(){le.removeClass("dragging"),$("html").removeClass("multidragging-current")},100),Multidrag.savePositioning(l),ce.endDraggable=o,UndoRedo.createElement(ce.startDraggable,ce.endDraggable)}}function k(){interact(".element-draggable, .fake-cursor").draggable({inertia:!1,autoScroll:!0,onstart:S,onmove:x,onend:w,maxPerElement:1})}function D(){interact(".element").on("tap",pe)}function T(){"pin"===currentData.TypeItem||"text"===currentData.TypeItem||"image"===currentData.TypeItem||"area"===currentData.TypeItem||"svg"===currentData.TypeItem?(Interactivity.showInteractivityButtons(),Interactivity.hideInteractivityError(),Interactivity.showInteractivityActive()):(Interactivity.hideInteractivityButtons(),Interactivity.showInteractivityError({notSupported:!0,notSelected:!1}))}function P(){ee.hide(),ae.hide()}function E(){currentData.IdItem=null,currentData.TypeItem=null,ee.hide(),te.hide(),AnimationsEditor.hideAnimations(),Toolbar.hideAll(),ae.hide(),Interactivity.hideInteractivityButtons(),Interactivity.showInteractivityError({notSupported:!1,notSelected:!0}),$(".working").removeClass("working"),DesignMode.cleanValues(),le.hasClass("multidrag")||Multidrag.clearElements()}function G(){$("input[type=text]:focus, textarea:focus").blur()}function B(){A(),R(),U(),E(),G()}function M(){A(),R(),U(),G()}function O(){A(),SecondaryActions.forceHide(),R(),U(),G()}function U(){$("#showSettings").removeClass("active"),$("#settingsHolder").removeClass("showSettings").addClass("hideSettings")}function A(){Settings.hideMoreOptions()}function R(){var e=$("#geniallySlides"),t=$("#display-slides"),a=$("#slidesFromTemplate");e.hasClass("showActions")&&(e.removeClass("showActions"),e.removeClass("withTemplate"),e.addClass("hideActions")),a.hasClass("showActions")&&(a.removeClass("showActions"),a.addClass("hideActions")),t.hasClass("displayed")&&t.removeClass("displayed")}function z(){function e(e){if(e.preventDefault(),!(le.hasClass("rotating")||le.hasClass("resizing")||le.hasClass("dragging")||le.hasClass("modal-open")||le.hasClass("selecting"))){if(le.hasClass("editing-text")&&!le.hasClass("touchevents"))return $(e.target).parents("#"+currentData.IdItem).length?void 0:"wrapperHolder"===$(e.target).parent().attr("id")?(Text.finishEditingText(),void E()):le.hasClass("inside-text")?void 0:void Text.finishEditingText();if(($(e.target).hasClass("slide-page-container")||$(e.target).hasClass("slide-container")||"wrapperHolder"===$(e.target).attr("id"))&&(le.removeClass("blocked"),B(),Background.hideSelector(),SecondaryActions.processHideAll()),le.hasClass("multidrag")||le.hasClass("multidragging")){var t=e||window.event;t.ctrlKey||t.metaKey||t.shiftKey||17===t.keyCode||91===t.keyCode||16===t.keyCode||(le.removeClass("multidrag multidragging selected-items"),$(".multidrag-element").removeClass("multidrag-element"),$(".multidrag-selector").remove(),currentData.IdItem=null,Toolbar.hideAll(),Multidrag.clearElements())}$(e.target).hasClass("current-background-slide")&&Background.selectBackground()}}function t(e){$("html").hasClass("editing-text")&&Text.finishEditingText()}$("#wrapperHolder").scroll(function(){0!==$("#selector:visible").length&&r(document.getElementById(currentData.IdItem)),0!==$("#selectorBackground:visible").length&&Background.resizeCorners($("#"+currentData.IdSlide).find(".current-background-slide"))}),$("#editorLeft, #editorHead").click(t),$("#wrapperHolder").click(e),$("#wrapperHolder").mousedown(function(e){le.hasClass("editing-text")&&!le.hasClass("touchevents")&&$("#"+currentData.IdItem).has(e.target).length>0&&le.addClass("inside-text")}),$("#wrapperHolder").mouseup(function(){le.hasClass("editing-text")&&!le.hasClass("touchevents")&&setTimeout(function(){le.removeClass("inside-text")},200)})}function F(){$(".slide-container").each(function(e){var t=$(this).find(".pin-draggable"),a=fitJs[$(this).data("id-slide")],n=32;"undefined"!=typeof a&&(n=32/a.scale),
t.css({width:n+"px",height:n+"px"}),$.map(t,function(e){var t=$(e),a=t.attr("data-position"),i=a.split(",")[0],l=a.split(",")[1],r=parseFloat(i),o=parseFloat(l);r-=n/2,o-=n,t.css({left:r}),t.css({top:o}),t.attr("data-x",r),t.attr("data-y",o)}),t.fadeIn()})}function L(){var e=$("#"+currentData.IdSlide),t=e.find(".pin-draggable"),a=32/watching.scale;t.css({width:a+"px",height:a+"px"}),$.map(t,function(e){var t=$(e),n=t.attr("data-position"),i=n.split(",")[0],l=n.split(",")[1],r=parseFloat(i),o=parseFloat(l);r-=a/2,o-=a,t.css({left:r}),t.css({top:o}),t.attr("data-x",r),t.attr("data-y",o)}),t.fadeIn()}function H(){f(),I(),D(),k(),z()}function W(){H()}var j,N,_,Z,X,Y=0,V=0,K=0,J=5,q=[],Q=0,ee=$("#selector"),te=$("#selectorBackground"),ae=$("#magicWand"),ne=($("#textEditAction"),$("#position")),ie=$("#rotation"),le=$("html"),re=$("#permanentCopy"),oe=$("#permanentLock"),se=$("#generalZIndex"),de=$("#generalPosition"),ce={startDraggable:null,endDraggable:null,startRotate:null,endRotate:null,startResize:null,endResize:null},ue=!1;navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)&&(ue=!0),interact(".fake-cursor").on("tap",function(e){Text.finishEditingText()});var pe=function(e){if(!le.hasClass("multidragging-current")){var t=currentData.IdItem,i=window.getSelection();i.removeAllRanges(),DesignLayers.layersContent.find(".layer").children(".title-identifier").attr("contenteditable",!1).blur(),le.hasClass("editing-text")&&Text.finishEditingText();var l=e.currentTarget,o=e||window.event;if(o.ctrlKey||o.metaKey||o.shiftKey||17===o.keyCode||91===o.keyCode||16===o.keyCode){if($(l).hasClass("blocked"))return;le.addClass("multidrag multidragging")}else le.removeClass("multidrag multidragging selected-items");if(!le.hasClass("multidrag")||!$(l).hasClass("blocked")){E(),G(),$(".svgColor").spectrum("hide"),le.hasClass("multidrag")||r(l),$(".working").removeClass("working"),$(l).addClass("working"),a($(l)),AnimationsEditor.loadDataItem($(l)),R(),Background.hideSelector(),re.removeClass("disabled"),Block.checkBlock(),U();var s=!1;if(le.hasClass("multidrag")){if(DesignMode.multiDragging(),null===t||$("#"+t).hasClass("blocked")||(Multidrag.addElement($("#"+t)),$("#"+t).addClass("multidrag-element"),$("#"+t).prepend('<div class="multidrag-selector"></div>')),$(l).hasClass("multidrag-element")?(Multidrag.removeElement($(l)),$(l).find("div.multidrag-selector").remove(),$(l).removeClass("multidrag-element"),s=!0):$(l).hasClass("blocked")||(Multidrag.addElement($(l)),$(l).addClass("multidrag-element"),$(l).prepend('<div class="multidrag-selector"></div>')),0===Multidrag.countElements())return void AnimationsEditor.hideAnimations();le.removeClass("tb-general tb-text tb-image tb-svg tb-pin tb-area tb-background"),"text"===$(l).attr("data-type")?(le.addClass("tb-general tb-text"),ToolbarText.changeDynamicElements()):"image"===$(l).attr("data-type")?(le.addClass("tb-general tb-image"),ToolbarImage.changeDynamicElements()):"svg"===$(l).attr("data-type")?(le.addClass("tb-general tb-svg"),ToolbarSVG.changeDynamicElements()):"pin"===$(l).attr("data-type")?(le.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements()):"area"===$(l).attr("data-type")?(le.addClass("tb-general tb-area"),ToolbarArea.changeDynamicElements()):"content"===$(l).attr("data-type")&&le.addClass("tb-general"),s&&0!==Multidrag.countElements()&&(Multidrag.allSame("text")?(le.addClass("tb-general tb-text"),ToolbarText.changeDynamicElements()):Multidrag.allSame("image")?(le.addClass("tb-general tb-image"),ToolbarImage.changeDynamicElements()):Multidrag.allSame("svg")?(le.addClass("tb-general tb-svg"),ToolbarSVG.changeDynamicElements()):Multidrag.allSame("pin")?(le.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements()):Multidrag.allSame("area")?(le.addClass("tb-general tb-area"),ToolbarArea.changeDynamicElements()):Multidrag.allSame("content")&&le.addClass("tb-general"))}else le.removeClass("tb-general tb-text tb-image tb-svg tb-pin tb-area tb-background"),"text"===currentData.TypeItem?(le.addClass("tb-general tb-text"),ToolbarText.changeDynamicElements()):"image"===currentData.TypeItem?(le.addClass("tb-general tb-image"),ToolbarImage.changeDynamicElements()):"svg"===currentData.TypeItem?(le.addClass("tb-general tb-svg"),ToolbarSVG.changeDynamicElements()):"pin"===currentData.TypeItem?(le.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements()):"area"===currentData.TypeItem?(le.addClass("tb-general tb-area"),ToolbarArea.changeDynamicElements()):"content"===currentData.TypeItem&&le.addClass("tb-general"),n($(l)),T(),"pin"!==currentData.TypeItem&&(DesignMode.setDesignObject(currentData.IdItem),DesignLayers.selectLayer(currentData.IdItem));A(),SecondaryActions.processHide()}}},ge=function(){var e="https://genially.blob.core.windows.net/genially/backgroundStandard.png",t="https://s3-eu-west-1.amazonaws.com/genial.ly/backgroundStandard.png";$("#"+currentData.IdSlide).find(".current-background-slide").attr("src")===e||$("#"+currentData.IdSlide).find(".current-background-slide").attr("src")===t?($("#selectorBackground").find(".pointers").hide(),interact(".resize-drag").draggable(!1),$("#opacity-background").hide(),$("#color-picker-background-toolbar")[0].style.setProperty("display","none","important")):($("#opacity-background").show(),$("#selectorBackground").find(".pointers").show(),$("#color-picker-background-toolbar")[0].style.setProperty("display","inline-block","important"),interact(".resize-drag").draggable(!0))};return{start:W,hideAllMenus:B,hideAllMenusWithoutUnselect:M,hideSideBars:A,unselectItem:E,hideSelector:P,setPositionSelector:r,setPositionSelectorText:l,selectItem:o,saveDraggable:b,hideSlideSideBar:R,hideSettings:U,computePines:F,computeCurrentPines:L,setItemType:a,loadSelectorConfiguration:n,showInteractivity:T,saveAll:C,getRotationStyle:s,checkBackground:ge,hideAllMenusWithoutUnselectText:O}}(),Share=function(){function e(e,t,a,n,i){function l(){return $.ajax({data:e,url:t,type:a,contentType:"application/json; charset=utf-8"})}l().done(n).fail(i)}function t(t){function a(e){e.Width=e.Width.replace("px",""),e.Height=e.Height.replace("px",""),e.PaddingBottom=(e.Height/e.Width*100).toFixed(2);var t=Genially.templates.shareiframe(e);$("#embebShareGenially").text(t),null==e.description&&(e.description="");var a=e.UrlFree;$("#shareGeniallyFacebook").attr("href","https://www.facebook.com/sharer/sharer.php?u="+a),$("#shareGeniallyGoogle").attr("href","https://plus.google.com/share?url="+a),$("#shareGeniallyLinkedin").attr("href","https://www.linkedin.com/shareArticle?mini=true&url="+a+"&title="+e.Name+"&summary="+e.Description+"&source="),$("#shareGeniallyTwitter").attr("href","https://twitter.com/home?status="+a),$("#shareGeniallyLink").text(e.UrlFree);var n=e.UrlPro;null!==n?$("#shareGeniallyLinkPro").text(n):$("#shareDirectLinkHolder").hide(),1===e.TypeSubscription?$("#shareDirectLinkHolder").hide():$("#shareDirectLinkHolder").show(),$("#shareWithEmail").data("id-genially",e.Id),$("#modalShare").modal()}function n(e){}var i={Id:t};e(i,r,"GET",a,n)}function a(){function t(){s.val("Ok :)")}function a(e){s.val("Error...")}var n=s.val();if(helper.validateEmail(n)){var i={email:n,idGeniallyToShare:l};e(i,o,"GET",t,a)}}function n(e){l=e,s.val(""),t(e)}function i(){$("#shareWithEmail").click(a)}var l,r="/api/Panel/GetShareGenially",o="/api/Panel/ShareGeniallyEmail",s=$("#emailToShareGenially");return{init:i,shareWithEmail:a,getShareGenially:t,shareGenially:n}}(),EventsEditor=function(){function e(e){var t=$("#currentBackground"),a=$("#"+e).find(".background-slide-class").attr("src");t.attr("data-background",a),t.css({"background-image":"url("+a+")"});var n=$("#"+e).find(".background-slide-class"),i=100*n[0].style.opacity;$("#backgroundOpacity")[0].noUiSlider.set(i)}function t(){function e(e){e.preventDefault(),Setting.updateName(t.val())}var t=$("#geniallyTitle").find("#inputGeniallyTitle");t.on("keyup",_.debounce(e,500))}function a(){var e=$("#slidesFromTemplate"),t=$("#geniallySlides");e.hasClass("showActions")&&(e.removeClass("showActions"),e.addClass("hideActions"),t.removeClass("withTemplate"),t.find(".right-content").removeClass("no-overflow"))}function n(){function e(){Settings.hideMoreOptions(),Settings.hideSetting(),SecondaryActions.forceHide(),$(this).hasClass("displayed")?($(this).removeClass("displayed"),t.removeClass("showActions"),t.removeClass("withTemplate"),n.hasClass("showActions")&&(n.removeClass("showActions"),n.addClass("hideActions")),t.addClass("hideActions")):($(this).addClass("displayed"),t.removeClass("hideActions"),t.find(".right-content").removeClass("no-overflow"),t.addClass("showActions"))}var t=$("#geniallySlides"),n=$("#slidesFromTemplate"),i=t.find("#display-slides"),l=n.find("#hideSlidesFromTemplate");i.click(e),l.click(a)}function i(){function e(){try{ga("send","event","NewSlideEvent-NEW","Button","New Slide")}catch(e){}SlideCreation.showSlidesWindow()}function t(){Slide.newSlide()}function a(e){var t=document.getElementById("slide-side-clone-"+e.Id),a=document.getElementById("container-side-clone-"+e.Id);fit(t,a,{hAlign:fit.CENTER,vAlign:fit.CENTER,cover:!1,watch:!1,apply:!0})}function n(e){var t=$.map(e,function(e){if("Tahoma"!==e.FontFamily&&e.FontFamily.indexOf("customgenially")===-1)return e.FontFamily}),a=$.unique(t);a.length>0&&window.WebFont.load({google:{families:a}})}function i(e){var t="";e.Images.length>0&&(t+=Genially.templates.image_clone(e.Images)),e.Texts.length>0&&(t+=Genially.templates.text_clone(e.Texts),n(e.Texts)),e.SvgImages.length>0&&(t+=Genially.templates.svgs_clone(e.SvgImages)),e.RichContents.length>0&&(t+=Genially.templates.richcontent_clone(e.RichContents)),e.Pins.length>0&&(t+=Genially.templates.pins_clone(e.Pins));try{$("#slide-side-clone-"+e.Id).append(t),SvgImages.printColorsSvgCustom($("#slide-side-clone-"+e.Id))}catch(a){}}function l(e){function t(e){C=!0,setTimeout(function(){e.slides.forEach(function(e){var t=Genially.templates.slidesof(e);$("#slidesFromSelected").append(t),a(e),i(e)}),null!==e.genially&&null!==e.genially.SettingGenially.Weave&&$("#slidesFromTemplate").find(".sidebar-clone-slide").css("background-image","url("+e.genially.SettingGenially.Weave+")"),$("#loaderSlide").hide()},500),o.addClass("withTemplate"),o.find(".right-content").addClass("no-overflow"),d.hasClass("hideActions")&&d.removeClass("hideActions"),d.addClass("showActions")}function n(){$("#loaderSlide").hide(),SaveDisplay.showError()}var l="/api/Genially/TemplateSlides",r={idTemplate:e};$("#slidesFromSelected").html(""),$("#loaderSlide").show(),ApiGenially.executeCall(r,l,"GET",t,n)}function r(e,t){function n(e){C=!0,setTimeout(function(){e.slides.forEach(function(e){var t=Genially.templates.slidesof(e);$("#slidesFromSelected").append(t),a(e),i(e)}),null!==e.genially&&null!==e.genially.SettingGenially.Weave&&$("#slidesFromTemplate").find(".sidebar-clone-slide").css("background-image","url("+e.genially.SettingGenially.Weave+")"),$("#loaderSlide").hide()},500),o.addClass("withTemplate"),o.find(".right-content").addClass("no-overflow"),d.hasClass("hideActions")&&d.removeClass("hideActions"),d.addClass("showActions")}function l(){$("#loaderSlide").hide(),SaveDisplay.showError()}var r="/api/Genially/GeniallySlides",s={idGenially:e,purchase:t};$("#loaderSlide").show(),$("#slidesFromSelected").html(""),ApiGenially.executeCall(s,r,"GET",n,l)}var o=$("#geniallySlides"),s=o.find(".createNewSlide-btn"),d=$("#slidesFromTemplate"),c=d.find("#newBlankSlide");s.click(e),c.on("click",t),$("#displaySlidesFrom").on("changed.bs.select",function(e){var t=$(".display-slides-from option:selected").val(),a=$(".display-slides-from option:selected").attr("data-template"),n=$(".display-slides-from option:selected").attr("data-purchase");"yes"===a?l(t):"yes"===n?r(t,!0):r(t,!1)})}function l(){function e(){var e=$(this).data("id");$("#slide-side-"+e).addClass("opacity-05").css("pointer-events","none"),Slide.newSlide(e)}$("#slidesFromTemplateContent").on("click",".create-slide-template",e)}function r(){function e(e){var t=$(e.target).val();Slide.renameSlide($(e.target).data("id"),t)}function t(){var e=$(this).data("id");$("#slide-side-"+e).addClass("opacity-05").css("pointer-events","none"),Slide.duplicateSlide($(this).data("id"))}function a(){var e=$(this).data("id");e!==currentData.IdSlide&&swal({title:locale.confirmDeleteSlideTitle,text:locale.confirmDeleteSlideDesc,type:"warning",showCancelButton:!0,confirmButtonColor:"#F44336",confirmButtonText:locale.generic.confirmDeleteButton,closeOnConfirm:!0},function(){Slide.deleteSlide(e)})}function n(){var e=this;c(e)}function i(e,t){var a=t.item.index()+1,n=t.item.data("id");Slide.updateOrder(a,n)}var l=$("#slidesContent");l.on("click",".duplicate-slide",t),l.on("click",".delete-slide",a),l.on("click",".slide-preview",n);var r=_.debounce(e,500);$(document).on("keyup",".slide-title input",function(e){r(e)});var o=$(".new-slide-holder");$("#slidesContent").sortable({placeholder:"state-highlight",scrollSensitivity:40,tolerance:"pointer",scrollSpeed:20,start:function(e,t){o.hide()},stop:function(e,t){i(e,t),o.show()}})}function o(){function e(e){var t=removeDiacritics(dataGenially.Name).toLowerCase();return"untitled genially"===t||"genially sin titulo"===t||"genially sans titre"===t?(e.preventDefault(),I="share",u()):void Share.shareGenially(currentData.IdGenially)}Share.init();var t=$("#shareGenially");t.click(e)}function s(){function e(e){Canva.hideSlideSideBar(),Canva.hideSettings(),SecondaryActions.forceHide(),e.preventDefault();var t=$("#editorBody").find("#moreOptions");$(this).hasClass("active")?($(this).removeClass("active"),t.removeClass("showOptions")):($(this).addClass("active"),t.addClass("showOptions"))}var t=$("#showMoreOptions");t.on("click",e)}function d(){function e(e,t){e.Width=e.Width.replace("px",""),e.Height=e.Height.replace("px",""),e.PaddingBottom=(e.Height/e.Width*100).toFixed(2);var a=Genially.templates.preview(e),n=$("#idUser").val();"59e059d30b9c21060cb4c2ec"!==n&&"594783e58f76b98940367944"!==n&&"5a58ab96bfbfc70f6eb4d2c0"!==n&&"5a780d35518eb417b078e19e"!==n&&"5a780ed9b842e801ccc9f68a"!==n&&"587120f5cbb6bf5dc8442cd6"!==n||(a=a.replace("view.genial.ly","preview.genial.ly")),setTimeout(function(){b.children(".content").html("").append(a),$("#quick-preview").find(".content").addClass(t)},1e3)}function t(){function t(t){var a=($(window).width(),$(window).height()),n=$("#widthSlide").val(),i=$("#heightSlide").val();if(n=parseInt(n),i=parseInt(i),n>=i||i<=1440){var l=a-50,r=n*l/i;b.children(".content").css({width:r}),e(t,"horizontal")}else e(t,"vertical")}var a=removeDiacritics(dataGenially.Name).toLowerCase();if("untitled genially"===a||"genially sin titulo"===a||"genially sans titre"===a)return I="preview",u();b.children(".content").html("");var n=$("#widthSlide").val(),i=$("#heightSlide").val(),l={Id:currentData.IdGenially,Width:n,Height:i,IdSlide:currentData.IdSlide};t(l),b.children(".content").removeClass("vertical"),b.removeClass("horizontal"),b.addClass("open")}b.click(function(e){$(e.target).hasClass("content")||b.removeClass("open")}),$("#viewGenially").click(t)}function c(t){$("#backgroundTypes").find("#basicColors").find(".block-color").removeClass("selected");var a=$("html");(a.hasClass("multidrag")||a.hasClass("multidragging"))&&(a.removeClass("multidrag multidragging"),$(".multidrag-element").removeClass("multidrag-element"),$(".multidrag-selector").remove(),currentData.IdItem=null,Toolbar.hideAll(),Multidrag.clearElements()),$("html").hasClass("editing-text")&&Text.finishEditingText(),$("#addNewColor").spectrum("hide"),Canva.unselectItem(),$(".current-slide").removeClass("current-slide"),$(".current-slide-sidebar").removeClass("current-slide-sidebar"),$(".slide-actions").find("i.delete-slide").show();var n=$(t).data("id");ZoomGenially.resetAllZoom(n);var i=$("#slideHolder-"+n);$(t).addClass("current-slide-sidebar"),$(t).siblings("div.slide-actions").find("i.delete-slide").hide(),i.addClass("current-slide"),fitJs[n].trigger(),currentData.IdSlide=n,Editor.loadCurrentScale(),e(n),ZIndex.getCurrentValuesZIndex(),TransitionSlides.loadCurrentTransition(),Settings.loadCurrentSize(),window.location.hash="page-"+n,DesignLayers.processLayers(),Canva.checkBackground();var l=$("#"+currentData.IdSlide).find(".content-draggable");l.each(function(){var e=$(this),t=$(this).find("iframe");t.length>0&&t.css("height",e.css("height"))})}function u(){v.modal("show")}function p(){v.modal("hide")}function g(){var e=removeDiacritics(y.val()).toLowerCase();""!==e&&"untitled genially"!==e&&"genially sin titulo"!==e&&"genially sans titre"!==e&&(Setting.updateName(y.val()),$("#geniallyTitle").find("#inputGeniallyTitle").val(y.val()),dataGenially.Name=y.val(),p(),"preview"===I?setTimeout(function(){$("#viewGenially").click()},200):"exit"===I?setTimeout(function(){location.href="https://www.genial.ly"},200):"share"===I?setTimeout(function(){$("#shareGenially").click()},200):setTimeout(function(){location.href="/Export/Index/"+currentData.IdGenially},200))}function f(e){var t=removeDiacritics(dataGenially.Name).toLowerCase();if("untitled genially"===t||"genially sin titulo"===t||"genially sans titre"===t)return e.preventDefault(),I="exit",u()}function m(){var e=$(".logotype-editor"),t=$(document.getElementById("close-ask-for-name")),a=$(document.getElementById("setGeniallyName"));e.click(f),t.click(p),a.click(g)}function h(){d(),r(),i(),n(),t(),l(),o(),s(),m(),Settings.start(),document.getElementById("the-name").onkeypress=function(e){e||(e=window.event);var t=e.keyCode||e.which;13===t&&g()}}var v=$(document.getElementById("askForName")),y=$(document.getElementById("the-name")),I=null,b=$("#quick-preview"),C=!1;return{attachEvents:h,loadCurrentBackground:e,hideSlidesFromTemplate:a,goToSlide:c,askForName:u,closeAskForName:p,changeName:g}}(),Toolbar=function(){var e=$("html"),t=function(){e.removeClass("tb-general tb-text tb-image tb-svg tb-pin tb-area tb-background")},a=function(){ToolbarPermanent.init(),ToolbarGeneral.init(),ToolbarImage.init(),ToolbarText.init(),ToolbarArea.init(),ToolbarPin.init(),ToolbarSVG.init(),ToolbarBackground.init()};return{init:a,hideAll:t}}(),Realign=function(){function e(){return arguments[0]instanceof Array&&(arguments=arguments[0]),Math.min.apply(Math,arguments)}function t(){return arguments[0]instanceof Array&&(arguments=arguments[0]),Math.max.apply(Math,arguments)}function a(e,t){return e.left<t.left?-1:e.left>t.left?1:0}function n(e,t){return e.top<t.top?-1:e.top>t.top?1:0}var i=$(".realign"),l=[],r=[],o=[],s=[],d=[],c=[],u=function(e){var t=[];e.each(function(){t.push({IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:$(this).attr("id"),TypeItem:$(this).attr("data-type"),Position:{PositionLeft:parseFloat($(this).attr("data-x")),PositionTop:parseFloat($(this).attr("data-y"))}})}),Multidrag.savePositioning(t)},p=function(e,t){"before"===t?(d=[],e.each(function(){var e={idItem:$(this).attr("id"),typeContent:$(this).attr("data-type"),typeOperation:"UpdatePosition",width:$(this).css("width"),height:$(this).css("height"),top:$(this).css("top"),left:$(this).css("left"),angle:Canva.getRotationStyle($(this)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(this).attr("data-x"),dataY:$(this).attr("data-y")};d.push(e)})):(c=[],e.each(function(){var e={idItem:$(this).attr("id"),typeContent:$(this).attr("data-type"),typeOperation:"UpdatePosition",width:$(this).css("width"),height:$(this).css("height"),top:$(this).css("top"),left:$(this).css("left"),angle:Canva.getRotationStyle($(this)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(this).attr("data-x"),dataY:$(this).attr("data-y")};c.push(e)}))},g=function(e,t){e.each(function(){$(this).attr("data-x",t.smallestX),$(this).css({left:t.smallestX})}),p(e,"after"),UndoRedo.createElement(d,c),u(e)},f=function(e,t){e.each(function(){var e=t.largestX-$(this).width();$(this).attr("data-x",e),$(this).css({left:e})}),p(e,"after"),UndoRedo.createElement(d,c),u(e)},m=function(e,t){e.each(function(){$(this).attr("data-y",t.smallestY),$(this).css({top:t.smallestY})}),p(e,"after"),UndoRedo.createElement(d,c),u(e)},h=function(e,t){e.each(function(){var e=t.largestY-$(this).height();$(this).attr("data-y",e),$(this).css({top:e})}),p(e,"after"),UndoRedo.createElement(d,c),u(e)},v=function(e,t){e.each(function(){var e=t.centerX-$(this).width()/2;$(this).css({left:e}),$(this).attr("data-x",e)}),p(e,"after"),UndoRedo.createElement(d,c),u(e)},y=function(e,t){e.each(function(){var e=t.centerY-$(this).height()/2;$(this).attr("data-y",e),$(this).css({top:e})}),p(e,"after"),UndoRedo.createElement(d,c),u(e)},I=function(e,t){var n=0,i=0,l=0,r=[];e.each(function(){n+=$(this).width();var e={id:$(this).attr("id"),left:parseInt($(this).css("left").replace("px",""))};r.push(e)}),i=t.width-n,l=i/(e.length-1),r.sort(a),r.forEach(function(e,t){if(0!==t&&t!==r.length-1){var a=$("#"+e.id),n=$("#"+r[t-1].id),i=parseInt(n.css("left").replace("px",""))+n.width()+l;a.css("left",i),a.attr("data-x",i)}}),p(e,"after"),UndoRedo.createElement(d,c),u(e)},b=function(e,t){var a=0,i=0,l=0,r=[];e.each(function(){a+=$(this).height();var e={id:$(this).attr("id"),top:parseInt($(this).css("top").replace("px",""))};r.push(e)}),i=t.height-a,l=i/(e.length-1),r.sort(n),r.forEach(function(e,t){if(0!==t&&t!==r.length-1){var a=$("#"+e.id),n=$("#"+r[t-1].id),i=parseInt(n.css("top").replace("px",""))+n.height()+l;a.css("top",i),a.attr("data-y",i)}}),p(e,"after"),UndoRedo.createElement(d,c),u(e)},C=function(e,t,a){switch(p(e,"before"),t){case"left":g(e,a);break;case"right":f(e,a);break;case"top":m(e,a);break;case"bottom":h(e,a);break;case"center":v(e,a);break;case"middle":y(e,a);break;case"dist-x":I(e,a);break;case"dist-y":b(e,a)}},x=function(){var a=$("#"+currentData.IdSlide),n=$(this).data("operation");l=[],r=[],o=[],s=[];var i=a.find(".multidrag-element:not(.pin-element)");i.each(function(){var e=parseInt($(this).css("left").replace("px","")),t=parseInt($(this).css("top").replace("px",""));l.push(e),r.push(t),o.push(e+$(this).width()),s.push(t+$(this).height())});var d=e(l),c=t(o),u=e(r),p=t(s),g=d+(c-d)/2,f=u+(p-u)/2,m=c-d,h=p-u,v=d,y=u,I={smallestX:d,largestX:c,smallestY:u,largestY:p,centerX:g,centerY:f,width:m,height:h};$("#multi-helper").remove();var b=document.createElement("div");b.id="multi-helper",a.append(b);var x=$("#multi-helper");x.css({display:"none","pointer-events":"none",width:m,height:h,left:v,top:y,position:"absolute"}),C(i,n,I)},S=function(){i.click(x)};return{start:S}}(),ToolbarPermanent=function(){var e,t,a,n,i=$("#tb-permanent"),l=function(e){UndoRedo.undoManager.undo()},r=function(e){UndoRedo.undoManager.redo()},o=function(e){(null!==currentData.IdItem||Multidrag.countElements()>0)&&swal({title:locale["delete"].titleConfirmDelete,text:locale["delete"].textConfirmDelete,type:"warning",showCancelButton:!0,confirmButtonColor:"#bc2360",confirmButtonText:locale["delete"].confirmButtonText,cancelButtonText:locale.generic.cancelButtonText,closeOnConfirm:!0},function(e){e&&(Multidrag.countElements()>0?Delete.removeMultiItems():Delete.removeItem(currentData.IdItem))}),"background"===currentData.TypeItem&&$("#resetBackground").click()},s=function(e){$("html");if(null!==currentData.TypeItem||null!==currentData.IdItem||0!==Multidrag.countElements()){if("background"===currentData.TypeItem){var t=$("#"+currentData.IdSlide).find(".current-background-slide");return void(t.hasClass("blocked")?(Block.unBlockDiv(),n.children("i").removeClass("zmdi-lock-outline").addClass("zmdi-lock-open")):(Block.blockDiv(),n.children("i").removeClass("zmdi-lock-open").addClass("zmdi-lock-outline")))}if(Multidrag.countElements()>0){for(var a=0;a<Multidrag.countElements();a++)if(!$(Multidrag.multiElements[a]).hasClass("pin-draggable"))if($(Multidrag.multiElements[a]).hasClass("blocked"))DesignLayers.lockLayer($(Multidrag.multiElements[a]).attr("id"),!1),$(Multidrag.multiElements[a]).removeClass("blocked"),$(Multidrag.multiElements[a]).hasClass("pin-element")?$(Multidrag.multiElements[a]).addClass("pin-draggable"):$(Multidrag.multiElements[a]).addClass("element-draggable");else if(DesignLayers.lockLayer($(Multidrag.multiElements[a]).attr("id"),!0),$(Multidrag.multiElements[a]).addClass("blocked"),$(Multidrag.multiElements[a]).hasClass("pin-element"))$(Multidrag.multiElements[a]).removeClass("pin-draggable");else{$(Multidrag.multiElements[a]).removeClass("element-draggable");var i="/api/"+$(Multidrag.multiElements[a]).data("type")+"/UpdateBlocked",l={Id:$(Multidrag.multiElements[a]).attr("id"),IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Blocked:!0};ApiGenially.executeCall(l,i,"PUT")}}else{var r=$("#"+currentData.IdItem);r.hasClass("blocked")?(DesignLayers.lockLayer(currentData.IdItem,!1),Block.unBlockDiv(),n.children("i").removeClass("zmdi-lock-outline").addClass("zmdi-lock-open")):(DesignLayers.lockLayer(currentData.IdItem,!0),Block.blockDiv(),n.children("i").removeClass("zmdi-lock-open").addClass("zmdi-lock-outline"))}}},d=function(){var e=localStorage.getItem("copyValue"),t=localStorage.getItem("typeCopy");return"null"!==e&&""!==e||"null"!==t&&""!==t},c=function(){e=i.find("#permanentUndo"),t=i.find("#permanentRedo"),a=i.find("#permanentDelete"),n=i.find("#permanentLock"),e.on("click",l),t.on("click",r),a.on("click",o),n.on("click",s)},u=function(){c()};return{init:u,checkPasteStorage:d}}(),ToolbarImage=function(){var e,t,a,n,i,l,r=$("html"),o=$("#tb-image"),s="/api/image/",d={},c=[],u=function(e){function t(e){$("#"+e).find("img").attr("data-title",a)}var a=$("#imageTitle").val();if("undefined"!=typeof a){var n={Name:a,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:e},i=s+"UpdateName";ApiGenially.executeCall(n,i,"PUT",t)}},p=function(e){e.preventDefault&&e.preventDefault();var a=parseInt(t[0].noUiSlider.get().split("%")[0],10)/100;if(0===Multidrag.countElements()){$("#"+currentData.IdItem).find("img").css({opacity:a});var n={Id:currentData.IdItem,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially,Opacity:a};$("#fake-"+n.Id).css({opacity:a});var i=s+"UpdateOpacity";ApiGenially.executeCall(n,i,"PUT")}else $.each(Multidrag.multiElements,function(e,t){var n=t.attr("id");$("#"+n).find("img").css({opacity:a});var i={Id:n,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially,Opacity:a};$("#fake-"+i.Id).css({opacity:a});var l=s+"UpdateOpacity";ApiGenially.executeCall(i,l,"PUT")})},g=function(e){var t=$(this).data("effect");if(0===Multidrag.countElements()){var a=$("#"+currentData.IdItem).find("img");a.classes(function(e){(e.indexOf("img-")>=0||e.indexOf("shadow-")>=0||e.indexOf("clipping-")>=0||e.indexOf("effect")>=0||e.indexOf("perspective-skew")>=0)&&a.removeClass(e)}),a.addClass(t);var n=$("#fake-"+currentData.IdItem).find("img");n.classes(function(e){(e.indexOf("img-")>=0||e.indexOf("shadow-")>=0||e.indexOf("clipping-")>=0||e.indexOf("effect")>=0||e.indexOf("perspective-skew")>=0)&&n.removeClass(e)}),n.addClass(t);var i=s+"UpdateFrame",l={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:currentData.IdItem,Frame:t},r={typeContent:"image",typeOperation:"ImageEffect",IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,idItem:currentData.IdItem,Frame:t};UndoRedo.createElement(d,r),ApiGenially.executeCall(l,i,"PUT")}else{var o=[];$.each(Multidrag.multiElements,function(e,a){var n=a.attr("id"),i=$("#"+n).find("img");i.classes(function(e){(e.indexOf("img-")>=0||e.indexOf("shadow-")>=0||e.indexOf("clipping-")>=0||e.indexOf("effect")>=0||e.indexOf("perspective-skew")>=0)&&i.removeClass(e)}),i.addClass(t);var l=$("#fake-"+n).find("img");l.classes(function(e){(e.indexOf("img-")>=0||e.indexOf("shadow-")>=0||e.indexOf("clipping-")>=0||e.indexOf("effect")>=0||e.indexOf("perspective-skew")>=0)&&l.removeClass(e)}),l.addClass(t);var r=s+"UpdateFrame",d={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:n,Frame:t};o.push({typeContent:"image",typeOperation:"ImageEffect",IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,idItem:n,Frame:t}),ApiGenially.executeCall(d,r,"PUT")}),UndoRedo.createElement(c,o)}},f=function(e){CropImage.showCropper(1)},m=function(e){var t=currentData.IdItem,a=$("#"+t),n=a.find("img");if(this.files&&this.files[0]){var i=new FileReader,l=this.files[0];if(!l.type.match("image.*")||l.type.match("image.bmp"))return;var r=l.size;if(r>5242880)return void swal({title:locale.image.titleImageTooBig,text:locale.image.textImageTooBigSome,type:"info",confirmButtonColor:"#bc2360",confirmButtonText:locale.image.confirmButtonText,closeOnConfirm:!0});i.onload=function(e){var t=n.attr("src");n.attr("img-original-replace",t),n.attr("img-original",e.target.result),$("#imageReplaceProxy").click(),CropImage.showCropper(2)},i.readAsDataURL(this.files[0])}},h=function(e){if(e.preventDefault(),0===Multidrag.countElements()){var t=$("#"+currentData.IdItem),a=t.find("img");d={},d={typeContent:"image",typeOperation:"ImageEffect",IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,idItem:currentData.IdItem,Frame:a.attr("class")};var n=$(this).attr("data-effect");a.removeClass(function(e,t){return(t.match(/(^|\s)clipping-\S+/g)||[]).join(" ")}),a.removeClass(function(e,t){return(t.match(/(^|\s)shadow-\S+/g)||[]).join(" ")}),a.removeClass(function(e,t){return(t.match(/(^|\s)polaroid-\S+/g)||[]).join(" ")}),a.removeClass(function(e,t){return(t.match(/(^|\s)radius-\S+/g)||[]).join(" ")}),"none"!==n&&a.addClass(n)}else c=[],$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id"),n=$("#"+a),i=n.find("img");c.push({typeContent:"image",typeOperation:"ImageEffect",IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,idItem:a,Frame:i.attr("class")});var l=$(this).attr("data-effect");i.removeClass(function(e,t){return(t.match(/(^|\s)clipping-\S+/g)||[]).join(" ")}),i.removeClass(function(e,t){return(t.match(/(^|\s)shadow-\S+/g)||[]).join(" ")}),i.removeClass(function(e,t){return(t.match(/(^|\s)polaroid-\S+/g)||[]).join(" ")}),i.removeClass(function(e,t){return(t.match(/(^|\s)radius-\S+/g)||[]).join(" ")}),"none"!==l&&i.addClass(l)})},v=function(){e=o.find("#imageTitle"),t=$("#imageOpacity"),a=o.find("#imageCrop"),n=o.find("#fileReplace"),i=o.find(".imgEffect"),l=o.find(".image-demo-effect"),l.click(h),noUiSlider.create(t[0],{start:100,step:5,range:{min:5,max:100},tooltips:!0,format:wNumb({decimals:0,postfix:"%"})});var r=_.debounce(u,500);e.on("keyup",function(){var e=currentData.IdItem;r(e)}),t[0].noUiSlider.on("change",p),a.on("click",f),i.on("click",g),n.on("change",m),$("#imageCrop, #imageReplaceProxy").animatedModal({color:"#079DAC",animatedIn:"fadeInUp",animatedOut:"fadeOutDown",modalTarget:"cropImage"})},y=function(){if(0===Multidrag.countElements()){if($("#tb-permanent").find("#permanentLock").prop("disabled",!1),$("#tb-permanent").find("#permanentCopy").prop("disabled",!1),$("#tb-general").find("#generalZIndex").prop("disabled",!1),$("#tb-general").find("#generalPosition").prop("disabled",!1),"image"===currentData.TypeItem){var n=$("#"+currentData.IdItem);t[0].noUiSlider.set(100*n.find("img").css("opacity"));var i=n.find("img").attr("data-title"),l=$("#imageTitle"),o=n.find("img").attr("src").split(".").pop();0===Multidrag.countElements()&&("svg"===o||"gif"===o?a.parent().css({"pointer-events":"none",opacity:.5}):a.parent().css({"pointer-events":"all",opacity:1})),""!==i?(l.val(i),e.parent().addClass("fg-toggled")):(e.parent().removeClass("fg-toggled"),l.val(""));$(n).find("img").attr("src")}}else $("#tb-permanent").find("#permanentLock").prop("disabled",!1),$("#tb-permanent").find("#permanentCopy").prop("disabled",!1),$("#tb-general").find("#generalZIndex").prop("disabled",!0),$("#tb-general").find("#generalPosition").prop("disabled",!0),Multidrag.allSame("image")||r.removeClass("tb-image")},I=function(){v()};return{init:I,changeDynamicElements:y}}(),ToolbarSVG=function(){var e,t,a,n,i=$("#tb-svg"),l=$("#tb-general"),r=$("html"),o="/api/svg/",s=$("#svg-colorpicker-1"),d=$("#svg-colorpicker-2"),c=$("#svg-colorpicker-3"),u={
startColor:null,endColor:null},p=function(e){function t(e){$("#"+e).find(".wrapper-svg").attr("data-title",a)}var a=$("#svgTitle").val();if("undefined"!=typeof a){var n={Name:a,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:e},i=o+"UpdateName";ApiGenially.executeCall(n,i,"PUT",t)}},g=function(e,t){function a(e){if(e.startsWith("#"))return e;var t=e.split("(")[1].split(")")[0];t=t.split(",");var a=t.map(function(e){return e=parseInt(e).toString(16),1===e.length?"0"+e:e});return a="#"+a.join("")}var n=$(t).data("color"),i=o+"UpdateColor",l=o+"UpdateColorMulti";if(0===Multidrag.countElements()){if(null===currentData.IdItem)return;var r=$("#"+currentData.IdItem).find(".color"+n).css("fill");r=a(r);var s={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdateColor",whichColor:parseInt(n),previousColor:r,idSlide:currentData.IdSlide};if(u.startColor=s,r===e.toHexString())return;$("#"+currentData.IdItem).find(".color"+n).css("fill",e.toHexString()),$("#"+currentData.IdItem).attr("data-color-"+n,e.toHexString());var d={Id:currentData.IdItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Color:e.toHexString(),WhichColor:parseInt(n)},c={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"UpdateColor",whichColor:parseInt(n),previousColor:e.toHexString(),idSlide:currentData.IdSlide};u.endColor=c,$("#fake-"+d.Id).find(".color"+n).css("fill",e.toHexString()),$("#fake-"+d.Id).attr("data-color-"+n,e.toHexString()),ApiGenially.executeCall(d,i,"PUT"),UndoRedo.createElement(s,c)}else{var p=[],g=[],f=[];$.each(Multidrag.multiElements,function(t,i){if("svg"===$(i).attr("data-type")){var l=$(i).find(".color"+n).css("fill");l=a(l);var r={idItem:$(i).attr("id"),typeContent:$(i).attr("data-type"),typeOperation:"UpdateColor",whichColor:parseInt(n),previousColor:l,idSlide:currentData.IdSlide};if(g.push(r),l===e.toHexString())return;$(i).find(".color"+n).css("fill",e.toHexString()),$(i).attr("data-color-"+n,e.toHexString());var o={Id:$(i).attr("id"),IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Color:e.toHexString(),WhichColor:parseInt(n)},s={idItem:$(i).attr("id"),typeContent:$(i).attr("data-type"),typeOperation:"UpdateColor",whichColor:parseInt(n),previousColor:e.toHexString(),idSlide:currentData.IdSlide};f.push(s),$("#fake-"+o.Id).find(".color"+n).css("fill",e.toHexString()),p.push(o)}}),ApiGenially.executeCall(p,l,"PUT"),UndoRedo.createElement(g,f)}},f=function(e){var t=$(this).data("effect"),a=$("#"+currentData.IdItem).find(".wrapper-svg ");a.classes(function(e){(e.indexOf("img-")>=0||e.indexOf("shadow-")>=0||e.indexOf("clipping-")>=0||e.indexOf("effect")>=0||e.indexOf("perspective-skew")>=0)&&a.removeClass(e)}),a.addClass(t);var n=$("#fake-"+currentData.IdItem).find(".wrapper-svg ");n.classes(function(e){(e.indexOf("img-")>=0||e.indexOf("shadow-")>=0||e.indexOf("clipping-")>=0||e.indexOf("effect")>=0||e.indexOf("perspective-skew")>=0)&&n.removeClass(e)});var i=o+"UpdateFrame",l={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:currentData.IdItem,Frame:t};ApiGenially.executeCall(l,i,"PUT")},m=function(e){e.preventDefault&&e.preventDefault();var t=parseInt(a[0].noUiSlider.get().split("%")[0],10)/100;if(0===Multidrag.countElements()){$("#"+currentData.IdItem).find(".wrapper-svg").css({opacity:t});var n={Id:currentData.IdItem,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially,Opacity:t};$("#fake-"+currentData.IdItem).find(".wrapper-svg").css({opacity:t});var i=o+"UpdateOpacity";ApiGenially.executeCall(n,i,"PUT")}else $.each(Multidrag.multiElements,function(e,a){var n=a.attr("id");$("#"+n).find(".wrapper-svg").css({opacity:t});var i={Id:n,IdSlide:currentData.IdSlide,IdGenially:currentData.IdGenially,Opacity:t};$("#fake-"+n).find(".wrapper-svg").css({opacity:t});var l=o+"UpdateOpacity";ApiGenially.executeCall(i,l,"PUT")})},h=function(){s.spectrum("hide"),d.spectrum("hide"),c.spectrum("hide")},v=function(){i.find(".dropdown").removeClass("open"),l.find(".dropdown").removeClass("open")},y=function(){s.spectrum("destroy"),s.spectrum({containerClassName:"spectrumGenially",preferredFormat:"hex6",showInput:!0,showPalette:!0,chooseText:locale.spectrum.choose,cancelText:locale.spectrum.cancel,localStorageKey:"spectrum.genially"+$("#idGenially").val(),palette:CustomColors.getCustomColors(),change:function(e){s.spectrum("set",e),g(e,this)},hide:function(e){return!1},show:function(e){s.spectrum("set",$("#"+currentData.IdItem).attr("data-color-1")),v()}}),d.spectrum("destroy"),d.spectrum({containerClassName:"spectrumGenially",preferredFormat:"hex6",showInput:!0,showPalette:!0,chooseText:locale.spectrum.choose,cancelText:locale.spectrum.cancel,localStorageKey:"spectrum.genially"+$("#idGenially").val(),palette:CustomColors.getCustomColors(),change:function(e){g(e,this)},hide:function(e){return!1},show:function(e){d.spectrum("set",$("#"+currentData.IdItem).attr("data-color-2")),v()}}),c.spectrum("destroy"),c.spectrum({containerClassName:"spectrumGenially",preferredFormat:"hex6",showInput:!0,showPalette:!0,chooseText:locale.spectrum.choose,cancelText:locale.spectrum.cancel,localStorageKey:"spectrum.genially"+$("#idGenially").val(),palette:CustomColors.getCustomColors(),change:function(e){g(e,this)},hide:function(e){return!1},show:function(e){c.spectrum("set",$("#"+currentData.IdItem).attr("data-color-3")),v()}})},I=function(){e=i.find("#svgTitle"),t=i.find(".svgEffect"),n=i.find("button"),a=$("#svgOpacity"),noUiSlider.create(a[0],{start:100,step:5,range:{min:5,max:100},tooltips:!0,format:wNumb({decimals:0,postfix:"%"})}),n.click(h),y(),t.on("click",f),a[0].noUiSlider.on("change",m);var l=_.debounce(p,500);e.on("keyup",function(){var e=currentData.IdItem;l(e)})},b=function(){if(0===Multidrag.countElements()){$("#tb-permanent").find("#permanentLock").prop("disabled",!1),$("#tb-permanent").find("#permanentCopy").prop("disabled",!1),$("#tb-general").find("#generalZIndex").prop("disabled",!1),$("#tb-general").find("#generalPosition").prop("disabled",!1);var t=$("#"+currentData.IdItem);switch(t.data("num-color")){case 1:s.spectrum("set",t.attr("data-color-1")),d.spectrum("disable"),c.spectrum("disable");break;case 2:s.spectrum("set",t.attr("data-color-1")),d.spectrum("set",t.attr("data-color-2")),c.spectrum("disable");break;case 3:s.spectrum("set",t.attr("data-color-1")),d.spectrum("set",t.attr("data-color-2")),c.spectrum("set",t.attr("data-color-3"))}var n=t.find(".wrapper-svg").attr("data-title"),i=$("#svgTitle");""!==n?(i.val(n),e.parent().addClass("fg-toggled")):(e.parent().removeClass("fg-toggled"),i.val("")),a[0].noUiSlider.set(100*t.find(".wrapper-svg ").css("opacity"))}else if($("#tb-permanent").find("#permanentLock").prop("disabled",!1),$("#tb-permanent").find("#permanentCopy").prop("disabled",!1),$("#tb-general").find("#generalZIndex").prop("disabled",!0),$("#tb-general").find("#generalPosition").prop("disabled",!0),Multidrag.allSame("svg")){var l=!0,o=1;if($.each(Multidrag.multiElements,function(e,t){if(l)if(0!==e)o=parseInt($(t).data("num-color"),10);else if(o!==parseInt($(t).data("num-color"),10))return void(l=!1)}),l)switch(o){case 1:var u=Multidrag.multiElements[0].attr("data-color-1");s.spectrum("set",u),d.spectrum("disable"),c.spectrum("disable");break;case 2:s.spectrum("set","#000000"),d.spectrum("set","#000000"),c.spectrum("disable");break;case 3:s.spectrum("set","#000000"),d.spectrum("set","#000000"),c.spectrum("set","#000000")}}else r.removeClass("tb-svg")},C=function(){I()};return{init:C,changeDynamicElements:b}}(),ToolbarPin=function(){var e,t=$("#tb-pin"),a="/api/Pin/UpdateName",n=function(t){function n(e){$("#"+e).attr("data-title",l)}function i(e){SaveDisplay.showError()}var l=e.val();if("undefined"!=typeof l){var r={Id:t,Name:l,IdGenially:currentData.IdGenially};ApiGenially.executeCall(r,a,"PUT",n,i)}},i=function(){$("#tb-permanent").find("#permanentLock").prop("disabled",!0),$("#tb-permanent").find("#permanentCopy").prop("disabled",!1),$("#tb-general").find("#generalZIndex").prop("disabled",!0),$("#tb-general").find("#generalPosition").prop("disabled",!0);var t=$("#"+currentData.IdItem).attr("data-title");"undefined"==typeof t&&(t=""),""!==t?(e.val(t),e.parent(".fg-line").addClass("fg-toggled")):(e.val(""),e.parent(".fg-line").removeClass("fg-toggled"))},l=function(){e=t.find("#pinTitle");var a=_.debounce(n,500);e.on("keyup",function(){var e=currentData.IdItem;a(e)})},r=function(){l()};return{init:r,changeDynamicElements:i}}(),ToolbarArea=function(){var e,t=$("#tb-area"),a="/api/Area/UpdateName",n=function(t){function n(e){$("#"+e).attr("data-title",l)}function i(e){SaveDisplay.showError()}var l=e.val();if("undefined"!=typeof l){var r={Id:t,Name:l,IdGenially:currentData.IdGenially};ApiGenially.executeCall(r,a,"PUT",n,i)}},i=function(){$("#tb-permanent").find("#permanentCopy").prop("disabled",!1),$("#tb-permanent").find("#permanentLock").prop("disabled",!1);var t=$("#"+currentData.IdItem).attr("data-title");"undefined"==typeof t&&(t=""),""!==t?(e.val(t),e.parent(".fg-line").addClass("fg-toggled")):(e.val(""),e.parent(".fg-line").removeClass("fg-toggled"))},l=function(){e=t.find("#areaTitle");var a=_.debounce(n,500);e.on("keyup",function(){var e=currentData.IdItem;a(e)})},r=function(){l()};return{init:r,changeDynamicElements:i}}(),ToolbarText=function(){function e(e){if("undefined"!=typeof e&&(R=e),0===Multidrag.countElements()){var t=$("#"+currentData.IdItem),a={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontFamily",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.find(".text-div").css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""},n=t.attr("class").split(" "),i=["text-align-left","text-align-right","text-align-center","text-align-justify"];if($.each(n,function(e,t){i.indexOf(t)!==-1&&a.Classes.push(t)}),$("#"+currentData.IdItem).css("font-family",'"'+R+'"'),$("#"+currentData.IdItem).css("width",""),$("#"+currentData.IdItem).css("height",""),localStorage.setItem("font-family",R),null===currentData.IdItem)return;setTimeout(function(){$("html").hasClass("editing-text")||Canva.selectItem(currentData.IdItem);var e=$("#"+currentData.IdItem).height()+10+"px",t=$("#"+currentData.IdItem).width()+10+"px",n=$("#"+currentData.IdItem).css("left"),i=$("#"+currentData.IdItem).css("top");$("#"+currentData.IdItem).css("width",t);var l={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:currentData.IdItem,Size:{Width:t,Height:e},Position:{PositionLeft:n,PositionTop:i},FontFamily:R},r=Object.assign({},a);r.FontFamily=R,r.Size={Width:t,Height:e},r.Position={PositionLeft:n,PositionTop:i},UndoRedo.createElement(a,r),$("#fake-"+l.Id).css({width:l.Size.Width,height:l.Size.Height,left:l.Position.PositionLeft,top:l.Position.PositionTop,"font-family":l.FontFamily}),Canva.setPositionSelectorText(),ApiGenially.executeCall(l,T,"PUT")},350)}else{var l=[],r=[];$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id"),n={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontFamily",idItem:a,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.find(".text-div").css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""},i=t.attr("class").split(" "),r=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(i,function(e,t){r.indexOf(t)!==-1&&n.Classes.push(t)}),l.push(n)});var o=[];$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id");$("#"+a).css("font-family",R);var n=$("#"+a).height()+"px",i=$("#"+a).width()+"px",l=$("#"+a).css("left"),s=$("#"+a).css("top"),d={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:a,Size:{Width:i,Height:n},Position:{PositionLeft:l,PositionTop:s},FontFamily:$("#"+a).css("font-family")},c={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontFamily",idItem:a,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.find(".text-div").css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""};r.push(c),$("#fake-"+d.Id).css({width:d.Size.Width,height:d.Size.Height,left:d.Position.PositionLeft,top:d.Position.PositionTop,"font-family":d.FontFamily}),o.push(d)}),localStorage.setItem("font-family",R);var s="/api/Text/MultiUpdateFontFamily";ApiGenially.executeCall(o,s,"PUT"),UndoRedo.createElement(l,r)}}var t,a,n,i,l,r,o,s,d,c,u,p,g,f,m,h,v,y,I,b,C,x,S,w,k,D=$("#tb-text"),T="/api/Text/UpdateFontFamily",P="/api/Text/UpdateOpacity",E="/api/Text/UpdatePadding",G="/api/Text/UpdateShadowText",B="/api/Text/UpdateClass",M="/api/Text/UpdateFontSize",O="/api/Text/UpdateBackground",U=null,A=$("html"),R=null,z=function(e){Text.finishEditingText(),$(D).removeClass("floating").css({top:"",left:""})},F=function(t){function a(){}function n(){}if(""!==t.target.value&&"INPUT"!==t.target.nodeName){R=t.target.value;var i=[];i.push(R),i.push(R+"%3Abold"),WebFont.load({google:{families:i},loading:a,active:e,inactive:n})}},L=function(e){e.preventDefault();var t=1;if(38===e.keyCode?(t=parseInt(n.val(),10)+1,t>999&&(t=999),n.val(t)):40===e.keyCode&&(t=parseInt(n.val(),10)-1,t<1&&(t=1),n.val(t)),k.html(t),0===Multidrag.countElements()){var a=$("#"+currentData.IdItem),i={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontSize",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),TextMessage:a.find(".text-div").html(),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":""},l=a.attr("class").split(" "),r=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(l,function(e,t){r.indexOf(t)!==-1&&i.Classes.push(t)}),a.css({"font-size":n.val()+"px"});var o=a.height()+"px",s=a.width()+"px";k.html(n.val()),Canva.setPositionSelector(document.getElementById(currentData.IdItem));var d=a.css("left"),c=a.css("top"),u={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:currentData.IdItem,FontSize:n.val()+"px",Size:{Width:s,Height:o},Position:{PositionLeft:d,PositionTop:c}};$("#fake-"+u.Id).css({width:u.Size.Width,height:u.Size.Height,left:u.Position.PositionLeft,top:u.Position.PositionTop,"font-size":u.FontSize});var p=Object.assign({},i);p.Size={Width:a.css("width"),Height:a.css("height")},p.Position={PositionLeft:a.css("left"),PositionTop:a.css("top")},p.FontSize=a.css("font-size"),UndoRedo.createElement(i,p),$("html").hasClass("editing-text")||setTimeout(function(){Canva.setPositionSelector(document.getElementById(currentData.IdItem))},350),setTimeout(function(){Canva.setPositionSelectorText()},350),ApiGenially.executeCall(u,M,"PUT")}else{var g=[],f=[];$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id"),n={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontSize",idItem:a,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""},i=t.attr("class").split(" "),l=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(i,function(e,t){l.indexOf(t)!==-1&&n.Classes.push(t)}),g.push(n)});var m=[];$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id");t.css({"font-size":n.val()+"px"});var i=t.height()+"px",l=t.width()+"px",r=t.css("left"),o=t.css("top"),s={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:a,FontSize:n.val()+"px",Size:{Width:l,Height:i},Position:{PositionLeft:r,PositionTop:o}},d={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontSize",idItem:a,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""},c=t.attr("class").split(" "),u=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(c,function(e,t){u.indexOf(t)!==-1&&d.Classes.push(t)}),f.push(d),$("#fake-"+s.Id).css({width:s.Size.Width,height:s.Size.Height,left:s.Position.PositionLeft,top:s.Position.PositionTop,"font-size":s.FontSize}),m.push(s)});var h="/api/Text/MultiUpdateFontSize";ApiGenially.executeCall(m,h,"PUT"),UndoRedo.createElement(g,f)}},H=function(e){var t=$(this);if($(n).val(t.data("value")),e.preventDefault&&e.preventDefault(),0===Multidrag.countElements()){var a=$("#"+currentData.IdItem),i={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontSize",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),TextMessage:a.find(".text-div").html(),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":""},l=a.attr("class").split(" "),r=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(l,function(e,t){r.indexOf(t)!==-1&&i.Classes.push(t)});var o=$("#"+currentData.IdItem).height()+"px",s=$("#"+currentData.IdItem).width()+"px",d=$("#"+currentData.IdItem).css("left"),c=$("#"+currentData.IdItem).css("top"),u={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:currentData.IdItem,FontSize:t.data("value")+"px",Size:{Width:s,Height:o},Position:{PositionLeft:d,PositionTop:c}};$("#"+currentData.IdItem).css({"font-size":t.data("value")+"px"}),$(n).val(t.data("value")),$("#fake-"+u.Id).css({width:u.Size.Width,height:u.Size.Height,left:u.Position.PositionLeft,top:u.Position.PositionTop,"font-size":u.FontSize});var p=Object.assign({},i);p.Size={Width:a.css("width"),Height:a.css("height")},p.Position={PositionLeft:a.css("left"),PositionTop:a.css("top")},p.FontSize=a.css("font-size"),UndoRedo.createElement(i,p),$("html").hasClass("editing-text")||setTimeout(function(){Canva.selectItem(currentData.IdItem)},200),setTimeout(function(){Canva.setPositionSelectorText()},200),ApiGenially.executeCall(u,M,"PUT")}else{var g=[],f=[];$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id"),n={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontSize",idItem:a,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""},i=t.attr("class").split(" "),l=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(i,function(e,t){l.indexOf(t)!==-1&&n.Classes.push(t)}),g.push(n)});var m=[];$.each(Multidrag.multiElements,function(e,a){var n=a.attr("id");a.css({"font-size":t.data("value")+"px"});var i=a.height()+"px",l=a.width()+"px",r=a.css("left"),o=a.css("top"),s={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:n,FontSize:t.data("value")+"px",Size:{Width:l,Height:i},Position:{PositionLeft:r,PositionTop:o}},d={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateFontSize",idItem:n,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),TextMessage:a.find(".text-div").html(),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":""},c=a.attr("class").split(" "),u=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(c,function(e,t){u.indexOf(t)!==-1&&d.Classes.push(t)}),f.push(d),$("#fake-"+s.Id).css({width:s.Size.Width,height:s.Size.Height,left:s.Position.PositionLeft,top:s.Position.PositionTop,"font-size":s.FontSize}),m.push(s)});var h="/api/Text/MultiUpdateFontSize";ApiGenially.executeCall(m,h,"PUT"),UndoRedo.createElement(g,f)}},W=function(e){e.preventDefault&&e.preventDefault();var t=$(this);if(0===Multidrag.countElements()){var a=$("#"+currentData.IdItem),n={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateClass",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),TextMessage:a.find(".text-div").html(),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":""},i=a.attr("class").split(" "),l=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(i,function(e,t){l.indexOf(t)!==-1&&n.Classes.push(t)}),a.removeClass("text-align-left text-align-right text-align-center text-align-justify").addClass(t.data("value")),$("html").hasClass("editing-text")||Canva.selectItem(currentData.IdItem);var r=a.height()+"px",o=a.width()+"px",s=a.css("left"),d=a.css("top"),c={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:currentData.IdItem,Size:{Width:o,Height:r},Position:{PositionLeft:s,PositionTop:d},Classes:[]};c.Classes.push($(this).data("value"));var u=Object.assign({},n);u.Size={Width:o,Height:r},u.Position={PositionLeft:s,PositionTop:d},u.Classes=c.Classes,UndoRedo.createElement(n,u),$("#fake-"+c.Id).css({width:c.Size.Width,height:c.Size.Height,left:c.Position.PositionLeft,top:c.Position.PositionTop}).removeClass("text-align-left text-align-right text-align-center text-align-justify").addClass(t.data("value")),ApiGenially.executeCall(c,B,"PUT")}else{var p=[],g=[];$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id"),n={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateClass",idItem:a,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""},i=t.attr("class").split(" "),l=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(i,function(e,t){l.indexOf(t)!==-1&&n.Classes.push(t)}),p.push(n)});var f=[];$.each(Multidrag.multiElements,function(e,a){var n=a.attr("id");a.removeClass("text-align-left text-align-right text-align-center text-align-justify").addClass(t.data("value"));var i=a.height()+"px",l=a.width()+"px",r=a.css("left"),o=a.css("top"),s={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Id:n,Size:{Width:l,Height:i},Position:{PositionLeft:r,PositionTop:o},Classes:[]};s.Classes.push(t.data("value")),f.push(s);var d={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateClass",idItem:n,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),TextMessage:a.find(".text-div").html(),Classes:s.Classes,Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":""};g.push(d),$("#fake-"+s.Id).css({width:s.Size.Width,height:s.Size.Height,left:s.Position.PositionLeft,top:s.Position.PositionTop}).removeClass("text-align-left text-align-right text-align-center text-align-justify").addClass(t.data("value"))});var m="/api/Text/MultiUpdateClass";ApiGenially.executeCall(f,m,"PUT"),UndoRedo.createElement(p,g)}},j=function(e){if(0===Multidrag.countElements()){e.preventDefault&&e.preventDefault();var t=Text.getPreviousStateObject(document.getElementById(currentData.IdItem));range=saveSelection(),restoreSelection(range),document.execCommand("bold",!1,null);var a=Object.assign({},t),n=$("#"+a.idItem),i=n.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==i&&'<ul style="list-style-type:point;"></ul>'!==i||(n.find(".text-div").html("<br><br>"),i="<br><br>"),a.TextMessage=i,UndoRedo.createElement(t,a),$("html").hasClass("editing-text")||Text.saveTextWithoutFinish(currentData.IdItem)}else{var l=Text.getMultiPreviousStateObject(),r=[];$.each(Multidrag.multiElements,function(t,a){e.preventDefault();var n=a.find(".text-div");n.attr("contenteditable",!0);var i=document.createRange();i.selectNodeContents(n[0]);var l=window.getSelection();l.removeAllRanges(),l.addRange(i),document.execCommand("Bold",!1,null),l.removeAllRanges();var o={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateTextMessage",idItem:a.attr("id"),idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":"",TextMessage:n.html()},s=a.attr("class").split(" "),d=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(s,function(e,t){d.indexOf(t)!==-1&&o.Classes.push(t)}),r.push(o)}),Text.saveMultidragTextWithoutFinish(),UndoRedo.createElement(l,r)}},N=function(e){if(0===Multidrag.countElements()){e.preventDefault&&e.preventDefault();var t=Text.getPreviousStateObject(document.getElementById(currentData.IdItem));range=saveSelection(),restoreSelection(range),document.execCommand("italic",!1,null);var a=Object.assign({},t),n=$("#"+a.idItem),i=n.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==i&&'<ul style="list-style-type:point;"></ul>'!==i||(n.find(".text-div").html("<br><br>"),i="<br><br>"),a.TextMessage=i,UndoRedo.createElement(t,a),$("html").hasClass("editing-text")||Text.saveTextWithoutFinish(currentData.IdItem)}else{var l=Text.getMultiPreviousStateObject(),r=[];$.each(Multidrag.multiElements,function(t,a){e.preventDefault();var n=a.find(".text-div");n.attr("contenteditable",!0);var i=document.createRange();i.selectNodeContents(n[0]);var l=window.getSelection();l.removeAllRanges(),l.addRange(i),document.execCommand("italic",!1,null),l.removeAllRanges();var o={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateTextMessage",idItem:a.attr("id"),idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":"",TextMessage:n.html()},s=a.attr("class").split(" "),d=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(s,function(e,t){d.indexOf(t)!==-1&&o.Classes.push(t)}),r.push(o)}),Text.saveMultidragTextWithoutFinish(),UndoRedo.createElement(l,r)}},_=function(e){if(0===Multidrag.countElements()){e.preventDefault&&e.preventDefault();var t=Text.getPreviousStateObject(document.getElementById(currentData.IdItem));range=saveSelection(),restoreSelection(range),document.execCommand("underline",!1,null);var a=Object.assign({},t),n=$("#"+a.idItem),i=n.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==i&&'<ul style="list-style-type:point;"></ul>'!==i||(n.find(".text-div").html("<br><br>"),i="<br><br>"),a.TextMessage=i,UndoRedo.createElement(t,a),$("html").hasClass("editing-text")||Text.saveTextWithoutFinish(currentData.IdItem)}else{var l=Text.getMultiPreviousStateObject(),r=[];$.each(Multidrag.multiElements,function(t,a){e.preventDefault();var n=a.find(".text-div");n.attr("contenteditable",!0);var i=document.createRange();i.selectNodeContents(n[0]);var l=window.getSelection();l.removeAllRanges(),l.addRange(i),document.execCommand("underline",!1,null),l.removeAllRanges();var o={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateTextMessage",idItem:a.attr("id"),idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":"",TextMessage:n.html()},s=a.attr("class").split(" "),d=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(s,function(e,t){d.indexOf(t)!==-1&&o.Classes.push(t)}),r.push(o)}),Text.saveMultidragTextWithoutFinish(),UndoRedo.createElement(l,r)}},Z=function(e){if(0===Multidrag.countElements()){e.preventDefault&&e.preventDefault();var t=Text.getPreviousStateObject(document.getElementById(currentData.IdItem));range=saveSelection(),restoreSelection(range),document.execCommand("removeFormat",!1,null),$("#"+currentData.IdItem).find("span, li, ul, ol, div, font, p").css({"background-color":"",color:""});var a=Object.assign({},t),n=$("#"+a.idItem),i=n.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==i&&'<ul style="list-style-type:point;"></ul>'!==i||(n.find(".text-div").html("<br><br>"),i="<br><br>"),a.TextMessage=i,UndoRedo.createElement(t,a),$("html").hasClass("editing-text")||Text.saveTextWithoutFinish(currentData.IdItem)}else{var l=Text.getMultiPreviousStateObject(),r=[];$.each(Multidrag.multiElements,function(t,a){
e.preventDefault();var n=a.find(".text-div");n.find("span, li, ul, ol, div, font, p").css({"background-color":"",color:""}),n.attr("contenteditable",!0);var i=document.createRange();i.selectNodeContents(n[0]);var l=window.getSelection();l.removeAllRanges(),l.addRange(i),document.execCommand("removeFormat",!1,null),l.removeAllRanges();var o={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateTextMessage",idItem:a.attr("id"),idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":"",TextMessage:n.html()},s=a.attr("class").split(" "),d=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(s,function(e,t){d.indexOf(t)!==-1&&o.Classes.push(t)}),r.push(o)}),Text.saveMultidragTextWithoutFinish(),UndoRedo.createElement(l,r)}},X=function(e){if(localStorage.setItem("previousTextColor",e),0===Multidrag.countElements()){var t=Text.getPreviousStateObject(document.getElementById(currentData.IdItem));if($("html").hasClass("editing-text"))restoreSelection(range),document.execCommand("foreColor",!1,e);else{var a=$("#"+currentData.IdItem).find(".text-div").html();if(a.startsWith("<"))$("#"+currentData.IdItem).find(".text-div").find("span, ul, ol, div, font, p").css("color",'"'+e+'"');else{var n=$("#"+currentData.IdItem).find(".text-div").html();n='<span style="color: '+e+'">'+n+"</span>",$("#"+currentData.IdItem).find(".text-div").html(n),$("#"+currentData.IdItem).find(".text-div").find("span, ul, ol, div, font, p").css("color",'"'+e+'"')}}var i=Object.assign({},t),l=$("#"+i.idItem),r=l.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==r&&'<ul style="list-style-type:point;"></ul>'!==r||(l.find(".text-div").html("<br><br>"),r="<br><br>"),i.TextMessage=r,UndoRedo.createElement(t,i),$("html").hasClass("editing-text")||Text.saveTextWithoutFinish(currentData.IdItem)}else{var o=Text.getMultiPreviousStateObject(),s=[];$.each(Multidrag.multiElements,function(t,a){var n=a.find(".text-div");n.attr("contenteditable",!0);var i=n.html();if(!$("html").hasClass("editing-text")){var i=n.html();if(i.startsWith("<"))n.find("span, ul, ol, div, font, p").css("color",'"'+e+'"');else{var l=n.html();l='<span style="color: '+e+'">'+l+"</span>",n.html(l),n.find("span, ul, ol, div, font, p").css("color",'"'+e+'"')}}var r={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateTextMessage",idItem:a.attr("id"),idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":"",TextMessage:n.html()},o=a.attr("class").split(" "),d=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(o,function(e,t){d.indexOf(t)!==-1&&r.Classes.push(t)}),s.push(r)}),Text.saveMultidragTextWithoutFinish(),UndoRedo.createElement(o,s)}},Y=function(e){if(0===Multidrag.countElements()){var t=Text.getPreviousStateObject(document.getElementById(currentData.IdItem)),a=Object.assign({},t),n=$("#"+a.idItem);if($("html").hasClass("editing-text"))restoreSelection(range),document.execCommand("backColor",!1,e.toHexString());else{var i=$("#"+currentData.IdItem).find(".text-div").html();if(i.startsWith("<"))$("#"+currentData.IdItem).find(".text-div").find("span, ul, ol, div, font, p").css("background-color",'"'+e+'"');else{var l=$("#"+currentData.IdItem).find(".text-div").html();l='<span style="background-color: '+e+'">'+l+"</span>",$("#"+currentData.IdItem).find(".text-div").html(l),$("#"+currentData.IdItem).find(".text-div").find("span, ul, ol, div, font, p").css("background-color",'"'+e+'"')}}var r=n.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==r&&'<ul style="list-style-type:point;"></ul>'!==r||(n.find(".text-div").html("<br><br>"),r="<br><br>"),a.TextMessage=r,UndoRedo.createElement(t,a),$("html").hasClass("editing-text")||Text.saveTextWithoutFinish(currentData.IdItem)}else{var o=Text.getMultiPreviousStateObject(),s=[];$.each(Multidrag.multiElements,function(t,a){var n=a.find(".text-div");if(!$("html").hasClass("editing-text")){var i=n.html();if(i.startsWith("<"))n.find("span, ul, ol, div, font, p").css("background-color",'"'+e+'"');else{var l=n.html();l='<span style="background-color: '+e+'">'+l+"</span>",n.html(l),n.find("span, ul, ol, div, font, p").css("background-color",'"'+e+'"')}}var r={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateTextMessage",idItem:a.attr("id"),idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),Classes:[],Background:a.css("background-color"),Opacity:a.css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":"",TextMessage:n.html()},o=a.attr("class").split(" "),d=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(o,function(e,t){d.indexOf(t)!==-1&&r.Classes.push(t)}),s.push(r)}),Text.saveMultidragTextWithoutFinish(),UndoRedo.createElement(o,s)}},V=function(e){function t(t){$("#"+currentData.IdItem).css({"background-color":e}),$("#fake-"+currentData.IdItem).css({"background-color":e});var a=Object.assign({},i);a.Background=$("#"+currentData.IdItem).css("background-color"),UndoRedo.createElement(i,a)}function a(e){SaveDisplay.showError()}if("text"===currentData.TypeItem){var n=$("#"+currentData.IdItem);if(n.css("background-color")!==e){var i={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateBackground",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:n.css("width"),Height:n.css("height")},Position:{PositionLeft:n.css("left"),PositionTop:n.css("top")},FontFamily:n.css("font-family"),FontSize:n.css("font-size"),TextMessage:n.find(".text-div").html(),Classes:[],Background:n.css("background-color"),Opacity:n.find(".text-div").css("opacity"),Padding:n.find(".text-wrapper").css("padding"),Shadow:n.hasClass("text-effect-shadow")?"text-effect-shadow":""},l=n.attr("class").split(" "),r=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(l,function(e,t){r.indexOf(t)!==-1&&i.Classes.push(t)});var o={Id:currentData.IdItem,IdGenially:currentData.IdGenially,Background:e};ApiGenially.executeCall(o,O,"PUT",t,a)}}},K=function(e){function t(e){$("#"+currentData.IdItem).css({"background-color":"transparent"}),$("#fake-"+currentData.Id).css({"background-color":"transparent"});var t=Object.assign({},i);t.Background=$("#"+currentData.IdItem).css("background-color"),UndoRedo.createElement(i,t)}function a(e){SaveDisplay.showError()}e.preventDefault&&e.preventDefault();var n=$("#"+currentData.IdItem),i={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateBackground",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:n.css("width"),Height:n.css("height")},Position:{PositionLeft:n.css("left"),PositionTop:n.css("top")},FontFamily:n.css("font-family"),FontSize:n.css("font-size"),TextMessage:n.find(".text-div").html(),Classes:[],Background:n.css("background-color"),Opacity:n.find(".text-div").css("opacity"),Padding:n.find(".text-wrapper").css("padding"),Shadow:n.hasClass("text-effect-shadow")?"text-effect-shadow":""},l=n.attr("class").split(" "),r=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(l,function(e,t){r.indexOf(t)!==-1&&i.Classes.push(t)});var o={Id:currentData.IdItem,IdGenially:currentData.IdGenially,Background:"transparent"};ApiGenially.executeCall(o,O,"PUT",t,a)},J=function(e){e.preventDefault&&e.preventDefault();var t=Text.getPreviousStateObject(document.getElementById(currentData.IdItem));document.execCommand("insertOrderedList",!1,null);var a=Object.assing({},t),n=$("#"+a.idItem),i=n.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==i&&'<ul style="list-style-type:point;"></ul>'!==i||(n.find(".text-div").html("<br><br>"),i="<br><br>"),a.TextMessage=i,UndoRedo.createElement(t,a)},q=function(e){e.preventDefault&&e.preventDefault();var t=Text.getPreviousStateObject(document.getElementById(currentData.IdItem));document.execCommand("insertUnorderedList",!1,null);var a=Object.assing({},t),n=$("#"+a.idItem),i=n.find(".text-div").html();'<ul style="list-style-type:decimal;"></ul>'!==i&&'<ul style="list-style-type:point;"></ul>'!==i||(n.find(".text-div").html("<br><br>"),i="<br><br>"),a.TextMessage=i,UndoRedo.createElement(t,a)},Q=function(e){e.preventDefault&&e.preventDefault();var t=parseInt(v[0].noUiSlider.get().split("%")[0],10)/100;if(0===Multidrag.countElements()){var a=$("#"+currentData.IdItem),n={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateOpacity",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),TextMessage:a.find(".text-div").html(),Classes:[],Background:a.css("background-color"),Opacity:a.find(".text-div").css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":""},i=a.attr("class").split(" "),l=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(i,function(e,t){l.indexOf(t)!==-1&&n.Classes.push(t)}),$("#"+currentData.IdItem).find(".text-wrapper").find("div").css({opacity:t});var r=Object.assign({},n);r.Opacity=t,UndoRedo.createElement(n,r);var o={IdGenially:currentData.IdGenially,Id:currentData.IdItem,Opacity:t};$("#fake-"+o.Id).find(".text-wrapper").find("div").css({opacity:t}),ApiGenially.executeCall(o,P,"PUT")}else{var s=[],d=[];$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id"),n={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateOpacity",idItem:a,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.find(".text-div").css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""},i=t.attr("class").split(" "),l=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(i,function(e,t){l.indexOf(t)!==-1&&n.Classes.push(t)}),s.push(n)});var c=[];$.each(Multidrag.multiElements,function(e,a){var n=a.attr("id");a.find(".text-wrapper").find("div").css({opacity:t});var i={IdGenially:currentData.IdGenially,Id:n,Opacity:t},l={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateOpacity",idItem:n,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:a.css("width"),Height:a.css("height")},Position:{PositionLeft:a.css("left"),PositionTop:a.css("top")},FontFamily:a.css("font-family"),FontSize:a.css("font-size"),TextMessage:a.find(".text-div").html(),Classes:[],Background:a.css("background-color"),Opacity:a.find(".text-div").css("opacity"),Padding:a.find(".text-wrapper").css("padding"),Shadow:a.hasClass("text-effect-shadow")?"text-effect-shadow":""},r=a.attr("class").split(" "),o=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(r,function(e,t){o.indexOf(t)!==-1&&l.Classes.push(t)}),d.push(l),$("#fake-"+i.Id).find(".text-wrapper").find("div").css({opacity:t}),c.push(i)}),UndoRedo.createElement(s,d);var u="/api/Text/MultiUpdateOpacity";ApiGenially.executeCall(c,u,"PUT")}},ee=function(e){e.preventDefault&&e.preventDefault();var t=$("#"+currentData.IdItem),a={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdatePadding",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")},FontFamily:t.css("font-family"),FontSize:t.css("font-size"),TextMessage:t.find(".text-div").html(),Classes:[],Background:t.css("background-color"),Opacity:t.find(".text-div").css("opacity"),Padding:t.find(".text-wrapper").css("padding"),Shadow:t.hasClass("text-effect-shadow")?"text-effect-shadow":""},n=t.attr("class").split(" "),i=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(n,function(e,t){i.indexOf(t)!==-1&&a.Classes.push(t)});var l=y[0].noUiSlider.get();$("#"+currentData.IdItem).find(".text-wrapper").css({padding:l});var r={IdGenially:currentData.IdGenially,Id:currentData.IdItem,Padding:l},o=Object.assign({},a);o.Padding=l,UndoRedo.createElement(a,o),$("#fake-"+r.Id).find(".text-wrapper").css({padding:l}),setTimeout(function(){Canva.setPositionSelector(document.getElementById(currentData.IdItem))},200),ApiGenially.executeCall(r,E,"PUT")},te=function(e){function t(e){$(I).prop("checked")?($("#"+currentData.IdItem).addClass("text-effect-shadow"),$("#fake-"+currentData.IdItem).addClass("text-effect-shadow")):($("#"+currentData.IdItem).removeClass("text-effect-shadow"),$("#fake-"+currentData.IdItem).removeClass("text-effect-shadow"))}function a(e){SaveDisplay.showError()}var n=$("#"+currentData.IdItem),i={typeContent:"text",typeOperation:"UpdateText",typeTextUpdate:"UpdateShadowText",idItem:currentData.IdItem,idGenially:currentData.IdGenially,idSlide:currentData.IdSlide,Size:{Width:n.css("width"),Height:n.css("height")},Position:{PositionLeft:n.css("left"),PositionTop:n.css("top")},FontFamily:n.css("font-family"),FontSize:n.css("font-size"),TextMessage:n.find(".text-div").html(),Classes:[],Background:n.css("background-color"),Opacity:n.find(".text-div").css("opacity"),Padding:n.find(".text-wrapper").css("padding"),Shadow:n.hasClass("text-effect-shadow")?"text-effect-shadow":""},l=n.attr("class").split(" "),r=["text-align-left","text-align-right","text-align-center","text-align-justify"];$.each(l,function(e,t){r.indexOf(t)!==-1&&i.Classes.push(t)});var o={IdGenially:currentData.IdGenially,Id:currentData.IdItem,Shadow:$(I).prop("checked")?"text-effect-shadow":""},s=Object.assign({},i);s.Shadow=o.Shadow,UndoRedo.createElement(i,s),ApiGenially.executeCall(o,G,"PUT",t,a)},ae=function(){C.hasClass("open")&&C.removeClass("open")},ne=function(){ae(),c.spectrum("hide"),p.spectrum("hide"),g.spectrum("hide")},ie=function(){x.hasClass("open")&&x.removeClass("open"),S.hasClass("open")&&S.removeClass("open"),w.hasClass("open")&&S.removeClass("open")},le=function(){c.spectrum("hide"),p.spectrum("hide"),g.spectrum("hide")},re=function(){c.spectrum({containerClassName:"spectrumGenially",preferredFormat:"hex",showInput:!0,showPalette:!0,chooseText:locale.spectrum.choose,cancelText:locale.spectrum.cancel,localStorageKey:"spectrum.genially"+$("#idGenially").val(),palette:CustomColors.getCustomColors(),change:function(e){setTimeout(function(){$(".sp-container").is(":visible")&&X(e)},200)},show:function(e){range=saveSelection(),U=currentData.IdItem,ie()}}),$(c).on("dragstop.spectrum",function(e,t){setTimeout(function(){$(".sp-container").is(":visible")&&X(t)},200)}),p.spectrum({containerClassName:"spectrumGenially",preferredFormat:"hex",showInput:!0,showPalette:!0,chooseText:locale.spectrum.choose,cancelText:locale.spectrum.cancel,localStorageKey:"spectrum.genially"+$("#idGenially").val(),palette:CustomColors.getCustomColors(),change:function(e){setTimeout(function(){$(".sp-container").is(":visible")&&Y(e)},200)},show:function(e){range=saveSelection(),U=currentData.IdItem,ie()}}),$(p).on("dragstop.spectrum",function(e,t){setTimeout(function(){$(".sp-container").is(":visible")&&Y(t)},200)}),g.spectrum({containerClassName:"spectrumGenially",preferredFormat:"hex",showInput:!0,showPalette:!0,showAlpha:!0,chooseText:locale.spectrum.choose,cancelText:locale.spectrum.cancel,localStorageKey:"spectrum.genially"+$("#idGenially").val(),palette:CustomColors.getCustomColors(),change:function(e){U===currentData.IdItem&&$(".sp-container").is(":visible")&&V(e.toRgbString())},show:function(e){U=currentData.IdItem}}),$(g).on("dragstop.spectrum",function(e,t){U===currentData.IdItem&&$(".sp-container").is(":visible")&&V(t.toRgbString())})},oe=function(){if(0===Multidrag.countElements()){$("#tb-permanent").find("#permanentLock").prop("disabled",!1),$("#tb-permanent").find("#permanentCopy").prop("disabled",!1),$("#tb-general").find("#generalZIndex").prop("disabled",!1),$("#tb-general").find("#generalPosition").prop("disabled",!1),$("#"+currentData.IdItem).hasClass("text-effect-shadow")?$(I)[0].checked=!0:$(I).removeAttr("checked"),v[0].noUiSlider.set(100*$("#"+currentData.IdItem).find(".text-wrapper").find("div").css("opacity"));var e=$("#"+currentData.IdItem).find(".text-wrapper").css("padding-left");y[0].noUiSlider.set(e);var t=$("#"+currentData.IdItem).css("font-family").replace(/['"]+/g,"");if(t.indexOf("_customgenially")!==-1){var a=$('[data-font="'+t+'"]').text();$(".bfh-selectbox-option").html(a)}else $(".bfh-selectbox-option").html(t);var i=$("#"+currentData.IdItem).css("font-size").split("px")[0];$(n).val(i),k.html(i)}else $("#tb-permanent").find("#permanentLock").prop("disabled",!1),$("#tb-permanent").find("#permanentCopy").prop("disabled",!1),$("#tb-general").find("#generalZIndex").prop("disabled",!0),$("#tb-general").find("#generalPosition").prop("disabled",!0),Multidrag.allSame("text")||A.removeClass("tb-text")},se=function(){t=D.find("#textSave"),a=D.find("#textFontFamily"),n=D.find("#textSizeCustom"),i=D.find(".textSize"),k=$("#sizeFont"),l=D.find(".textAlignment"),r=D.find("#textBold"),o=D.find("#textItalic"),s=D.find("#textUnderlined"),d=D.find("#textClear"),c=D.find("#textForeground"),x=D.find("#moreOptionsTextParent"),S=D.find("#sizeFontParent"),w=D.find("#menuAlignment"),u=D.find("#moreOptionsText"),p=D.find("#textBackground"),g=D.find("#textHolder"),f=D.find("#textReset"),m=D.find("#textOList"),h=D.find("#textUList"),I=D.find("#shadowSwitch"),b=D.find("button"),C=D.find(".bfh-googlefonts"),t.click(z),a.on("change.bfhselectbox",F),a.on("show.bfhselectbox",le),n.on("keyup",L),i.click(H),l.click(W),r.click(j),o.click(N),s.click(_),d.click(Z),b.click(ne),u.click(ne),a.find("input.bfh-selectbox-filter").keypress(function(e){10!==e.keyCode&&13!==e.keyCode||e.preventDefault()}),$(".text-color-option").on("mousedown",function(e){e.preventDefault(),X($(this).attr("data-color"))}),re(),f.click(K),m.click(J),h.click(q),v=$("#textOpacity"),noUiSlider.create(v[0],{start:100,step:5,range:{min:5,max:100},tooltips:!0,format:wNumb({decimals:0,postfix:"%"})}),v[0].noUiSlider.on("change",Q),y=$("#textPadding"),noUiSlider.create(y[0],{start:25,step:1,range:{min:0,max:50},tooltips:!0,format:wNumb({decimals:0,postfix:"px"})}),y[0].noUiSlider.on("change",ee),I.click(te)},de=function(){document.execCommand("styleWithCSS",!1,!0),se()};return{init:de,changeDynamicElements:oe,activeFonts:e}}(),ToolbarGeneral=function(){var e=$("#tb-general"),t=function(){var t=e.find("button");t.click(function(){$("#svg-colorpicker-1").spectrum("hide"),$("#svg-colorpicker-2").spectrum("hide"),$("#svg-colorpicker-3").spectrum("hide")})};return{init:t}}(),ToolbarBackground=function(){var e=($("#tb-background"),$("html"),"/api/Background/UpdateBackgroundImage"),t="/api/Background/UpdateAllBackgrounds",a=$("#background-colorpicker"),n=$("#backgroundOpacity"),i=$("#applyBackgroundAll"),l=!1,r=function(t,a){var n=$("#"+currentData.IdSlide),i=n.css("background-color");if(i!==t){var r={typeContent:"background",typeOperation:"BackgroundColor",backgroundColor:i,idSlide:currentData.IdSlide};n.css("background-color",t),$("#slide-clone-"+currentData.IdSlide).css({"background-color":t});var o=Object.assign({},r);o.backgroundColor=t,UndoRedo.createElement(r,o),l=!1,u();var s={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};s.IdSlide=currentData.IdSlide,s.BackgroundColor=t,Background.refreshRender(currentData.IdSlide),ApiGenially.executeCall(s,e,"PUT")}},o=function(t){t.preventDefault&&t.preventDefault();var a=t.toString(),n=a.split("%")[0]/100,i=$("#"+currentData.IdSlide).find(".current-background-slide").css("opacity"),r={typeOperation:"BackgroundOpacity",typeContent:"background",opacity:i,idSlide:currentData.IdSlide};$("#"+currentData.IdSlide).find(".current-background-slide").css({opacity:n});var o={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null};o.IdSlide=currentData.IdSlide,o.OpacityBackground=n,$("#slide-clone-"+currentData.IdSlide).find(".slide-page-clone-container").css({opacity:n}),ApiGenially.executeCall(o,e,"PUT");var s=Object.assign({},r);s.opacity=n,l=!1,u(),UndoRedo.createElement(r,s)},s=function(){a.spectrum("destroy"),a.spectrum({containerClassName:"spectrumGenially",preferredFormat:"hex6",showInput:!0,showPalette:!0,hideAfterPaletteSelect:!0,showAlpha:!0,chooseText:locale.spectrum.choose,cancelText:locale.spectrum.cancel,localStorageKey:"spectrum.genially"+$("#idGenially").val(),palette:CustomColors.getCustomColors(),change:function(e){a.spectrum("set",e),r(e.toRgbString(),this)},hide:function(e){return!1},show:function(e){a.spectrum("set",$("#"+currentData.IdSlide).css("background-color"))}})},d=function(){if(!l){var e=$(this),a=e.text(),n='<div class="preloader pl-xs pls-pink"><svg class="pl-circular" viewBox="25 25 50 50"><circle class="plc-path" cx="50" cy="50" r="20"></circle></svg></div>';e.html(n),e.prop("disabled",!0).addClass("disabled").css({"pointer-events":"none"});var i=$("#"+currentData.IdSlide),r=[],o=[],s=i.css("background-color"),d=i.find(".current-background-slide"),c=d.attr("src"),p=d.css("opacity"),g=d.css("top"),f=d.css("left"),m=d.css("width"),h=d.css("height"),v={IdGenially:null,IdSlide:null,SizeBackground:{Width:null,Height:null},PositionBackground:{PositionLeft:null,PositionTop:null},OpacityBackground:null,BackgroundColor:null,Source:null,SourceBase64:null},y=new Image;y.src=c,$(y).on("load",function(){function n(t){$.each(t,function(e,t){var a=$("#"+t).find(".current-background-slide"),n={typeContent:"background",typeOperation:"BackgroundImage",idSlide:t,backgroundImage:a.attr("src"),backgroundColor:$("#"+t).css("background-color"),opacity:a.css("opacity"),top:a.css("top"),left:a.css("left"),width:a.css("width"),height:a.css("height")};r.push(n),$("#"+t).css({"background-color":s}),a.css({width:m}),a.css({height:h}),a.attr("src",c),a.css({opacity:p}),a.css({top:g}),a.css({left:f});var i={typeContent:"background",typeOperation:"BackgroundImage",idSlide:t,backgroundImage:a.attr("src"),backgroundColor:$("#"+t).css("background-color"),opacity:a.css("opacity"),top:a.css("top"),left:a.css("left"),width:a.css("width"),height:a.css("height")};o.push(i),$("#slide-clone-"+t).css({"background-color":s}),$("#slide-clone-"+t).find(".slide-page-clone-container").attr("src",c),$("#slide-clone-"+t).find(".slide-page-clone-container").css({left:f,top:g,width:m,height:h,opacity:p}),Background.refreshRender(t)}),UndoRedo.createElement(r,o),setTimeout(function(){e.text(a),e.prop("disabled",!1).removeClass("disabled").css({"pointer-events":"all"}),u()},1500)}v.SizeBackground.Width=m,v.SizeBackground.Height=h,v.Source=c,v.BackgroundColor=s,v.OpacityBackground=p,v.PositionBackground.PositionTop=g,v.PositionBackground.PositionLeft=f,v.IdGenially=currentData.IdGenially,v.IdSlide=currentData.IdSlide,ApiGenially.executeCall(v,t,"PUT",n)})}},c=function(){i.click(d),noUiSlider.create(n[0],{start:100,step:5,range:{min:5,max:100},tooltips:!0,format:wNumb({decimals:0,postfix:"%"})}),s(),n[0].noUiSlider.on("change",o),$("#opacity-background").click(function(){a.spectrum("hide")})},u=function(){l?i.prop("disabled",!0).addClass("disabled").css({"pointer-events":"none"}):i.prop("disabled",!1).removeClass("disabled").css({"pointer-events":""})},p=function(e){l=e},g=function(){c()};return{init:g,changeDynamicElements:u,setAllSameBackground:p}}(),InsertEditor=function(){function e(e){s.show();var a=e.match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i),n=a&&a[1];if(jQuery.inArray(n,r)!==-1)$.ajax({url:"https://iframe.ly/api/oembed?api_key=d94a0eb55704680be3cd47",dataType:"json",data:{url:e},success:function(e){if(s.hide(),e&&e.html){var t={html:e.html},a=Genially.templates.embediframe(t);RichContent.createContent(a)}else e&&!e.html&&"photo"===e.type&&e.url},error:function(){o.show(),s.hide()}});else{var i="";$.embedly.extract(e,{}).progress(function(e){if(e.invalid===!0)o.show(),s.hide();else if("error"===e.type)o.show(),s.hide();else if(null==e.media.html)if(e.images.length>0){var t={title:e.title,provider:e.provider_name,url:e.url,background:e.images[0].url,description:e.description},a=Genially.templates.embed(t);RichContent.createContent(a)}else o.show(),s.hide();else{i=e.media.html;var n={html:i},a=Genially.templates.embediframe(n);RichContent.createContent(a)}s.hide()})}t.val("")}$.embedly.defaults.key="eac46e7ba2af4800adf4210c29a9bcb6";var t,a,n,i,l,r=["infogr.am","www.infogr.am","instagram.com","www.instagram.com","twitter.com","www.facebook.com","facebook.com","pinterest.com","es.pinterest.com"],o=$("#noRichContent"),s=$("#loaderRichContent"),d=/^(http|https):\/\//gi,c=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/g,u=/^<iframe/gi,p=[{name:"script",regex:/<script(.*?src="(.*?)"[\s\S]*?)?>[\s\S]*?<\/script>/gi},{name:"iframe",regex:/<iframe.*?src="(.*?)"/gim}],g=function(e){return e.split(">")[1].split("</")[0].length},f=function(e){var t={number:0,containsScript:!1},a=e.match(p[0].regex);if(null===a)return t;for(var n=0;n<a.length;n++)g(a[n])&&(t.containsScript=!0);return t.number=e.match(p[0].regex).length,t},m=function(e){var t=f(e),a={scriptCount:t.number,tagsAllowed:!0,containsJavascript:t.containsScript};return a},h=function(e,a){setTimeout(function(){var e=$(t).val();e.match(d)?(l="url",a(null!==e.match(c))):a(!1)},20)},v=function(e){o.hide(),""!==$(t).val()&&h(e,function(e){if(e)b();else{l=$(t).val().match(u)?"iframe":"other";var a=m($(t).val());if(!a.tagsAllowed)return void o.show();a.scriptCount>1&&o.show(),a.containsJavascript,C()}})},y=function(e){$("#insertTypes").find(".typeBox").removeClass("active"),$(this).addClass("active");var t=$(this).data("provider");$("#insertTypes").find(".providers-holder").find(".provider-list").slideUp(),$("#insertTypes").find(".providers-holder").find("#"+t+"Providers").slideDown()},I=function(e){var a=$(this).data("link");if($(this).hasClass("with-code"))switch(a){case 1:a='<script async src="//jsfiddle.net/blazeeboy/fNPvf/embed/"></script>';break;case 2:a='<iframe src="//api.apiembed.com/?source=https://apiembed.com/sample.json&targets=shell:curl,node:unirest,java:unirest,python:requests,php:curl,ruby:native,objc:nsurlsession,go:native" frameborder="0" scrolling="no" width="100%" height="500px" seamless></iframe>';break;case 3:a='<iframe src="https://bleroku.blockspring.com/blocks/9/3afad29c1e90787cc2e4e22b54d78308d4f2de38/index.html" width="100%" height="100%" frameborder="0"></iframe>';break;case 4:a='<div id="c_fa2c5dba5aae0764b3f1df36030b5b3b" class="normal"></div><script type="text/javascript" src="http://www.eltiempo.es/widget/widget_loader/fa2c5dba5aae0764b3f1df36030b5b3b"></script>';break;case 5:a='<object height="44" width="148"><param name="movie" value="http://vocaroo.com/player.swf?playMediaID=s1LZU9cEYZmc&autoplay=0"><param name="wmode" value="transparent"><embed src="http://vocaroo.com/player.swf?playMediaID=s1LZU9cEYZmc&autoplay=0" wmode="transparent" type="application/x-shockwave-flash" height="44" width="148"></object><br><a href="http://vocaroo.com" title="Vocaroo Voice Recorder"></a>';break;case 6:a='<iframe frameborder="0" class="juxtapose" width="100%" height="360" src="https://cdn.knightlab.com/libs/juxtapose/latest/embed/index.html?uid=4976ee4e-0bc4-11e6-a524-0e7075bba956"></iframe>';break;case 7:a="<div class=\"tc_div_13963\" style=\"width:650px;height:162.50px;border:1px solid #C0C0C0;\"><a title=\"Genially\" href=\"http://www.tickcounter.com/countdown/1580511600000/europe-berlin/dhms/FFFFFF3B5998000000FF0000/Genially\">Genially</a><a title=\"Countdown\" href=\"http://www.tickcounter.com/\">Countdown</a></div><script type=\"text/javascript\">(function(){ var s=document.createElement('script');s.src=\"http://www.tickcounter.com/loader.js\";s.async='async';s.onload=function() { tc_widget_loader('tc_div_13963', 'Countdown', 650, ['1580511600000', 'europe-berlin', 'dhms', 'FFFFFF3B5998000000FF0000', '650', 'C0C0C01', 'Genially']);};s.onreadystatechange=s.onload;var head=document.getElementsByTagName('head')[0];head.appendChild(s);}());</script>";break;case 8:a='<iframe width="590" height="420" src="http://web2.0calc.com/widgets/horizontal/?options=%7B%22angular%22%3A%22deg%22%2C%22options%22%3A%22hide%22%2C%22menu%22%3A%22show%22%7D" scrolling="no" style="border: 1px solid silver; "></iframe><br /><a href="http://web2.0calc.com/">Web 2.0 scientific calculator</a>'}$(t).val(a)},b=function(a){e($(t).val())},C=function(e){var a={html:$(t).val()},n=Genially.templates.embediframe(a);RichContent.createContent(n),t.val("")},x=function(){$(".owl-carousel").owlCarousel({items:3,loop:!0,autoplay:!0,autoplayTimeout:1e3,autoplayHoverPause:!0}),t=$("#insertTypes").find("input#insertContentUrl"),a=$("#insertTypes").find("button#insertContentUrlButton"),a.on("click",v),n=$("#insertTypes").find(".typeBox:not(.provider)"),n.on("click",y),$("#insertTypes").find(".providers-holder").find(".provider-list").slideUp(),i=$("#insertTypes").find(".typeBox.provider"),i.on("click",I)},S=function(){x()};return{init:S,checkSrc:m,checkUrl:h}}(),IconPin=function(){var e,t="/api/IconPin/GetPinsFromCategory",a=$("#pinsHolder"),n="/api/pin/",i=function(e,t,a){function i(e){$(".working").removeClass("working"),$("#"+l).css("pointer-events",""),$("#"+l).attr("id",e),$("#fake-"+l).attr("id","fake-"+e),$("html").hasClass("multidragging")||Canva.selectItem(e),Canva.hideSideBars(),Canva.showInteractivity(),Background.hideSelector(),$("html").removeClass("blocked")}var l=guid(),r="",o="",s=[],d={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Source:a,TypeContent:0,Name:name,Position:{PositionLeft:e,PositionTop:t},EffectIn:"none",EffectOut:"none",EffectHover:"none",Effect:"none",DurationIn:"vel3",DurationOut:"vel3",DelayOut:0,DelayIn:0,Size:"pin-size-normal",EnableZoom:!1,Id:l};s.push(d),r+=Genially.templates.pins(s),o+=Genially.templates.pins_clone(s),$("#"+currentData.IdSlide).append(r),$("#slide-clone-"+currentData.IdSlide).append(o),DesignMode.cleanValues(),Canva.computeCurrentPines();var c=$("#"+l),u=watching.scale;c.attr("data-x",e-16/u),c.attr("data-y",t-32/u);var p=n+"CreatePin";c.css("pointer-events","none"),d.Id=null,ApiGenially.executeCall(d,p,"POST",i)},l=function(){$("html").hasClass("touchevents")?interact(".pin-item").on("tap",function(e){var t=$(e.target).attr("src"),a=$("#"+currentData.IdSlide).height()/2-16,n=$("#"+currentData.IdSlide).width()/2-16;i(n,a,t),SecondaryActions.forceHide()}):$(".pin-item").click(function(e){
var t=$(e.target).attr("src"),a=$("#"+currentData.IdSlide).height()/2-16,n=$("#"+currentData.IdSlide).width()/2-16;i(n,a,t),SecondaryActions.forceHide()}),$(".pin-item").draggable({opacity:.7,helper:function(){var e=$(this).clone();return e.width(32),e.height(32),e},appendTo:"body",scroll:!1,stop:function(e,t){var a=currentMousePosAtImgInPX(),n=$(t.helper).attr("src");i(a.x,a.y,n)},zIndex:9e3})},r=function(e){function n(e){a.addClass("filled").html("");var t=Genially.templates.listpins(e);a.append(t),l(),a.append('<div class="clearfix"></div>')}function i(e){SaveDisplay.showError()}var r=$(this).data("id"),o=$(".pin-type.active").data("id");if(r!==o){a.html('<div class="loading" style="top: 0;"></div>'),$(".pin-type").removeClass("active"),$(".area-type").removeClass("active"),$(this).addClass("active");var s={category:r};ApiGenially.executeCall(s,t,"GET",n,i)}},o=function(){e=$("#interactTypes").find(".pin-type"),e.on("click",r)},s=function(){o()};return{init:s}}(),Interactivity=function(){var e,t,a,n,i,l,r,o,s,d,c,u,p,g,f,m,h,v,y,I="/api/Interactive/SaveContent",b="/api/Interactive/GetContent",C="/api/Interactive/RemoveInteractivity",x="/api/Interactive/UploadEditorImage",S=$("html"),w=["infogr.am","www.infogr.am","instagram.com","www.instagram.com","twitter.com","www.facebook.com","facebook.com","pinterest.com","es.pinterest.com"],k=function(){var e=0;return e=$(document).width()<400?$(document).width():400},D=function(){g=$(".goto-slide-list"),g.click(N),null!==currentData.IdSlide&&"undefined"!=typeof currentData.IdSlide&&$("#GotoSlidePreviews").find('[data-id="'+currentData.IdSlide+'"]').hide()},T=function(){var e=$("#GotoSlidePreviews");if(e.html(""),$(".to-clone-slide-goto").each(function(){var t=$(this).attr("data-id");if(t!==currentData.IdSlide){var a=$("#container-clone-"+t).clone(),n={Id:t,Order:$(this).find("span.order-number-slide").text(),Name:$(this).find("input").val()},i=Genially.templates.gotoslide(n);e.append(i),$("#goto-slide-"+t).append(a)}}),D(),null!==currentData.IdItem){var t=$("#"+currentData.IdItem);if(t.length>0&&"4"===t.attr("data-interactive")){var a=t.attr("data-id-slide-to-go");(null!==a&&"undefined"!=typeof a||""!==a)&&$('.slide-preview-of[data-id="'+t.attr("data-id-slide-to-go")+'"]').addClass("active")}}},P=function(){$("#modalInteractivityNew").modal("hide"),$("#windowEditor").summernote("reset"),$("#tooltipEditor").summernote("reset")},E=function(){if(!($(".tpd-tooltip").length>0)){var e="",t=$("input[type='radio'][name='tooltipStyle']:checked");t.length>0&&(e=t.data("tooltip-class")),Tipped.create("#previewTooltip",function(e){return $("#tooltipEditor").summernote("code")},{radius:!1,shadow:!0,skin:e,hideOthers:!0,size:"medium",hideOnClickOutside:!0,maxWidth:k(),behavior:"sticky",afterHide:function(e,t){Tipped.remove("#previewTooltip")}}),Tipped.show("#previewTooltip")}},G=function(t){function a(e){return null===e?void n():(null!==e.HtmlCode&&(e.HtmlCode=e.HtmlCode.replace(/(\r\n|\n|\r)/gm," ").trim()),"<p></p>"===e.HtmlCode&&(e.HtmlCode=""),1===e.TypeContent?($("#windowEditor").summernote("code",e.HtmlCode),"modal-sm"===e.SizeModal&&($("#sizeModalSm").prop("checked",!0),$("#window").find(".note-editable").addClass("moda-sm-summernote")),"modal-md"===e.SizeModal&&($("#sizeModalMd").prop("checked",!0),$("#window").find(".note-editable").addClass("moda-md-summernote")),"modal-lg"===e.SizeModal&&($("#sizeModalLg").prop("checked",!0),$("#window").find(".note-editable").addClass("moda-lg-summernote")),$(".goto-slide-list").removeClass("active"),$("#tooltipEditor").summernote("code",e.HtmlCode),f.val(""),Z()):2===e.TypeContent?($("#tooltipEditor").summernote("code",e.HtmlCode),$(".goto-slide-list").removeClass("active"),$("#windowEditor").summernote("code",e.HtmlCode),f.val("")):3===e.TypeContent?(f.val(e.Link.trim()),f.focus(),$(".goto-slide-list").removeClass("active"),$("#tooltipEditor").summernote("code",""),$("#windowEditor").summernote("code","")):4===e.TypeContent&&($(".slide-preview-of").removeClass("active"),""!==e.IdSlideToGo&&$('.slide-preview-of[data-id="'+e.IdSlideToGo+'"]').addClass("active"),$("#tooltipEditor").summernote("code",""),$("#windowEditor").summernote("code",""),f.val("")),void i(l,r))}function n(e){$("#sizeModalMd").prop("checked",!0),Z(),$(".goto-slide-list").removeClass("active"),$("#tooltipEditor").summernote("code",""),$("#windowEditor").summernote("code",""),f.val(""),i(l,r)}function i(t,a){if(t)e.find("li[data-type!="+a+"]").removeClass("active"),e.find("li[data-type="+a+"]").addClass("active"),e.find(".tab-content").find(".tab-pane").removeClass("active"),e.find(".tab-content").find("#"+a).addClass("active"),$("#modalInteractivityNew").modal();else{var n=$("#"+currentData.IdItem),i="tooltip",l=parseInt($(n).attr("data-interactive"),10);1===l?i="window":2===l?i="tooltip":3===l?i="link":4===l&&(i="goto"),e.find("li[data-type!="+i+"]").removeClass("active"),e.find("li[data-type="+i+"]").addClass("active"),e.find(".tab-content").find(".tab-pane").removeClass("active"),e.find(".tab-content").find("#"+i).addClass("active")}$("#modalInteractivityNew").modal()}t.preventDefault(),$("#magicWand").attr("data-id-aux",currentData.IdItem);var l=!1,r=null,o=null;if("undefined"!=typeof $(this).attr("id")&&"magicWand"===$(this).attr("id")||(l=!0,r=$(this).data("type"),o=$(this)),T(),!l&&"0"===$("#"+currentData.IdItem).attr("data-interactive"))return $("#windowEditor").summernote("code",""),$("#tooltipEditor").summernote("code",""),void n();var s={IdItem:currentData.IdItem,IdGenially:currentData.IdGenially};ApiGenially.executeCall(s,b,"GET",a)},B=function(){t.show()},M=function(){t.hide(),s.hide()},O=function(e){l.show(),e.notSupported&&r.show(),e.notSelected&&o.show()},U=function(){l.hide()},A=function(e){var t=$("#"+currentData.IdItem),a="tooltip",n=parseInt($(t).attr("data-interactive"),10);return 0===n||"undefined"===n||null===n?($(".interactivity-type").removeClass("active"),void s.hide()):(1===n?a="window":2===n?a="tooltip":3===n?a="link":4===n&&(a="goto"),$(".interactivity-type").removeClass("active"),$(".interactivity-type[data-type="+a+"]").addClass("active"),void s.show())},R=function(){function e(e){0!==$("#"+e).length&&($("#"+e).attr("data-interactive",0),s.hide(),t.removeClass("active"),P())}function a(e){}var n={IdGenially:currentData.IdGenially,IdItem:currentData.IdItem};ApiGenially.executeCall(n,C,"PUT",e,a)},z=function(){function e(e){var t=$("#"+e);0!==t.length&&(t.attr("data-interactive",2),s.show(),$("#interactTypes").find(".interactivity-type").removeClass("active"),$("#interactTypes").find(".interactivity-type[data-type=tooltip]").addClass("active"),$("#sizeModalMd").prop("checked",!0),Z(),$("#windowEditor").summernote("code",""),P())}function t(e){SaveDisplay.showError()}var a=$("#tooltipEditor").summernote("code");if(null===a||""===a)return void R();a=a.replace(/(\r\n|\n|\r)/gm," ").trim(),null===currentData.IdItem&&(currentData.IdItem=$("#magicWand").attr("data-id-aux"));var n={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:currentData.IdItem,HtmlCode:a,TypeContent:2};ApiGenially.executeCall(n,I,"POST",e,t)},F=function(){function e(e){var t=$("#"+e);0!==t.length&&(t.attr("data-interactive",1),s.show(),$("#interactTypes").find(".interactivity-type").removeClass("active"),$("#interactTypes").find(".interactivity-type[data-type=window]").addClass("active"),$("#tooltipEditor").summernote("code",""),P())}function t(e){SaveDisplay.showError()}var a=$("#windowEditor").summernote("code");if(null===a||""===a)return void R();null===currentData.IdItem&&(currentData.IdItem=$("#magicWand").attr("data-id-aux"));var n={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:currentData.IdItem,HtmlCode:a,SizeModal:$(".SizeModal:checked").val(),TypeContent:1};ApiGenially.executeCall(n,I,"POST",e,t)},L=function(){function e(e){var t=$("#"+e);0!==t.length&&(t.attr("data-interactive",4),s.show(),$("#interactTypes").find(".interactivity-type").removeClass("active"),$("#interactTypes").find(".interactivity-type[data-type=goto]").addClass("active"),P())}function t(e){SaveDisplay.showError()}var a=$(".goto-slide-list.active");if(0!==a.length){null===currentData.IdItem&&(currentData.IdItem=$("#magicWand").attr("data-id-aux"));var n={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:currentData.IdItem,SlideToGo:a.data("id"),TypeContent:4};$("#"+currentData.IdItem).attr("data-id-slide-to-go",a.data("id")),ApiGenially.executeCall(n,I,"POST",e,t)}},H=function(){$("#windowEditor").summernote("code","")},W=function(){$("#tooltipEditor").summernote("code","")},j=function(){function e(e){var t=$("#"+e);0!==t.length&&(t.attr("data-interactive",3),s.show(),$("#interactTypes").find(".interactivity-type").removeClass("active"),$("#interactTypes").find(".interactivity-type[data-type=link]").addClass("active"),P())}function t(e){SaveDisplay.showError()}var a=f.val().trim();if(f.val(a),null!==a&&""!==a){null===currentData.IdItem&&(currentData.IdItem=$("#magicWand").attr("data-id-aux"));var n={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,IdItem:currentData.IdItem,Link:a,TypeContent:3};ApiGenially.executeCall(n,I,"POST",e,t)}},N=function(e){var t=$(this);g.removeClass("active"),t.addClass("active")},_=function(){var e=this;setTimeout(function(){var t=$(e).val().trim();if(""===t)return p.prop("disabled",!0),void f.removeClass("valid").addClass("error");var a=/^(http|https):\/\//gi,n=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/g;t.match(a)?null===t.match(n)?(p.prop("disabled",!0),f.removeClass("valid").addClass("error")):(p.prop("disabled",!1),f.hasClass("error")&&f.removeClass("error"),f.addClass("valid")):(p.prop("disabled",!0),f.removeClass("valid").addClass("error"))},300)},Z=function(){var e=$("#window").find(".note-editable"),t=$("#window").find(".SizeModal:checked").val();return"modal-sm"===t?(e.removeClass("moda-lg-summernote"),e.removeClass("moda-md-summernote"),void e.addClass("moda-sm-summernote")):"modal-md"===t?(e.removeClass("moda-sm-summernote"),e.removeClass("moda-lg-summernote"),void e.addClass("moda-md-summernote")):"modal-lg"===t?(e.removeClass("moda-sm-summernote"),e.removeClass("moda-md-summernote"),void e.addClass("moda-lg-summernote")):void 0},X=function(){if("tabWindow"===$(this).attr("id")){var e=$("#tooltipEditor").summernote("code");$("#windowEditor").summernote("code",e)}else{var t=$("#windowEditor").summernote("code");$("#tooltipEditor").summernote("code",t)}},Y=function(){a=$("#tabWindow"),n=$("#tabTooltip"),e=$("#interactivityModal"),t=$("#interactTypes").find(".interactivity-type"),t.hide(),l=$("#interactTypes").find(".no-support"),r=l.find(".element-support"),r.hide(),o=l.find(".not-selected"),s=$(".remove-interactivity"),d=$("#saveInteractivityTooltip"),c=$("#saveInteractivityWindow"),u=$("#saveInteractivityGoto"),p=$("#saveInteractivityLink"),f=$("#interactivityLinkInput"),m=$("#clearTooltip"),h=$("#clearModal"),v=$("#previewTooltip"),y=$(".SizeModal"),t.click(G),i=$("#magicWand"),i.click(G),s.click(R),d.click(z),c.click(F),u.click(L),p.click(j),f.on("paste",_),f.on("keyup",_),v.click(E),y.change(Z),m.click(W),h.click(H),a.click(X),n.click(X)},V=function(e){var t=this,a=((e.originalEvent||e).clipboardData||window.clipboardData).getData("Text"),n=a,i=/^(http|https):\/\//gi;if(!a.match(i))return!1;var l=a.match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i),r=l&&l[1];if(jQuery.inArray(r,w)!==-1)$.ajax({url:"https://iframe.ly/api/oembed?api_key=d94a0eb55704680be3cd47",dataType:"json",data:{url:n},success:function(e){if(loader.hide(),e&&e.html){var a={html:e.html},n=Genially.templates.embediframe(a),i=n.replace(/(\r\n|\n|\r)/gm," ");i=i.trim();var l=$(i);$(t).summernote("insertNode",l[0])}else e&&!e.html&&"photo"===e.type&&e.url},error:function(){}});else{var o="";$.embedly.extract(n,{}).progress(function(e){if(e.invalid===!0);else if("error"===e.type);else if(null==e.media.html){if(e.images.length>0){var a={title:e.title,provider:e.provider_name,url:e.url,background:e.images[0].url,description:e.description},n=Genially.templates.embed(a);o=n.replace(/(\r\n|\n|\r)/gm," "),o=o.trim();var i=$(o);$(t).summernote("insertNode",i[0])}}else{o=e.media.html;var l={html:o},n=Genially.templates.embediframe(l);o=n.replace(/(\r\n|\n|\r)/gm," "),o=o.trim();var i=$(o);$(t).summernote("insertNode",i[0])}})}},K=function(e){function t(){function e(e){a.summernote("insertImage",e.Image),a.siblings("div.note-loader").hide()}function t(e,t,n){return 401===e.status?(window.onbeforeunload=null,void location.reload()):(a.siblings("div.note-loader").hide(),void SaveDisplay.showErrorImage())}var n={};n="tooltipEditor"===a.attr("id")?{Width:400,Height:null,Strategy:"landscape"}:{Width:900,Height:null,Strategy:"landscape"};var l={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Base64:i,Resize:n};ApiGenially.executeCall(l,x,"PUT",e,t)}var a=$(this);a.siblings("div.note-loader").show();var n=e[0];if(n.size>5242880)return swal({title:locale.image.titleImageTooBig,text:locale.image.textImageTooBigSome,type:"info",confirmButtonColor:"#bc2360",confirmButtonText:locale.image.confirmButtonText,closeOnConfirm:!0}),void a.siblings("div.note-loader").hide();var i="",l=new FileReader;l.onload=function(e){i=e.target.result,t()},l.readAsDataURL(n)},J=function(){$("#windowEditor").summernote({minHeight:435,maxHeight:435,fontNames:["Roboto","Arial","Verdana","Tahoma","Courier New","Times New Roman","Comic Sans MS","Open Sans"],fontNamesIgnoreCheck:["Roboto","Arial","Verdana","Tahoma","Courier New","Times New Roman","Comic Sans MS","Open Sans"],toolbar:[["main",["undo","redo","bold","italic","underline","clear","fontname","fontsize","color","ol","ul","paragraph","table","link","picture","hr","codeview"]]],callbacks:{onPaste:V,onImageUpload:K},dialogsInBody:!0,lang:language,disableDragAndDrop:!0}),$("#tooltipEditor").summernote({minHeight:435,maxHeight:435,fontNames:["Roboto","Arial","Verdana","Tahoma","Courier New","Times New Roman","Comic Sans MS","Open Sans"],fontNamesIgnoreCheck:["Roboto","Arial","Verdana","Tahoma","Courier New","Times New Roman","Comic Sans MS","Open Sans"],toolbar:[["main",["undo","redo","bold","italic","underline","clear","fontname","fontsize","color","ol","ul","paragraph","table","link","picture","hr","codeview"]]],callbacks:{onPaste:V,onImageUpload:K},dialogsInBody:!0,lang:language,disableDragAndDrop:!0}),Z()},q=function(){$("#modalInteractivityNew").on("show.bs.modal",function(e){S.addClass("modal-open")}),$("#modalInteractivityNew").on("hide.bs.modal",function(e){S.removeClass("modal-open"),$(".note-popover").hide()}),$(".btn-codeview").click(function(){$(".note-popover").hide(),$(".note-control-selection").hide()})},Q=function(){Y(),J(),q()};return{init:Q,showInteractivityButtons:B,hideInteractivityButtons:M,showInteractivityError:O,hideInteractivityError:U,showInteractivityActive:A,initGotoSlide:D,displayModalWithWand:G}}(),SecondaryActions=function(){var e=null,t=null,a=null,n=null,i=null,l=!0,r=null,o=function(n){var r=$(n.target).closest(".showSecondaryAction");$(".showSecondaryAction").removeClass("active"),r.addClass("active"),Canva.hideSlideSideBar(),Settings.hideMoreOptions(),Settings.hideSetting();var o=$(this).attr("data-secondary");if(a.hasClass("first-time")&&a.removeClass("first-time"),a.attr("position-at",o),o===i)l?("animations"===o?e.addClass("animations"):e.removeClass("animations"),e.parent("section#secondaryActions").css({left:"100px"}),l=!1):("animations"===o&&e.removeClass("animations"),e.parent("section#secondaryActions").css({left:"-230px"}),l=!0);else{"animations"===o?e.addClass("animations"):e.removeClass("animations"),l=!1,i=o;var s=$(this).position().top,d=null;if($.each(t,function(e,t){$(t).attr("data-type")===o?d=$(t):$(t).hasClass("fadeInDown")&&$(t).removeClass("fadeInDown").addClass("fadeOutUp")}),null===d)return void e.parent("section#secondaryActions").css({left:"-230px"});a.addClass("moving").css({top:s}).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(e){$(e.currentTarget).removeClass("moving")}),e.parent("section#secondaryActions").css({left:"100px"}),$(d).hasClass("fadeOutUp")&&$(d).removeClass("fadeOutUp"),$(d).show().addClass("animated fadeInDown")}},s=function(){function t(){null!==currentData.TypeItem&&"background"!==currentData.TypeItem||(e.parent("section#secondaryActions").css({left:"-230px"}),l=!0)}setTimeout(t,200)},d=function(){null!==i&&"animations"!==i&&(e.parent("section#secondaryActions").css({left:"-230px"}),l=!0)},c=function(){null!==i&&(e.parent("section#secondaryActions").css({left:"-230px"}),l=!0)},u=function(){a.addClass("first-time"),e.parent("section#secondaryActions").css({left:"-230px"}),l=!0},p=function(){e=$("#secondaryActions").find("#secondaryHolder"),t=e.find(".typeAction"),a=$("#editorLeft").find("#positioner"),n=$("#editorLeft").find("ul.leftActions").find(".showSecondaryAction"),n.click(o)},g=function(){if(null!==i){var e=$("#menu-"+i).position().top;a.addClass("moving").css({top:e}).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(e){$(e.currentTarget).removeClass("moving")})}};return{init:p,hide:s,forceHide:u,processHide:d,processHideAll:c,positionAt:r,recalculate:g}}(),DesignMode=function(){function e(e){var t=e[0].style.transform;if(""===t)return t;try{if("none"!==t){if(t.indexOf("matrix")===-1)return t;try{var a=t.split("(")[1].split(")")[0].split(","),n=a[0];n=Math.round(1e7*n)/1e7;var i=a[1];i=Math.round(1e7*i)/1e7;var l=i*-1;l=Math.round(1e7*l)/1e7;var r="matrix("+n+", "+i+", "+l+","+n+", 0, 0)";return r}catch(o){return t}}}catch(o){return""}}function t(e){var t=0;try{var a=e.css("-webkit-transform")||e.css("-moz-transform")||e.css("-ms-transform")||e.css("-o-transform")||e.css("transform");if("none"!==a){var n=a.split("(")[1].split(")")[0].split(","),i=n[0],l=n[1];t=Math.round(Math.atan2(l,i)*(180/Math.PI))}else t=0;return t}catch(r){return t}}var a=!0,n={area:null,aspectRatio:null,width:null,height:null,top:null,left:null,rotation:null,setButton:null,menuButton:null,closeButton:null,toggleButton:null},i={enabled:!1,aspectRatio:!1},l=null,r={width:0,height:0,top:0,left:0,rotation:0},o=function(){n.area.hasClass("reduced")?(n.area.removeClass("reduced"),n.toggleButton.find("i").html("keyboard_arrow_up")):(n.area.addClass("reduced"),n.toggleButton.find("i").html("keyboard_arrow_down"))},s=function(e){if(13===e.keyCode){var t=$("#"+currentData.IdItem),a=n.width.val()+"px",l=n.height.val()+"px";if(""!==n.width.val()&&""!==n.height.val()&&(a!==t.css("width")||l!==t.css("height"))){var r=t.width(),o=t.height();if(i.aspectRatio){var s=n.width.val(),d=n.height.val();r===s?n.width.val(parseInt(r*d/o),10):n.height.val(parseInt(o*s/r),10)}}}},d=function(){var e=n.width.val(),t=n.height.val(),a=$("#"+currentData.IdItem);$(this).bind("blur",function(){if(""===n.width.val()||""===n.height.val())return void $(this).unbind("blur");if(i.aspectRatio){var l=n.width.val(),r=n.height.val();e===l?n.width.val(parseInt(e*r/t),10):n.height.val(parseInt(t*l/e),10)}var o=n.width.val()+"px",s=n.height.val()+"px";return o===a.css("width")&&s===a.css("height")?void $(this).unbind("blur"):void $(this).unbind("blur")})},c=function(){return l},u=function(){return i},p=function(){return r},g=function(){if(0===Multidrag.countElements()){if(null===l||""===l)return;if(0===n.width.val()&&""===n.width.val()||0===n.height.val()&&""===n.height.val()||""===n.top.val()||""===n.left.val()||""===n.rotation.val())swal("Error","Some of the fields contain non valid values","warning");else{0===n.rotation.val()||"0"===n.rotation.val()?$(l).removeClass("rotated-item"):$(l).addClass("rotated-item");var t={idItem:currentData.IdItem,typeContent:currentData.TypeItem,typeOperation:"DesignChange",width:$(l).css("width"),height:$(l).css("height"),top:$(l).css("top"),left:$(l).css("left"),angle:e($(l)),idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:$(l).attr("data-x"),dataY:$(l).attr("data-y")};if($(l).css({width:n.width.val()+"px",height:n.height.val()+"px",top:n.top.val()+"px",left:n.left.val()+"px",transform:"rotate("+parseInt(n.rotation.val())+"deg)"}),$(l).hasClass("pin-draggable")||($(l).attr("data-y",n.top.val()),$(l).attr("data-x",n.left.val())),$(l).hasClass("svg-draggable")&&"true"===$(l).attr("data-aspect-ratio")){var a=$(l)[0].style.transform;$(l)[0].style.transform="",$(l).css("height","");var i=$(l).find(".wrapper-svg");i.css("height","");var r=parseInt($(l).find("svg")[0].getBoundingClientRect().height/watching.scale);n.height.val(r),$(l).css("height",r),i.css("width",n.width.val()),i.css("height",r),$(l)[0].style.transform=a}if($(l).hasClass("svg-draggable")&&"false"===$(l).attr("data-aspect-ratio")){var o=$(l).find(".wrapper-svg");o.css("width",n.width.val()),o.css("height",n.height.val())}var s=Object.assign({},t);s.width=$(l).css("width"),s.height=$(l).css("height"),s.top=$(l).css("top"),s.left=$(l).css("left"),s.angle=$(l).css("transform"),UndoRedo.createElement(t,s),Canva.selectItem(currentData.IdItem),Canva.saveAll()}}else{var d=[],c=[];$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id"),n=t.attr("data-type");if("pin"!==n){var i={idItem:a,typeContent:n,typeOperation:"DesignChange",width:t.css("width"),height:t.css("height"),top:t.css("top"),left:t.css("left"),angle:"content"!==n?Canva.getRotationStyle(t):"deg(0)",idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:t.attr("data-x"),dataY:t.attr("data-y")};d.push(i)}}),$.each(Multidrag.multiElements,function(e,t){var a=t.attr("id"),i=t.attr("data-type");if("pin"!==i){"true"===t.attr("data-aspect-ratio")?t.css({top:n.top.val()+"px",left:n.left.val()+"px",transform:"content"!==i?"rotate("+parseInt(n.rotation.val())+"deg)":"deg(0)"}):t.css({width:n.width.val()+"px",height:n.height.val()+"px",top:n.top.val()+"px",left:n.left.val()+"px",transform:"content"!==i?"rotate("+parseInt(n.rotation.val())+"deg)":"deg(0)"}),"pin"!==i&&(""!==n.top.val()&&t.attr("data-y",n.top.val()),""!==n.left.val()&&t.attr("data-x",n.left.val()));var l={idItem:a,typeContent:i,typeOperation:"DesignChange",width:t.css("width"),height:t.css("height"),top:t.css("top"),left:t.css("left"),angle:"content"!==i?Canva.getRotationStyle(t):"deg(0)",idSlide:currentData.IdSlide,idGenially:currentData.IdGenially,dataX:t.attr("data-x"),dataY:t.attr("data-y")};c.push(l);var r={Id:a,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Size:{Width:t.css("width"),Height:t.css("height")},Position:{PositionLeft:t.css("left"),PositionTop:t.css("top")}};"content"!==i&&(r.Rotation={Rotatione:Canva.getRotationStyle(t)});var o="/api/"+i+"/SaveAll";ApiGenially.executeCall(r,o,"PUT")}}),UndoRedo.createElement(d,c)}},f=function(){null!==l&&(n.aspectRatio.prop("disabled",!1),r.width=parseFloat($(l).css("width").split("px")[0],10).toFixed(0),r.height=parseFloat($(l).css("height").split("px")[0],10).toFixed(0),r.top=parseFloat($(l).css("top").split("px")[0],10).toFixed(2),r.left=parseFloat($(l).css("left").split("px")[0],10).toFixed(2),r.rotation=t(l),n.width.val(r.width),n.width.parent("div.fg-line").addClass("fg-toggled"),n.height.val(r.height),n.height.parent("div.fg-line").addClass("fg-toggled"),n.top.val(r.top),n.top.attr("data-y",r.top),n.top.parent("div.fg-line").addClass("fg-toggled"),n.left.val(r.left),n.left.attr("data-x",r.left),n.left.parent("div.fg-line").addClass("fg-toggled"),n.rotation.val(r.rotation),n.rotation.parent("div.fg-line").addClass("fg-toggled"),"pin"===currentData.TypeItem?(n.width.prop("disabled",!0),n.height.prop("disabled",!0),n.top.prop("disabled",!1),n.left.prop("disabled",!1),n.rotation.prop("disabled",!0)):(n.width.prop("disabled",!1),n.height.prop("disabled",!1),n.top.prop("disabled",!1),n.left.prop("disabled",!1),n.rotation.prop("disabled",!1),"area"===currentData.TypeItem&&n.rotation.prop("disabled",!0)),n.setButton.prop("disabled",!1))},m=function(e){if(null!==e&&""!==e){if(l=$("#"+e),"pin"===currentData.TypeItem)return void DesignMode.cleanValues();f(),"content"===currentData.TypeItem||"area"===currentData.TypeItem?n.rotation.prop("disabled",!0):n.rotation.prop("disabled",!1)}},h=function(){return a},v=function(){n.area.hide()},y=function(){h()?n.area.show():v()},I=function(){try{h()?i.enabled?(v(),localStorage.designMode=!1,i.enabled=!1):(y(),localStorage.designMode=!0,i.enabled=!0):v()}catch(e){v()}Toolbar.hideAll(),Canva.hideAllMenusWithoutUnselect()},b=function(e){h()&&(i.enabled=e,localStorage.designMode=e,I())},C=function(){l=null,i.aspectRatio=!1,r.width=0,r.height=0,r.top=0,r.left=0,r.rotation=0,n.aspectRatio.prop("checked",!1),n.width.val(""),n.width.parent("div.fg-line").removeClass("fg-toggled"),n.height.val(""),n.height.parent("div.fg-line").removeClass("fg-toggled"),n.top.val(""),n.top.parent("div.fg-line").removeClass("fg-toggled"),n.left.val(""),n.left.parent("div.fg-line").removeClass("fg-toggled"),n.rotation.val(""),n.rotation.parent("div.fg-line").removeClass("fg-toggled"),n.aspectRatio.prop("disabled",!0),n.width.prop("disabled",!0),n.height.prop("disabled",!0),n.top.prop("disabled",!0),n.left.prop("disabled",!0),n.rotation.prop("disabled",!0),n.setButton.prop("disabled",!0)},x=function(){$(".up-design").removeClass("up-design"),n.area.addClass("up-design")},S=function(){n.width.prop("disabled",!1),n.height.prop("disabled",!1),n.top.prop("disabled",!1),n.left.prop("disabled",!1),n.rotation.prop("disabled",!1),n.setButton.prop("disabled",!1)},w=function(){a="undefined"!=typeof Storage,n.area=$("#designElement"),n.area.click(x),n.aspectRatio=n.area.find("#designAspectRatio"),n.width=n.area.find("#designWidth"),n.height=n.area.find("#designHeight"),n.top=n.area.find("#designTop"),n.left=n.area.find("#designLeft"),n.rotation=n.area.find("#designRotation"),n.setButton=n.area.find("#designSave"),n.menuButton=$("#moreOptions").find("#toggleDesignMode"),n.closeButton=n.area.find(".close-element"),n.toggleButton=n.area.find(".toggle-size");try{localStorage.getItem("designMode")===!0||"true"===localStorage.getItem("designMode")?(i.enabled=!0,y()):(localStorage.setItem("designMode",!1),i.enabled=!1)}catch(e){v()}n.area.draggable({containment:"parent",handle:".header",start:function(e,t){$(".up-design").removeClass("up-design"),$(e.target).addClass("up-design"),Toolbar.hideAll(),Canva.hideAllMenus()}}),n.setButton.click(g),n.menuButton.click(I),n.closeButton.click(I),n.toggleButton.click(o),n.width.off("focus",d).off("blur").on("focus",d),n.height.off("focus",d).off("blur").on("focus",d),n.width.on("keyup",s),n.height.on("keyup",s),n.aspectRatio.on("change",function(){this.checked?i.aspectRatio=!0:i.aspectRatio=!1})};return{init:w,isLocalStorageEnabled:h,showSettings:u,showDesignValues:p,setDesignMode:b,setDesignObject:m,showEditingObject:c,toggleDesignMode:I,showDesignMode:y,hideDesignMode:v,designDOM:n,multiDragging:S,cleanValues:C}}(),DesignLayers=function(){var e=[],t=!0,a=$("html"),n=$("#designLayers"),i=n.find(".layers-content"),l=n.find(".close-layers"),r=n.find(".toggle-size"),o=n.find(".remove-all"),s=$("#moreOptions").find("#toggleDesignLayers"),d=function(){return t},c=function(){$(".up-design").removeClass("up-design"),i.addClass("up-design")};n.click(c);var u=function(){n.hasClass("reduced")?(n.removeClass("reduced"),r.find("i").html("keyboard_arrow_up")):(n.addClass("reduced"),r.find("i").html("keyboard_arrow_down"))},p=function(){return e.length},g=function(t){for(var a=p(),n=!1,i=null,l=0;l<a&&!n;l++)e[l].idItem===t&&(n=!0,i=l);return i},f=function(t){for(var a=p(),n=!1,i=null,l=0;l<a&&!n;l++)e[l].idItem===t&&(n=!0,i=e[l]);return i},m=function(){function t(e,t){return t.zIndex-e.zIndex}e.sort(t)},h=function(){m(),$.each(e,function(e,t){var a=i.children("[zindex="+t.zIndex+"]");a.insertBefore($(".layer:eq("+e+")"))})},v=function(t){null!==t&&(e.push(t),i.append(Genially.templates.layer(t)))},y=function(t,a,n){if(null!==t&&""!==t){var l=i.children("[data-element="+t+"]");if(a?(l.addClass("animated slideOutLeft"),setTimeout(function(){l.remove()},1e3)):l.remove(),"undefined"==typeof n){var r=g(t);e.splice(r,1)}}},I=function(){var t=$(this).attr("data-element"),a=$("#"+t);$(this).hasClass("active")?(i.children("[data-element="+t+"]").removeClass("layer-hidden"),$(this).removeClass("active"),$(this).text("visibility"),a.removeClass("design-visibility"),e[g(t)].visible=!1,a.data("visible",!0)):(i.children("[data-element="+t+"]").addClass("layer-hidden"),$(this).addClass("active"),$(this).text("visibility_off"),a.addClass("design-visibility"),e[g(t)].visible=!0,a.data("visible",!1))},b=function(){var t=$(this).attr("data-element"),a=f(t);Canva.selectItem(t),$(this).hasClass("active")?(i.children("[data-element="+t+"]").removeClass("layer-locked"),$(this).removeClass("active"),Block.unBlockDiv(a,!0),e[g(t)].blocked=""):(i.children("[data-element="+t+"]").addClass("layer-locked"),$(this).addClass("active"),Block.blockDiv(a,!0),e[g(t)].blocked="active")},C=function(){var e=$(this).attr("data-element");swal({title:locale["delete"].titleConfirmDelete,text:locale["delete"].textConfirmDelete,type:"warning",showCancelButton:!0,confirmButtonColor:"#bc2360",confirmButtonText:locale["delete"].confirmButtonText,cancelButtonText:locale.generic.cancelButtonText,closeOnConfirm:!0},function(t){t&&Delete.removeItem(e)})},x=function(){var e=$(this).closest(".layer").data("element"),t=$("#"+e);currentData.IdItem!==e&&t.addClass("design-hovered")},S=function(){var e=$(this).closest(".layer").data("element"),t=$("#"+e);t.removeClass("design-hovered")},w=function(e){var t=$(this).closest(".layer").data("element");i.children(".layer").removeClass("layer-selected"),i.children("[data-element="+t+"]").addClass("layer-selected");var n=$("#"+t);n.hasClass("design-hovered")&&n.removeClass("design-hovered"),Canva.unselectItem(),Canva.selectItem(t),Block.checkBlock(),a.hasClass("multidrag")||(a.removeClass("tb-general tb-text tb-image tb-svg tb-pin tb-area tb-background"),"text"===currentData.TypeItem?(a.addClass("tb-general tb-text"),ToolbarText.changeDynamicElements()):"image"===currentData.TypeItem?(a.addClass("tb-general tb-image"),ToolbarImage.changeDynamicElements()):"svg"===currentData.TypeItem?(a.addClass("tb-general tb-svg"),ToolbarSVG.changeDynamicElements()):"pin"===currentData.TypeItem?(a.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements()):"area"===currentData.TypeItem?(a.addClass("tb-general tb-area"),ToolbarArea.changeDynamicElements()):"content"===currentData.TypeItem&&a.addClass("tb-general"))},k=function(e){i.children(".layer").removeClass("layer-selected"),i.children("[data-element="+e+"]").addClass("layer-selected");var t=i.children("[data-element="+e+"]").position().top;i.scrollTop(t)},D=function(t,a){var n=i.children("[data-element="+t+"]");a?(e[g(t)].blocked="active",n.addClass("layer-locked"),n.find(".action.locker").addClass("active")):(e[g(t)].blocked="",n.removeClass("layer-locked"),n.find(".action.locker").removeClass("active"))},T=function(e){var t=$(this).closest(".layer").data("element");Canva.selectItem(t),$("#magicWand").click()},P=function(t,a){var n=g(t),l=f(t),r=i.children("[data-element="+t+"]");r.attr("zindex",a),l.zIndex=a,e[n]=l,$("#fake-"+t).css({"z-index":a})},E=function(){if(0!==p()){for(var t=p(),a=0;a<t;a++)y(e[a].idItem,!1,!0);e.splice(0,t)}},G=function(){E();var e=$("#"+currentData.IdSlide),t=e.children("div").not(".slide-page-container");$.each(t,function(e,t){if("pin"!==$(t).data("type")){var a="",n="",i=t.id,l=$(t).data("type"),r=$(t).data("blocked")?"active":"",o=$(t).hasClass("design-visibility")?"active":"",s=parseInt($(t).css("z-index"),10);switch(l){case"text":n=$(t).attr("data-layer-title")?$(t).attr("data-layer-title"):"Text Element",a="title";break;case"svg":n=$(t).attr("data-layer-title")?$(t).attr("data-layer-title"):"SVG Element",a="wallpaper";break;case"image":n=$(t).attr("data-layer-title")?$(t).attr("data-layer-title"):"Image Element",a="wallpaper";break;case"content":n=$(t).attr("data-layer-title")?$(t).attr("data-layer-title"):"Rich Content",
a="airplay";break;case"area":n=$(t).attr("data-layer-title")?$(t).attr("data-layer-title"):"Interactive Area",a="crop_free"}var d={title:n,idItem:i,typeItem:l,icon:a,blocked:r,visible:o,zIndex:s};v(d)}}),h()},B=function(){d()&&localStorage.setItem("designLayers",!1),n.hide()},M=function(){d()&&localStorage.setItem("designLayers",!0),n.show()},O=function(){try{localStorage.getItem("designLayers")===!0||"true"===localStorage.getItem("designLayers")?(localStorage.setItem("designLayers",!1),B()):(localStorage.setItem("designLayers",!0),M())}catch(e){B()}Toolbar.hideAll(),Canva.hideAllMenusWithoutUnselect()},U=function(){$.each(e,function(e,t){})},A=function(){var e=$("#"+currentData.IdSlide),t=e.children("div").not(".slide-page-container");$.each(t,function(e,t){Multidrag.addElement($(t))}),Delete.removeMultiItems(),Canva.unselectItem()},R=function(){swal({title:locale["delete"].designLayersDeleteAllTitle,text:locale["delete"].designLayersDeleteAllContent,type:"warning",showCancelButton:!0,confirmButtonColor:"#bc2360",confirmButtonText:locale["delete"].designLayersDeleteAllConfirm,cancelButtonText:locale["delete"].designLayersDeleteAllCancel,closeOnConfirm:!0},function(e){e&&A()})},z=function(){function t(t){if($(t.target).text()!==$(t.target).attr("previous-title")){""===$(t.target).text()&&$(t.target).text("Untitled Layer");var a=$(t.target).parent(".layer").attr("data-element"),n=f(a),i=g(a);e[i].title=$(t.target).text(),$(t.target).attr("previous-title",$(t.target).text());var l={LayerTitle:$(t.target).text(),IdItem:n.idItem,TypeItem:n.typeItem,IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide};ApiGenially.executeCall(l,"/api/Layer/UpdateTitle","PUT"),$("#"+n.idItem).attr("data-layer-title",$(t.target).text())}}s.click(O),l.click(O),r.click(u),o.click(R),i.on("click",".visibility",I),i.on("click",".locker",b),i.on("click",".remover",C),i.on("click",".interactivity",T),$(".sortable").sortable({handle:".icon-identifier",axis:"y",placeholder:"ui-state-highlight",start:function(e,t){var a=$(t.item);a.addClass("sorting-layer")},stop:function(t,a){var n=$(a.item);n.removeClass("sorting-layer"),n.attr("style","");var l=p();$.each(i.children(".layer"),function(t,a){var n=$(a).attr("data-element");$(a).attr("zindex",l),e[g(n)].zIndex=l,$("#"+n).css("z-index",l),$("#fake-"+n).css("z-index",l),l--}),m(),ApiGenially.executeCall(e,"/api/ZIndex/ReorderLayerElements/","PUT")}}),i.on("dblclick",".title-identifier",function(e){$(this).attr("previous-title",$(this).text()),$(this).attr("contenteditable",!0);var t=window.getSelection(),a=document.createRange();a.selectNodeContents($(this).get(0)),t.removeAllRanges(),t.addRange(a),$(this).focus(),$("html").addClass("editing-layer")}),i.on("keypress",'.title-identifier[contenteditable="true"]',function(e){13===e.keyCode&&($("html").removeClass("editing-layer"),$(this).blur(),$(this).attr("contenteditable",!1))}),i.on("blur",'.title-identifier[contenteditable="true"]',function(e){$("html").removeClass("editing-layer"),$(this).attr("contenteditable",!1)});var a=_.debounce(t,2e3);i.on("keyup",'.title-identifier[contenteditable="true"]',function(e){a(e)}),i.on("mouseover",".layer, .visibility, .locker, .remover, .icon-identifier",x),i.on("mouseout",".layer, .visibility, .locker, .remover, .icon-identifier",S),i.on("click",".layer ,.icon-identifier, .tile-identifier",w)},F=function(){z();try{localStorage.getItem("designLayers")===!0||"true"===localStorage.getItem("designLayers")?(M(),t=!0):localStorage.setItem("designLayers",!1)}catch(e){B(),t=!1}n.draggable({containment:"parent",handle:".header",start:function(e,t){$(".up-design").removeClass("up-design"),$(e.target).addClass("up-design"),Toolbar.hideAll(),Canva.hideAllMenus()}})};return{init:F,pushLayer:v,removeLayer:y,countLayers:p,getLayerPosition:g,processLayers:G,clearLayerElements:E,displayLayerElements:U,getLayerElementById:f,sortLayers:m,reorder:h,showDesignLayers:M,hideDesignLayers:B,selectLayer:k,lockLayer:D,updateLayerZIndex:P,removeAllCanvas:R,layersContent:i,toggleDesignLayers:O}}(),Multidrag=function(){var e=[],t=function(){return e.length},a=function(t){currentData.IdItem=null,currentData.TypeItem=null,e.push(t),AnimationsEditor.disableEffects(),AnimationsEditor.disableCopyButton(),null!==AnimationsEditor.getCopyEffects()?AnimationsEditor.enablePasteButton():AnimationsEditor.disablePasteButton(),$("html").addClass("multidragging"),$("#tb-general").find("#generalZIndex").prop("disabled",!0)},n=function(){currentData.IdItem=null,"background"!==currentData.TypeItem&&(currentData.TypeItem=null),$("#"+currentData.IdSlide).find("div.multidrag-element").removeClass("multidrag-element"),$("div.multidrag-selector").remove(),e.splice(0,t()),$("html").removeClass("multidragging"),DesignMode.showSettings().enabled&&DesignMode.showDesignMode(),$("#tb-permanent").find("#permanentPaste").prop("disabled",!1),$("#tb-general").find("#generalZIndex").prop("disabled",!1)},i=function(a){currentData.IdItem=null,currentData.TypeItem=null;for(var n=0;n<=t();n++)$(e[n]).attr("id")===a.attr("id")&&e.splice(n,1);0===t()?($("html").removeClass("multidragging"),AnimationsEditor.enableEffects(),null!==AnimationsEditor.copyEffects&&AnimationsEditor.enablePasteButton(),DesignMode.showSettings().enabled&&DesignMode.showDesignMode()):$("#tb-permanent").find("#permanentCopy").prop("disabled",!0)},l=function(e){if(0===e.length)return!1;var t={IdGenially:currentData.IdGenially,IdSlide:currentData.IdSlide,Elements:e};ApiGenially.executeCall(t,"/api/MultiElement/SavePosition","PUT")},r=function(t){var a=!0;if("undefined"==typeof t){var n;return $.each(e,function(e,t){0===e?n=$(t).attr("data-type"):$(t).attr("data-type")!==n&&(a=!1)}),a}return $.each(e,function(e,n){$(n).attr("data-type")!==t&&(a=!1)}),a},o=function(){};return{init:o,multiElements:e,countElements:t,addElement:a,clearElements:n,removeElement:i,savePositioning:l,allSame:r}}(),SlideCreation=function(){function e(e,t){var a,n;e?(a=document.getElementById("slide-template-clone-"+t.Id),n=document.getElementById("container-template-clone-"+t.Id)):(a=document.getElementById("slide-side-clone-"+t.Id),n=document.getElementById("container-side-clone-"+t.Id)),fit(a,n,{hAlign:fit.CENTER,vAlign:fit.CENTER,cover:!1,watch:!1,apply:!0})}function t(e){var t=$.map(e,function(e){if("Tahoma"!==e.FontFamily&&e.FontFamily.indexOf("customgenially")===-1)return e.FontFamily}),a=$.unique(t);a.length>0&&window.WebFont.load({google:{families:a}})}function a(e,a){var n="";a.Images.length>0&&(n+=Genially.templates.image_clone(a.Images)),a.Texts.length>0&&(n+=Genially.templates.text_clone(a.Texts),t(a.Texts)),a.SvgImages.length>0&&(n+=Genially.templates.svgs_clone(a.SvgImages)),a.RichContents.length>0&&(n+=Genially.templates.richcontent_clone(a.RichContents)),a.Pins.length>0&&(n+=Genially.templates.pins_clone(a.Pins));try{e?($("#slide-template-clone-"+a.Id).append(n),SvgImages.printColorsSvgCustom($("#slide-template-clone-"+a.Id))):($("#slide-side-clone-"+a.Id).append(n),SvgImages.printColorsSvgCustom($("#slide-side-clone-"+a.Id)))}catch(i){}}var n=$(document.getElementById("slides-from-template")),i=n.find(".menu-item"),l=n.find(".search-box"),r=l.find(".search-geniallys"),o=$(document.getElementById("templates-slides")),s=o.find(".slides-of-template"),d=o.find(".close-window"),c=o.find(".add-this"),u=o.find(".add-all-slides"),p=o.find(".add-slides"),g=o.find(".creating-slides"),f=o.find(".clear-slides"),m=o.find(".amount-to-add"),h=o.find(".loading-content"),v=o.find(".actions"),y=[],I=!1,b=$(document.getElementById("geniallys-slides")),C=b.find(".slides-of-genially"),x=b.find(".close-window"),S=b.find(".add-this"),w=b.find(".add-all-slides"),k=b.find(".add-slides"),D=b.find(".creating-slides"),T=b.find(".clear-slides"),P=b.find(".amount-to-add"),E=b.find(".back"),G=b.find(".loading-content"),B=b.find(".actions"),M=b.find(".title"),O=[],U=$(document.getElementById("geniallys-folders")),A=U.find(".folders-of-geniallys"),R=U.find(".close-window"),z=U.find(".loading-content"),F=U.find(".open-this"),L=!1,H="/api/Genially",W="",j=function(){c=o.find(".add-this")},N=function(){S=b.find(".add-this")},Z=function(){F=U.find(".open-this")},X=function(){function t(t){var n=Genially.templates.template_slides(t);s.html(n),s.css("display","flex"),v.css("display","flex"),j(),t.slides.forEach(function(n){e(!0,n),a(!0,n),null!==t.genially&&null!==t.genially.SettingGenially.Weave&&$("#container-template-clone-"+n.Id).css("background-image","url("+t.genially.SettingGenially.Weave+")")}),h.hide(),I=!0}ApiGenially.executeCall({idTemplate:dataGenially.IdFromTemplate},H+"/TemplateSlides","GET",t)},Y=function(){function e(e){var t=Genially.templates.genially_folders({geniallys:e});A.html(t),z.hide(),A.css("display","flex"),Z(),L=!0}ApiGenially.executeCall("",H+"/Geniallys","GET",e)},V=function(){function t(t){M.text(t.genially.Name);var n=Genially.templates.genially_slides(t);C.html(n),C.css("display","flex"),B.css("display","flex"),N(),t.slides.forEach(function(n){e(!1,n),a(!1,n),null!==t.genially&&null!==t.genially.SettingGenially.Weave&&$("#container-side-clone-"+n.Id).css("background-image","url("+t.genially.SettingGenially.Weave+")")}),G.hide()}W&&""!==W&&null!==W&&ApiGenially.executeCall({idGenially:W},H+"/GeniallySlides","GET",t)},K=function(){n.removeClass("visible")},J=function(){n.addClass("visible"),ne(),oe(),I||X()},q=function(){n.hasClass("visible")?n.removeClass("visible"):n.addClass("visible")},Q=function(){switch(i.removeClass("active"),$(this).addClass("active"),$(this).attr("data-from")){case"template":U.removeClass("active"),b.removeClass("active"),o.addClass("active"),l.removeClass("enabled");break;case"genially":o.removeClass("active"),b.removeClass("active"),U.addClass("active"),l.addClass("enabled"),L||Y()}ne(),oe(),ue()},ee=function(){var e=$(this).attr("data-slide");$(this).hasClass("active")?($(this).removeClass("active"),y.indexOf(e)!==-1&&y.splice(y.indexOf(e),1)):($(this).addClass("active"),y.indexOf(e)===-1&&y.push(e)),0!==y.length?(m.html(y.length),f.addClass("enabled"),p.hasClass("enabled")||p.addClass("enabled")):(m.html(""),f.removeClass("enabled"),p.removeClass("enabled"))},te=function(){c.removeClass("active"),y=[],c.each(function(e,t){"0"!==$(t).attr("data-slide")&&($(t).addClass("active"),y.push($(t).attr("data-slide")))}),m.html(y.length),f.addClass("enabled"),p.addClass("enabled")},ae=function(){try{ga("send","event","NewSlideEvent-NEW","Button","FromTemplate")}catch(e){}var t=$(this);t.removeClass("enabled"),g.addClass("enabled"),y.forEach(function(e){return"0"===e?void Slide.newSlide():void Slide.newSlide(e)}),setTimeout(function(){$(".close-window").click(),t.addClass("enabled"),g.removeClass("enabled")},1500)},ne=function(){c.removeClass("active"),y=[],f.removeClass("enabled"),p.removeClass("enabled"),m.html("")},ie=function(){var e=$(this).attr("data-slide");$(this).hasClass("active")?($(this).removeClass("active"),O.indexOf(e)!==-1&&O.splice(O.indexOf(e),1)):($(this).addClass("active"),O.indexOf(e)===-1&&O.push(e)),0!==O.length?(P.html(O.length),T.addClass("enabled"),k.hasClass("enabled")||k.addClass("enabled")):(P.html(""),T.removeClass("enabled"),k.removeClass("enabled"))},le=function(){S.removeClass("active"),O=[],S.each(function(e,t){"0"!==$(t).attr("data-slide")&&($(t).addClass("active"),O.push($(t).attr("data-slide")))}),P.html(O.length),T.addClass("enabled"),k.addClass("enabled")},re=function(){try{ga("send","event","NewSlideEvent-NEW","Button","FromGenially")}catch(e){}var t=$(this);t.removeClass("enabled"),D.addClass("enabled"),O.forEach(function(e){Slide.newSlide(e)}),setTimeout(function(){$(".close-window").click(),t.addClass("enabled"),D.removeClass("enabled")},1500)},oe=function(){S.removeClass("active"),O=[],T.removeClass("enabled"),k.removeClass("enabled"),P.html("")},se=function(){b.removeClass("active"),oe(),U.addClass("active"),l.addClass("enabled"),M.text(""),G.show(),C.html(""),ue()},de=function(){var e=$(this).attr("data-genially");W=e,U.removeClass("active"),b.addClass("active"),l.removeClass("enabled"),ue(),V()},ce=function(){var e=r.val().trim();if(""===e)return void ue();e=removeDiacritics(e);var t=new RegExp(e,"ig");$.each(F,function(e,a){var n=removeDiacritics($(a).attr("data-name"));n.match(t)?$(a).parent(".genially").show():$(a).parent(".genially").hide()})},ue=function(){r.val(""),$.each(F,function(e,t){$(t).parent(".genially").show()})},pe=function(){d.click(K),s.on("click",".add-this",ee),u.click(te),p.click(ae),f.click(ne),x.click(K),C.on("click",".add-this",ie),w.click(le),k.click(re),T.click(oe),E.click(se),R.click(K),A.on("click",".open-this",de),i.click(Q),r.on("keyup",_.debounce(ce,300))};return{initialize:pe,showSlidesWindow:J,closeSlidesWindow:K,toggleSlidesWindow:q}}(),helper={beautifulInputText:function(){$(".fg-line")[0]&&($("body").on("focus",".fg-line .form-control",function(){$(this).closest(".fg-line").addClass("fg-toggled")}),$("body").on("blur",".form-control",function(){var e=$(this).closest(".form-group, .input-group"),t=e.find(".form-control").val();e.hasClass("fg-float")?0===t.length&&$(this).closest(".fg-line").removeClass("fg-toggled"):$(this).closest(".fg-line").removeClass("fg-toggled")})),$(".fg-float")[0]&&$(".fg-float .form-control").each(function(){var e=$(this).val();0!==e.length&&$(this).closest(".fg-line").addClass("fg-toggled")})},wavesButtons:function(){"undefined"!=typeof Editor&&Waves.attach(".btn:not(.btn-icon):not(.btn-float)"),Waves.attach(".btn-icon, .btn-float",["waves-circle","waves-float"]),Waves.attach(".waves-effect"),Waves.init()},getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=a.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},cleanData64:function(e){return e.split(",")[1]},validateEmail:function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},showTooltips:function(){$('[data-toggle="tooltip"]').tooltip()},overflowing:function(){$(".overflowing-text").hoverForMore({speed:60,loop:!1})},dropdowns:function(){$("body").on("click",".dropdown.open .dropdown-menu",function(e){e.stopPropagation()}),$(".dropdown").on("shown.bs.dropdown",function(e){$(this).attr("data-animation")&&($animArray=[],$animation=$(this).data("animation"),$animArray=$animation.split(","),$animationIn="animated "+$animArray[0],$animationOut="animated "+$animArray[1],$animationDuration="",$animArray[2]?$animationDuration=$animArray[2]:$animationDuration=500,$(this).find(".dropdown-menu").removeClass($animationOut),$(this).find(".dropdown-menu").addClass($animationIn))}),$(".dropdown").on("hide.bs.dropdown",function(e){$(this).attr("data-animation")&&(e.preventDefault(),$this=$(this),$dropdownMenu=$this.find(".dropdown-menu"),$dropdownMenu.addClass($animationOut),setTimeout(function(){$this.removeClass("open")},$animationDuration))})},inputMask:function(){$(".input-mask").mask()}},notify={message:locale.generic.ContentSave,type:"success",delay:2500,show:function(){$.growl({message:notify.message},{type:notify.type,allow_dismiss:!1,label:"Cancel",className:"btn-xs btn-inverse",placement:{from:"top",align:"right"},delay:notify.delay,animate:{enter:"animated bounceIn",exit:"animated bounceOut"},offset:{x:20,y:85}})}},defaultDiacriticsRemovalMap=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹÐ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"OE",letters:"Œ"},{base:"oe",letters:"œ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],diacriticsMap={},i=0;i<defaultDiacriticsRemovalMap.length;i++)for(var letters=defaultDiacriticsRemovalMap[i].letters,j=0;j<letters.length;j++)diacriticsMap[letters[j]]=defaultDiacriticsRemovalMap[i].base;var Loader=function(){function e(){function e(){return $.ajax({data:i,url:t,type:"GET",contentType:"application/json; charset=utf-8"})}function a(e){dataGenially=e,Editor.process()}function n(){var e="https://"+window.location.host+"/Home/Error?message=404";location.href=e}var i={id:currentData.IdGenially};e().done(a).fail(n)}var t="/api/Editor/GetGenially";return{loadData:e}}();Handlebars.registerHelper("content",function(){var e=this.Content,t="",a=5,n="",i="",l="";return null===e||"undefined"==typeof e?t=' data-id-slide-to-go="" data-link="" data-size-modal="" data-type="5" ':(a=e.TypeContent,n=e.SizeModal,i=e.Link,l=e.IdSlideToGo,t=' data-id-slide-to-go="'+l+'" data-link="'+i+'" data-size-modal="'+n+'" data-type="'+a+'" '),new Handlebars.SafeString(t)}),Handlebars.registerHelper("replaceCommaByPoint",function(e){var t=e.fn(this);return t=t.replace(",","."),new Handlebars.SafeString(t)}),Handlebars.registerHelper("positionPinLeft",function(e){var t=e.fn(this);return t-=16,new Handlebars.SafeString(t)}),Handlebars.registerHelper("positionPinTop",function(e){var t=e.fn(this);return t-=32,new Handlebars.SafeString(t)}),Handlebars.registerHelper("imageRender",function(e){var t=this.ImageRender;return t.indexOf("null")!==-1&&(t="https://genially.blob.core.windows.net/genially/backgroundStandard.png"),new Handlebars.SafeString(t)}),Handlebars.registerHelper("colors",function(e){var t=Handlebars.escapeExpression(this.ColorsCount),a="";switch(t){case"1":a="data-color-1="+this.Colors[0];break;case"2":a="data-color-1="+this.Colors[0]+" data-color-2="+this.Colors[1];break;case"3":a="data-color-1="+this.Colors[0]+" data-color-2="+this.Colors[1]+" data-color-3="+this.Colors[2]}return new Handlebars.SafeString(a)}),Handlebars.registerHelper("getbackground",function(e){var t="",a=this;return t+=null===a.SizeBackground.Width||null===a.SizeBackground.Height?"width: "+a.Size.Width+";height: "+a.Size.Height+";":"width: "+a.SizeBackground.Width+";height: "+a.SizeBackground.Height+";",t+=null===a.PositionBackground.PositionLeft||null===a.PositionBackground.PositionTop?"top: 0; left: 0;":"top: "+a.PositionBackground.PositionTop+";left: "+a.PositionBackground.PositionLeft+";",t+=null===a.OpacityBackground?"opacity: 1;":"opacity: "+a.OpacityBackground,new Handlebars.SafeString(t)}),Handlebars.registerHelper("getposition",function(e){var t="",a=this;return t=null==a.PositionBackground.PositionLeft||null==a.PositionBackground.PositionTop?'data-x="0" data-y="0"':'data-x="'+a.PositionBackground.PositionLeft.split("px")[0]+'" data-y="'+a.PositionBackground.PositionTop.split("px")[0]+'"',new Handlebars.SafeString(t)}),Handlebars.registerHelper("dataPosition",function(e){var t=' data-x="'+this.Position.PositionLeft.replace("px","")+'" data-y="'+this.Position.PositionTop.replace("px","")+'" ';return new Handlebars.SafeString(t)}),Handlebars.registerHelper("rotatione",function(e){var t=e.fn(this);return t=t.replace(/\s/g,""),""===t||"matrix(1,0,0,1,0,0)"===t||"matrix(1,0,0,1,0,0)"===t||"rotate(0deg)"===t||"rotate(0)"===t?new Handlebars.SafeString(""):new Handlebars.SafeString("rotated-item")}),Handlebars.registerHelper("fixRotatione",function(e){var t=e.fn(this);if(t.indexOf("matrix")!==-1)try{var a=t.split("(")[1].split(")")[0].split(","),n=a[0];n=Math.round(1e7*n)/1e7;var i=a[1];i=Math.round(1e7*i)/1e7;var l=i*-1;l=Math.round(1e7*l)/1e7;var r="matrix("+n+","+i+", "+l+","+n+",0,0)";return new Handlebars.SafeString(r)}catch(o){return new Handlebars.SafeString(t)}return new Handlebars.SafeString(t)}),Handlebars.registerHelper("fixFontFamily",function(e){var t=e.fn(this),a=t.trim();return new Handlebars.SafeString(a)}),Handlebars.registerHelper("getTypeContent",function(e){var t=this.TypeContent;return 6!==t&&5!==t&&null!==t&&"undefined"!=typeof t||(t=0),new Handlebars.SafeString(t)});var Selectable=function(){var e=$("html"),t=$("#wrapperHolder"),a=function(){var e=$("html");t.selectable({distance:3,selecting:function(t,a){if(!(e.hasClass("selected-items")||e.hasClass("dragging")||e.hasClass("resizing")||e.hasClass("rotating")||e.hasClass("editing-text"))){var n=$(a.selecting);n.hasClass("blocked")||n.hasClass("multidrag-element")||0!==n.find(".div-loader-image").length||"none"===n.css("pointer-events")||(n.hasClass("working")&&Canva.hideSelector(),Multidrag.addElement(n),n.addClass("multidrag-element"),n.prepend('<div class="multidrag-selector"></div>'))}},unselecting:function(t,a){if(!(e.hasClass("selected-items")||e.hasClass("dragging")||e.hasClass("resizing")||e.hasClass("rotating")||e.hasClass("editing-text"))){var n=$(a.unselecting);n.hasClass("blocked")||0!==n.find(".div-loader-image").length||"none"===n.css("pointer-events")||(Multidrag.removeElement(n),n.removeClass("multidrag-element"),n.find("div.multidrag-selector").remove())}},filter:".element-draggable, .pin-draggable",start:function(t,a){$("input[type=text]:focus, textarea:focus").blur(),e.hasClass("dragging")||e.hasClass("resizing")||e.hasClass("rotating")||e.hasClass("editing-text")||(e.hasClass("selected-items")&&(e.removeClass("selected-items"),Multidrag.clearElements()),e.removeClass("blocked"),Background.hideSelector(),Canva.hideAllMenus(),AnimationsEditor.enableMultiDrag(),Toolbar.hideAll(),e.addClass("multidrag multidragging selecting"))},stop:function(t,a){if(!(e.hasClass("selected-items")||e.hasClass("resizing")||e.hasClass("rotating")||e.hasClass("dragging"))){var n=$("#"+currentData.IdSlide).find(".ui-selected").not(".blocked").not(".div-loader-image"),i=$.grep(n,function(e){if("none"!==$(e).css("pointer-events")&&0===$(e).find(".div-loader-image").length)return e});i.length>0&&Multidrag.countElements()>0?($("#tb-permanent").find("#permanentCopy").prop("disabled",!1),Multidrag.allSame("text")?(e.addClass("tb-general tb-text"),ToolbarText.changeDynamicElements()):Multidrag.allSame("image")?(e.addClass("tb-general tb-image"),ToolbarImage.changeDynamicElements()):Multidrag.allSame("svg")?(e.addClass("tb-general tb-svg"),ToolbarSVG.changeDynamicElements()):Multidrag.allSame("pin")?(e.addClass("tb-general tb-pin"),ToolbarPin.changeDynamicElements()):Multidrag.allSame("area")?(e.addClass("tb-general tb-area"),ToolbarArea.changeDynamicElements()):Multidrag.allSame("content")&&e.addClass("tb-general"),e.addClass("multidrag multidragging selected-items"),n.removeClass("ui-selected"),DesignMode.multiDragging()):e.removeClass("multidrag multidragging selected-items"),setTimeout(function(){e.removeClass("selecting")},200)}}})},n=function(){try{t.selectable("destroy")}catch(e){}},i=function(){e.hasClass("touchevents")||a()};return{init:i,destroy:n}}();$(document).ready(function(){helper.beautifulInputText(),helper.inputMask(),helper.wavesButtons(),helper.overflowing(),helper.dropdowns(),$("html").hasClass("desktop")&&($("html").removeClass("touchevents"),$("html").addClass("no-touchevents")),CustomColors.loadCustomColors(function(e){Editor.start(),Background.init(),Toolbar.init(),InsertEditor.init(),IconPin.init(),Interactivity.init(),Area.init(),SaveDisplay.init(),SecondaryActions.init(),DesignMode.init(),DesignLayers.init(),Multidrag.init(),ToolbarPermanent.checkPasteStorage(),SlideCreation.initialize()})});var twttr,showMessage=!1,currentIdTextEditing=null,zoomScale=0,fitJs={},watching={scale:1,offsetX:0,offsetY:0},originalZoom=0,currentData={IdGenially:null,IdSlide:null,IdItem:null,TypeItem:null},dataGenially={},typeSubscriptionUser=parseInt($("#typeSubscription").val());$(window).resize(function(){return setTimeout(ZoomGenially.resetAllZoom(currentData.IdSlide),300),Editor.recalculate(),SecondaryActions.recalculate(),"text"===currentData.TypeItem&&$("html").hasClass("editing-text")&&!$("html").hasClass("touchevents")?void Text.finishEditingText():null!==currentData.IdItem?void Canva.selectItem(currentData.IdItem):void("background"===currentData.TypeItem&&setTimeout(function(){Background.resizeCorners()},100))});var Editor=function(){function e(){function e(e){var t=removeDiacritics(dataGenially.Name).toLowerCase();if("untitled genially"===t||"genially sin titulo"===t||"genially sans titre"===t)return e.preventDefault(),EventsEditor.askForName();try{ga("send","event","Behaviour","Download",$(this).attr("data-id-genially"))}catch(a){}}var t=dataGenially.SettingGenially;1!==dataGenially.TypeSubscription&&$("#export").hide();var a=$("#geniallyTitle").find("#inputGeniallyTitle");a.val(dataGenially.Name);var n=$("#durationVideoMode"),i=$("#bucleVideoMode");noUiSlider.create(n[0],{start:5,step:1,range:{min:1,max:20},tooltips:!0,format:wNumb({decimals:0,postfix:"s"})});var l=$("#selectDurationEffectIn");noUiSlider.create(l[0],{start:0,step:.1,range:{min:0,max:20},tooltips:!0,format:wNumb({decimals:1,postfix:"s"})});var r=$("#selectDurationEffectOut");noUiSlider.create(r[0],{start:0,step:.1,range:{min:0,max:20},tooltips:!0,format:wNumb({decimals:1,postfix:"s"})}),$(".label-example-tooltip").each(function(){Tipped.create($(this),{skin:$(this).data("tooltip-class"),behavior:"sticky",radius:!1})}),$("#settingPagination").prop("checked",t.ShowPage),1!==dataGenially.TypeSubscription&&($("#settingDrag").prop("checked",t.IsDraggable),$("#settingPaint").prop("checked",t.IsPaintable),$("#settingHideLogo").prop("checked",t.HideLogo),$("#settingLoadMobile").prop("checked",dataGenially.SettingGenially.LoadMobile)),$("#settingVideoMode").prop("checked",t.AutoPagination),$("#bucleVideoMode").prop("checked",t.BucleAutoPagination),t.AutoPagination&&(n.show(),i.show(),null!==dataGenially.TimePagination?n[0].noUiSlider.set(dataGenially.SettingGenially.TimePagination):n[0].noUiSlider.set(5)),$("#settingShare").prop("checked",!t.DisableShare),$("#settingFullScreen").prop("checked",t.FullScreen),$("#settingTitles").prop("checked",!t.DisableTitles),dataGenially.TypeSubscription>=2?$("#settingPrivate").prop("checked",dataGenially.Public):$("#settingPrivate").prop("checked",!0),!dataGenially.Public&&dataGenially.TypeSubscription>=2&&$("#settingPassword").show(),"light"===t.TooltTipStyle?($("#white-tooltip").prop("checked",!0),$("#black-tooltip").prop("checked",!1)):($("#white-tooltip").prop("checked",!1),$("#black-tooltip").prop("checked",!0)),null!==dataGenially.Description&&dataGenially.TypeSubscription>=2&&$("#descriptionGenially").text(dataGenially.Description),null!==dataGenially.Tags&&dataGenially.TypeSubscription>=2?$("#seoTags").val(dataGenially.Tags):($("#seoTags").hide(),$("#seoTagsFake").show()),dataGenially.TypeSubscription>=2&&($("#seoTags").show(),$("#seoTagsFake").hide()),3!==typeSubscriptionUser&&6!==typeSubscriptionUser&&$("#myLibrary").hide(),dataGenially.IdUser!==$("#idUser").val()?($("#export").hide(),typeSubscriptionUser>=2&&dataGenially.TypeSubscription>=2&&($("#proSettings").removeClass("opacity-05"),$("#proSettings").children(".premium-pro-only-overlay").remove()),(3===typeSubscriptionUser&&3===dataGenially.TypeSubscription||6===typeSubscriptionUser&&6===dataGenially.TypeSubscription||3===typeSubscriptionUser&&6===dataGenially.TypeSubscription||6===typeSubscriptionUser&&3===dataGenially.TypeSubscription)&&($("#premiumSettings").removeClass("opacity-05"),$("#premiumSettings").children(".premium-only-overlay").remove())):(dataGenially.TypeSubscription>=2&&($("#proSettings").removeClass("opacity-05"),$("#proSettings").children(".premium-pro-only-overlay").remove()),3!==dataGenially.TypeSubscription&&6!==dataGenially.TypeSubscription||($("#premiumSettings").removeClass("opacity-05"),$("#premiumSettings").children(".premium-only-overlay").remove())),1===dataGenially.TypeSubscription?$("#export").click(function(e){e.preventDefault(),$("#levelGeniallyUp").css("visibility","visible");var t=$("#premiumFeatureOnly").find("#levelGeniallyUp");t.attr("href","/Buy/Professional/"+currentData.IdGenially),$("#premiumFeatureOnly").modal()}):$("#export").click(e),$("#textFontFamily").find(".bfh-selectbox-filter").prop("placeholder",locale.generic.placeHolderFontSearch),localStorage.removeItem("previousTextColor")}function t(e){var t=[],a="",n="",i=$.grep(dataGenially.Slides,function(t,a){return t.Id===e});i[0].Images.length>0&&(a+=Genially.templates.image(i[0].Images),n+=Genially.templates.image_clone(i[0].Images)),i[0].Texts.length>0&&(a+=Genially.templates.text(i[0].Texts),i[0].Texts.forEach(function(e){"Press Start 2P"===e.FontFamily&&t.push(e.Id)}),n+=Genially.templates.text_clone(i[0].Texts)),i[0].Areas.length>0&&(a+=Genially.templates.area(i[0].Areas),n+=Genially.templates.area_clone(i[0].Areas)),i[0].SvgImages.length>0&&(a+=Genially.templates.svgs(i[0].SvgImages),n+=Genially.templates.svgs_clone(i[0].SvgImages)),i[0].RichContents.length>0&&(a+=Genially.templates.richcontent(i[0].RichContents),n+=Genially.templates.richcontent_clone(i[0].RichContents)),i[0].Pins.length>0&&(a+=Genially.templates.pins(i[0].Pins),n+=Genially.templates.pins_clone(i[0].Pins));try{$("#"+e).append(a),$("#slide-clone-"+e).append(n),t.length>0&&t.forEach(function(e){$("#"+e).css("font-family",'"Press Start 2P"')})}catch(l){}}function a(e){function a(e){var a=Genially.templates.holder(e);$("#wrapperHolder").append(a);var n=document.getElementById(e.Id),i=document.getElementById("slideHolder-"+e.Id),r=l.width(),o=l.height();$(i).css({width:r,height:o}),fitJs[e.Id]=fit(n,i,{hAlign:fit.CENTER,vAlign:fit.CENTER,cover:!1,watch:!0,apply:!0}),t(e.Id)}function n(e){var t=document.getElementById("slide-clone-"+e.Id),a=document.getElementById("container-clone-"+e.Id);fit(t,a,{hAlign:fit.CENTER,vAlign:fit.CENTER,cover:!1,watch:!1,apply:!0})}function i(e){var t=Genially.templates.slide(e);$("#slidesContent").append(t),
n(e)}var l=$("#wrapperHolder");if("undefined"==typeof e){var r=0;dataGenially.Slides.forEach(function(e){i(e),a(e,r),r++})}else i(e),a(e)}function n(){var e=$("#wrapperHolder");$(".slide-container").css({"max-width":e.width(),"max-height":e.height(),height:e.height()}),$(".slide-container-special").each(function(){var e=$(this).find(".slide-page");e.width()>$(this).width()&&($(this).removeClass("slide-container-special"),$(this).css({"overflow-y":"hidden"}),fitJs[e.attr("id")]=fit(e[0],$(this)[0],{hAlign:fit.CENTER,vAlign:fit.TOP,cover:!1,watch:!0,apply:!0}))});var t=$(".current-slide");t.addClass("current-slide"),setTimeout(function(){Editor.loadCurrentScale()},200)}function i(){currentData.IdGenially=$("#idGenially").val(),null===currentData.IdGenially&&window.location.replace("/Error"),Loader.loadData()}function l(e){e.length>0&&window.WebFont.load({google:{families:e}})}function r(){var e=localStorage.getItem("font-family"),t=[dataGenially.FontFamily];null!=e&&e.indexOf("customgenially")===-1&&(e=e.replace(/\ /g,"+"),t[0].indexOf(e)===-1&&(t[0]=t[0]+e)),1===t.length&&""===t[0]||t.length>0&&window.WebFont.load({google:{families:t}})}function o(){var e=window.location.hash;e=""===e?null:e.replace("#page-","");var t;if(null!==e&&document.getElementById(e)){t=$("#wrapperHolder").find("#slideHolder-"+e),t.addClass("current-slide");var a=$("#slide-side-"+e),n=e,i=$("#slideHolder-"+n),l=$("#slide-preview-"+n);l.addClass("current-slide-sidebar"),l.siblings("div.slide-actions").find("i.delete-slide").hide(),i.addClass("current-slide");var r=a[0].offsetTop;document.getElementById("slidesContent").scrollTop=r-180,currentData.IdSlide=e}else t=$("#wrapperHolder").find(".slide-container:first"),t.addClass("current-slide"),currentData.IdSlide=t.find(".slide-page:first").attr("id"),$("#slidesContent").find(".slide-preview:first").addClass("current-slide-sidebar"),$("#slidesContent").find(".slide-preview:first").siblings("div.slide-actions").find("i.delete-slide").hide();Canva.checkBackground()}function s(){$("html").hasClass("touchevents")&&$("#slidesContent").find(".slide").addClass("slide-touch")}function d(){var e=$("#"+currentData.IdSlide),t=e.offset().left-120,a=e.position().top,n=e[0],i=n.getBoundingClientRect().width/n.offsetWidth;watching.scale=i,watching.offsetX=t,watching.offsetY=a,Canva.computeCurrentPines()}function c(){dataGenially.TypeSubscription>=2&&$("#upgradeAccount").parent().remove()}function u(){$('[data-blocked="true"]').addClass("blocked").removeClass("").removeClass("element-draggable")}function p(){$("#slidesContent").find("li").size()>4&&$("#createNewSlideBottom").show()}function g(){var e=localStorage.getItem("autosaved-genially");null===e&&(notify.message=locale.saved.message,notify.type="inverse",notify.delay=5e3,notify.show(),localStorage.setItem("autosaved-genially","showed"));try{var t=navigator.sayswho,a=t.split("-"),n=locale.update.message;"Chrome"===a[0]&&parseInt(a[1])<50&&(showMessage=!0),"Firefox"===a[0]&&parseInt(a[1])<46&&(showMessage=!0),"Safari"===a[0]&&parseInt(a[1])<9&&(showMessage=!0),"Edge"!==a[0]&&"IE"!==a[0]||(showMessage=!0,n=locale.update.IE),showMessage===!0&&(notify.message=n,notify.type="inverse",notify.delay=1e4,notify.show())}catch(i){}}function f(e){var t='.slide-preview {background:url("'+e+'") !important;}',a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t)),a.appendChild(n)}function m(){null!==dataGenially.SettingGenially.Weave?($("#wrapperHolder").css({background:'url("'+dataGenially.SettingGenially.Weave+'")',"background-size":"cover","background-position":"50%"}),$("html").addClass("hasWeave"),f(dataGenially.SettingGenially.Weave)):$("#transparent-color").remove()}function h(){$(".new-slide-holder").width($(".to-clone-slide-goto").width());var e=$(".sidebar-clone-slide").width(),t=".state-highlight {width:"+e+"px !important;}",a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t)),a.appendChild(n)}function v(){Background.fetchCustomBackgrounds(),c(),a(),SvgImages.printColorsSvg(),r(),e(),CustomFont.loadCustomFonts("editor"),EventsEditor.attachEvents(),o(),s(),Canva.start(),d(),AnimationsEditor.start(),EventsEditor.loadCurrentBackground(currentData.IdSlide),ZoomGenially.start(),Text.start(),ZIndex.start(),TransitionSlides.start(),Settings.loadCurrentSize(),CopyPaste.start(),Images.start(),Center.start(),CropImage.start(),Resources.start(),Canva.computePines(),Pin.start(),u(),m(),Realign.start(),p(),DesignLayers.processLayers(),fitJs[currentData.IdSlide].trigger(),setTimeout(function(){d()},100),Selectable.init(),h(),$("#page-loader").fadeOut(),$(".card-iframe iframe:not(.twitter-timeline)").each(function(){$(this).css({height:$(this).closest(".content-element").height()}),$(this).addClass("loaded")}),"undefined"!=typeof twttr&&twttr.widgets.load(),dataGenially.IsCollaborative&&CollaborativeEvents.init(),"undefined"!=typeof Tawk_API&&(Tawk_API=Tawk_API||{},Tawk_API.onLoad=function(){$("#tawkchat-iframe-container").css("z-index","1")}),g()}return{start:i,process:v,recalculate:n,loadCurrentScale:d,loadSlides:a,loadNewFonts:l,blockElements:u}}();Handlebars.registerHelper("l10n",function(e){var t=locale,a=e.split(".");for(i in a)t=t[a[i]];return t});var CollaborativeEvents=function(){var e=function(){};return{init:e}}(),SaveDisplay=function(){var e,t=function(){$(e).hasClass("in-progress")||$(e).removeClass("saved").addClass("in-progress")},a=function(){$(e).hasClass("in-progress")&&setTimeout(function(){$(e).removeClass("in-progress").addClass("saved")},0)},n=function(){a(),notify.message=locale.error.message,notify.type="inverse",notify.delay=5e3,notify.show()},i=function(){a(),notify.message=locale.error.image,notify.type="danger",notify.delay=5e3,notify.show()},l=function(){e=$("#change-saver")};return{init:l,show:t,hide:a,showError:n,showErrorImage:i}}();this.Genially=this.Genially||{},this.Genially.templates=this.Genially.templates||{},this.Genially.templates.area_clone=Handlebars.template({1:function(e,t,a,n,i){var l,r=e.lambda,o=e.escapeExpression;return'<div id="fake-'+o(r(null!=t?t.Id:t,t))+'" class="area-clone-draggable" style="z-index: '+o(r(null!=t?t.ZIndex:t,t))+"; left: "+o(r(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+o(r(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+"; width: "+o(r(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+o(r(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+'; position: absolute; display: inline-block;">\r\n    <div class="wrapper-area"></div>\r\n</div>\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.image_clone=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c='<div id="fake-'+d(s(null!=t?t.Id:t,t))+'" style="width: '+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+d(s(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+"; z-index: "+d(s(null!=t?t.ZIndex:t,t))+"; transform: ";return r=null!=(r=a.fixRotatione||(null!=t?t.fixRotatione:t))?r:a.helperMissing,o={name:"fixRotatione",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l="function"==typeof r?r.call(null!=t?t:e.nullContext||{},o):r,a.fixRotatione||(l=a.blockHelperMissing.call(t,l,o)),null!=l&&(c+=l),c+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+'; position: absolute; display: inline-block;">\r\n    <img class="'+d(s(null!=t?t.Frame:t,t))+' cloned-img" src="'+d(s(null!=t?t.Source:t,t))+'" style="opacity: '+d(s(null!=t?t.Opacity:t,t))+';" />\r\n</div>\r\n'},2:function(e,t,a,n,i){var l;return e.escapeExpression(e.lambda(null!=(l=null!=t?t.Rotation:t)?l.Rotatione:l,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.image_new_clone=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c='<div id="fake-'+d(s(null!=t?t.Id:t,t))+'" style="width: '+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+d(s(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+"; z-index: "+d(s(null!=t?t.ZIndex:t,t))+"; transform: ";return r=null!=(r=a.fixRotatione||(null!=t?t.fixRotatione:t))?r:a.helperMissing,o={name:"fixRotatione",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l="function"==typeof r?r.call(null!=t?t:e.nullContext||{},o):r,a.fixRotatione||(l=a.blockHelperMissing.call(t,l,o)),null!=l&&(c+=l),c+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+'; position: absolute; display: inline-block;">\r\n    <img class="'+d(s(null!=t?t.Frame:t,t))+' cloned-img" style="opacity: '+d(s(null!=t?t.Opacity:t,t))+';" src="'+d(s(null!=t?t.Source:t,t))+'" />\r\n</div>\r\n'},2:function(e,t,a,n,i){var l;return e.escapeExpression(e.lambda(null!=(l=null!=t?t.Rotation:t)?l.Rotatione:l,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.pins_clone=Handlebars.template({1:function(e,t,a,n,i){var l,r=e.lambda,o=e.escapeExpression;return'<div id="fake-'+o(r(null!=t?t.Id:t,t))+'" class="pin-draggable-clone" style="left: '+o(r(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"px; top: "+o(r(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+'px;position: absolute; display: inline-block;">\r\n    <img class="'+o(r(null!=t?t.Size:t,t))+'" src="'+o(r(null!=t?t.Source:t,t))+'" />\r\n</div>\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.richcontent_clone=Handlebars.template({1:function(e,t,a,n,i){var l,r=e.lambda,o=e.escapeExpression;return'<div id="fake-'+o(r(null!=t?t.Id:t,t))+'" class="content-draggable-clone" style="z-index: '+o(r(null!=t?t.ZIndex:t,t))+"; left: "+o(r(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+o(r(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+"; position: absolute; display: inline-block; width: "+o(r(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+o(r(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+';">\r\n    <div class="content-element"></div>\r\n</div>\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.svgs_clone=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c=null!=t?t:e.nullContext||{},u=a.helperMissing,p="function",g=a.blockHelperMissing,f='<div id="fake-'+d(s(null!=t?t.Id:t,t))+'" '+d((r=null!=(r=a.colors||(null!=t?t.colors:t))?r:u,typeof r===p?r.call(c,{name:"colors",hash:{},data:i}):r))+' data-num-color="'+d(s(null!=t?t.ColorsCount:t,t))+'" class="';return r=null!=(r=a.rotatione||(null!=t?t.rotatione:t))?r:u,o={name:"rotatione",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.rotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' svg-clone-draggable" style="z-index:'+d(s(null!=t?t.ZIndex:t,t))+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+"; position: absolute; display: inline-block;transform: ",r=null!=(r=a.fixRotatione||(null!=t?t.fixRotatione:t))?r:u,o={name:"fixRotatione",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.fixRotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+';">\r\n    <div class="wrapper-svg '+d(s(null!=t?t.Frame:t,t))+'" style="width: '+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+d(s(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+"; opacity: "+d(s(null!=t?t.Opacity:t,t))+';">'+(null!=(l=s(null!=t?t.SourceSvg:t,t))?l:"")+"</div>\r\n</div>\r\n"},2:function(e,t,a,n,i){var l;return e.escapeExpression(e.lambda(null!=(l=null!=t?t.Rotation:t)?l.Rotatione:l,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.text_clone=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c='<div id="fake-'+d(s(null!=t?t.Id:t,t))+'" class="'+d(s(null!=t?t.Shadow:t,t))+" "+d(s(null!=t?t.Classes:t,t))+'" style="z-index: '+d(s(null!=t?t.ZIndex:t,t))+"; transform: ";return r=null!=(r=a.fixRotatione||(null!=t?t.fixRotatione:t))?r:a.helperMissing,o={name:"fixRotatione",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l="function"==typeof r?r.call(null!=t?t:e.nullContext||{},o):r,a.fixRotatione||(l=a.blockHelperMissing.call(t,l,o)),null!=l&&(c+=l),c+"; font-family: "+d(s(null!=t?t.FontFamily:t,t))+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+"; font-size: "+d(s(null!=t?t.FontSize:t,t))+"; color: "+d(s(null!=t?t.Color:t,t))+"; width: "+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; background: "+d(s(null!=t?t.Background:t,t))+'; position: absolute; display: block;">\r\n    <div class="text-wrapper" style="padding: '+d(s(null!=t?t.Padding:t,t))+';">\r\n        <div spellcheck="false" contenteditable="false" class="text-div" style="opacity: '+d(s(null!=t?t.Opacity:t,t))+';">'+(null!=(l=s(null!=t?t.TextMessage:t,t))?l:"")+"</div>\r\n    </div>\r\n</div>\r\n"},2:function(e,t,a,n,i){var l;return e.escapeExpression(e.lambda(null!=(l=null!=t?t.Rotation:t)?l.Rotatione:l,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.area=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c=null!=t?t:e.nullContext||{},u=a.helperMissing,p="function",g='<div data-html2canvas-ignore id="'+d(s(null!=t?t.Id:t,t))+'" data-layer-title="'+d(s(null!=t?t.LayerTitle:t,t))+'" data-blocked="'+d(s(null!=t?t.Blocked:t,t))+'" data-interactive="'+d((r=null!=(r=a.getTypeContent||(null!=t?t.getTypeContent:t))?r:u,typeof r===p?r.call(c,{name:"getTypeContent",hash:{},data:i}):r))+'" data-type="area" '+d((r=null!=(r=a.content||(null!=t?t.content:t))?r:u,typeof r===p?r.call(c,{name:"content",hash:{},data:i}):r))+' data-title="'+d(s(null!=t?t.Name:t,t))+'" ';return r=null!=(r=a.dataPosition||(null!=t?t.dataPosition:t))?r:u,o={name:"dataPosition",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.dataPosition||(l=a.blockHelperMissing.call(t,l,o)),null!=l&&(g+=l),g+' class="area-draggable element-draggable element" style="z-index: '+d(s(null!=t?t.ZIndex:t,t))+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+"; width: "+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+d(s(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+'; position: absolute; display: inline-block;">\r\n    <div class="wrapper-area"></div>\r\n</div>\r\n'},2:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.embed=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l,r=null!=t?t:e.nullContext||{},o=a.helperMissing,s="function",d=e.escapeExpression;return'<div class="card-genially" style="background-image: url(\''+d((l=null!=(l=a.background||(null!=t?t.background:t))?l:o,typeof l===s?l.call(r,{name:"background",hash:{},data:i}):l))+'\');">\r\n    <div class="card-body">\r\n        <div class="title-card">\r\n            <a href="'+d((l=null!=(l=a.url||(null!=t?t.url:t))?l:o,typeof l===s?l.call(r,{name:"url",hash:{},data:i}):l))+'" target="_blank">\r\n                <h1 class="title-card-text">'+d((l=null!=(l=a.title||(null!=t?t.title:t))?l:o,typeof l===s?l.call(r,{name:"title",hash:{},data:i}):l))+'</h1>\r\n            </a>\r\n        </div>\r\n        <div class="description-card">'+d((l=null!=(l=a.description||(null!=t?t.description:t))?l:o,typeof l===s?l.call(r,{name:"description",hash:{},data:i}):l))+'</div>\r\n        <div class="link-card">\r\n            <a href="'+d((l=null!=(l=a.url||(null!=t?t.url:t))?l:o,typeof l===s?l.call(r,{name:"url",hash:{},data:i}):l))+'" target="_blank">'+d((l=null!=(l=a.provider||(null!=t?t.provider:t))?l:o,typeof l===s?l.call(r,{name:"provider",hash:{},data:i}):l))+"</a>\r\n        </div>\r\n    </div>\r\n</div>"},useData:!0}),this.Genially.templates.embediframe=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l,r;return'<div class="card-iframe">\r\n    '+(null!=(r=null!=(r=a.html||(null!=t?t.html:t))?r:a.helperMissing,l="function"==typeof r?r.call(null!=t?t:e.nullContext||{},{name:"html",hash:{},data:i}):r)?l:"")+"\r\n</div>"},useData:!0}),this.Genially.templates.genially_folders=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=null!=t?t:e.nullContext||{},d=a.helperMissing,c="function",u=e.escapeExpression,p='<div class="genially">\r\n    <div class="preview open-this" data-name="'+u((r=null!=(r=a.Name||(null!=t?t.Name:t))?r:d,typeof r===c?r.call(s,{name:"Name",hash:{},data:i}):r))+'" data-genially="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'">\r\n        <div class="content-preview" style="background-image: url( ';return r=null!=(r=a.imageRender||(null!=t?t.imageRender:t))?r:d,o={name:"imageRender",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.imageRender||(l=a.blockHelperMissing.call(t,l,o)),null!=l&&(p+=l),p+')"></div>\r\n        <div class="name" title="'+u((r=null!=(r=a.Name||(null!=t?t.Name:t))?r:d,typeof r===c?r.call(s,{name:"Name",hash:{},data:i}):r))+'">'+u((r=null!=(r=a.Name||(null!=t?t.Name:t))?r:d,typeof r===c?r.call(s,{name:"Name",hash:{},data:i}):r))+"</div>\r\n    </div>\r\n</div>\r\n"},2:function(e,t,a,n,i){return e.escapeExpression(e.lambda(t,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},null!=t?t.geniallys:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.genially_slides=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=null!=t?t:e.nullContext||{},d=a.helperMissing,c="function",u=e.escapeExpression,p=e.lambda,g=a.blockHelperMissing,f='<div class="slide">\r\n    <div class="preview add-this" data-slide="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" id="container-side-clone-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'">\r\n        <div id="slide-side-clone-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" style="position: absolute; overflow: hidden; width: '+u(p(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+u(p(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+";background-color: "+u((r=null!=(r=a.BackgroundColor||(null!=t?t.BackgroundColor:t))?r:d,typeof r===c?r.call(s,{name:"BackgroundColor",hash:{},data:i}):r))+';">\r\n            <div style="width: '+u(p(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+u(p(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+';" class="slide-page-container">\r\n                <img src="'+u((r=null!=(r=a.Background||(null!=t?t.Background:t))?r:d,typeof r===c?r.call(s,{name:"Background",hash:{},data:i}):r))+'" class="slide-page-clone-container" ';return r=null!=(r=a.getposition||(null!=t?t.getposition:t))?r:d,o={name:"getposition",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.getposition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' style="position: absolute; ',r=null!=(r=a.getbackground||(null!=t?t.getbackground:t))?r:d,o={name:"getbackground",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.getbackground||(l=g.call(t,l,o)),null!=l&&(f+=l),f+'" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},2:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},4:function(e,t,a,n,i){return e.escapeExpression(e.lambda(t,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},null!=t?t.slides:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.gotoslide=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l,r=null!=t?t:e.nullContext||{},o=a.helperMissing,s="function",d=e.escapeExpression;return'<li data-id="'+d((l=null!=(l=a.Id||(null!=t?t.Id:t))?l:o,typeof l===s?l.call(r,{name:"Id",hash:{},data:i}):l))+'">\r\n    <div class="slide-preview-of goto-slide-list" id="goto-slide-'+d((l=null!=(l=a.Id||(null!=t?t.Id:t))?l:o,typeof l===s?l.call(r,{name:"Id",hash:{},data:i}):l))+'" data-id="'+d((l=null!=(l=a.Id||(null!=t?t.Id:t))?l:o,typeof l===s?l.call(r,{name:"Id",hash:{},data:i}):l))+'">\r\n        <span class="order-number-slide">'+d((l=null!=(l=a.Order||(null!=t?t.Order:t))?l:o,typeof l===s?l.call(r,{name:"Order",hash:{},data:i}):l))+'</span>\r\n        \r\n    </div>\r\n    <div class="slide-name">'+d((l=null!=(l=a.Name||(null!=t?t.Name:t))?l:o,typeof l===s?l.call(r,{name:"Name",hash:{},data:i}):l))+"</div>\r\n</li>"},useData:!0}),this.Genially.templates.holder=Handlebars.template({1:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},3:function(e,t,a,n,i){return e.escapeExpression(e.lambda(t,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l,r,o,s=null!=t?t:e.nullContext||{},d=a.helperMissing,c="function",u=e.escapeExpression,p=e.lambda,g=a.blockHelperMissing,f='<section id="slideHolder-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" data-id-slide="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" class="slide-container">\r\n    <div id="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" data-transition="'+u((r=null!=(r=a.Transition||(null!=t?t.Transition:t))?r:d,typeof r===c?r.call(s,{name:"Transition",hash:{},data:i}):r))+'" style="width: '+u(p(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+u(p(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+"; background-color: "+u((r=null!=(r=a.BackgroundColor||(null!=t?t.BackgroundColor:t))?r:d,typeof r===c?r.call(s,{name:"BackgroundColor",hash:{},data:i}):r))+';" class="slide-page">\r\n        <div style="width: '+u(p(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+u(p(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+';" class="slide-page-container">\r\n            <img src="'+u((r=null!=(r=a.Background||(null!=t?t.Background:t))?r:d,typeof r===c?r.call(s,{name:"Background",hash:{},data:i}):r))+'" class="background-slide-class current-background-slide blocked" ';return r=null!=(r=a.getposition||(null!=t?t.getposition:t))?r:d,o={name:"getposition",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.getposition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' style="position: absolute; ',r=null!=(r=a.getbackground||(null!=t?t.getbackground:t))?r:d,o={name:"getbackground",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.getbackground||(l=g.call(t,l,o)),null!=l&&(f+=l),f+'" />\r\n        </div>\r\n    </div>\r\n</section>'},useData:!0}),this.Genially.templates.image=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c=null!=t?t:e.nullContext||{},u=a.helperMissing,p="function",g=a.blockHelperMissing,f='<div id="'+d(s(null!=t?t.Id:t,t))+'" data-type="image" data-layer-title="'+d(s(null!=t?t.LayerTitle:t,t))+'" data-blocked="'+d(s(null!=t?t.Blocked:t,t))+'" data-interactive="'+d((r=null!=(r=a.getTypeContent||(null!=t?t.getTypeContent:t))?r:u,typeof r===p?r.call(c,{name:"getTypeContent",hash:{},data:i}):r))+'" '+d((r=null!=(r=a.content||(null!=t?t.content:t))?r:u,typeof r===p?r.call(c,{name:"content",hash:{},data:i}):r))+' data-effect-hover="'+d(s(null!=t?t.EffectHover:t,t))+'" ';return r=null!=(r=a.dataPosition||(null!=t?t.dataPosition:t))?r:u,o={name:"dataPosition",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.dataPosition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' data-effect="'+d(s(null!=t?t.Effect:t,t))+'" data-effect-out="'+d(s(null!=t?t.EffectOut:t,t))+'" data-effect-in="'+d(s(null!=t?t.EffectIn:t,t))+'" data-vel-out="'+d(s(null!=t?t.DurationOut:t,t))+'" data-vel-in="'+d(s(null!=t?t.DurationIn:t,t))+'" data-delay-in="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" data-delay-out="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" class="',r=null!=(r=a.rotatione||(null!=t?t.rotatione:t))?r:u,o={name:"rotatione",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.rotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' image-draggable element-draggable element" style="width: '+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+d(s(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+"; z-index: "+d(s(null!=t?t.ZIndex:t,t))+"; transform: ",r=null!=(r=a.fixRotatione||(null!=t?t.fixRotatione:t))?r:u,o={name:"fixRotatione",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.fixRotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+'; position: absolute; display: inline-block;">\r\n    <img class="'+d(s(null!=t?t.Frame:t,t))+'" data-title="'+d(s(null!=t?t.Name:t,t))+'" style="opacity: '+d(s(null!=t?t.Opacity:t,t))+';" src="'+d(s(null!=t?t.Source:t,t))+'" />\r\n</div>\r\n'},2:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},4:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayIn:t,t))},6:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayOut:t,t))},8:function(e,t,a,n,i){var l;return e.escapeExpression(e.lambda(null!=(l=null!=t?t.Rotation:t)?l.Rotatione:l,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.image_new=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c=null!=t?t:e.nullContext||{},u=a.helperMissing,p="function",g=a.blockHelperMissing,f='<div id="'+d(s(null!=t?t.Id:t,t))+'" data-type="image" data-layer-title="'+d(s(null!=t?t.LayerTitle:t,t))+'" data-blocked="'+d(s(null!=t?t.Blocked:t,t))+'" data-interactive="'+d((r=null!=(r=a.getTypeContent||(null!=t?t.getTypeContent:t))?r:u,typeof r===p?r.call(c,{name:"getTypeContent",hash:{},data:i}):r))+'" '+d((r=null!=(r=a.content||(null!=t?t.content:t))?r:u,typeof r===p?r.call(c,{name:"content",hash:{},data:i}):r))+' data-effect-hover="'+d(s(null!=t?t.EffectHover:t,t))+'" ';return r=null!=(r=a.dataPosition||(null!=t?t.dataPosition:t))?r:u,o={name:"dataPosition",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.dataPosition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' data-effect="'+d(s(null!=t?t.Effect:t,t))+'" data-effect-out="'+d(s(null!=t?t.EffectOut:t,t))+'" data-effect-in="'+d(s(null!=t?t.EffectIn:t,t))+'" data-vel-out="'+d(s(null!=t?t.DurationOut:t,t))+'" data-vel-in="'+d(s(null!=t?t.DurationIn:t,t))+'" data-delay-in="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" data-delay-out="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" class="',r=null!=(r=a.rotatione||(null!=t?t.rotatione:t))?r:u,o={name:"rotatione",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.rotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' image-draggable element-draggable element" style="width: '+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+d(s(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+"; z-index: "+d(s(null!=t?t.ZIndex:t,t))+"; transform: ",r=null!=(r=a.fixRotatione||(null!=t?t.fixRotatione:t))?r:u,o={name:"fixRotatione",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.fixRotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+'; position: absolute; display: inline-block;">\r\n    <img class="'+d(s(null!=t?t.Frame:t,t))+'" data-title="'+d(s(null!=t?t.Name:t,t))+'" style="opacity: '+d(s(null!=t?t.Opacity:t,t))+';" src="'+d(s(null!=t?t.Source:t,t))+'" />\r\n</div>\r\n'},2:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},4:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayIn:t,t))},6:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayOut:t,t))},8:function(e,t,a,n,i){var l;return e.escapeExpression(e.lambda(null!=(l=null!=t?t.Rotation:t)?l.Rotatione:l,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.layer=Handlebars.template({1:function(e,t,a,n,i){return"layer-locked"},3:function(e,t,a,n,i){return"layer-hidden"},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l,r=null!=t?t:e.nullContext||{},o=e.lambda,s=e.escapeExpression,d=a.helperMissing;return'<div class="layer '+(null!=(l=a["if"].call(r,null!=t?t.blocked:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:"")+" "+(null!=(l=a["if"].call(r,null!=t?t.visible:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))?l:"")+'" data-element="'+s(o(null!=t?t.idItem:t,t))+'" zindex="'+s(o(null!=t?t.zIndex:t,t))+'">\r\n    <div class="icon-identifier">\r\n        <i class="typeElement material-icons '+s(o(null!=t?t.typeItem:t,t))+'">'+s(o(null!=t?t.icon:t,t))+'</i>\r\n        <i class="dragIcon material-icons">drag_handle</i>\r\n    </div>\r\n<div class="title-identifier" contenteditable="false" spellcheck="false">'+s(o(null!=t?t.title:t,t))+'</div>\r\n    <div class="actions">\r\n        <i class="material-icons action interactivity" data-element="'+s(o(null!=t?t.idItem:t,t))+'" title="'+s((a.l10n||t&&t.l10n||d).call(r,"design.interactivity",{name:"l10n",hash:{},data:i}))+'">touch_app</i>\r\n        <i class="material-icons action visibility '+s(o(null!=t?t.visible:t,t))+'" data-element="'+s(o(null!=t?t.idItem:t,t))+'" title="'+s((a.l10n||t&&t.l10n||d).call(r,"design.hideAndShow",{
name:"l10n",hash:{},data:i}))+'">visibility</i>\r\n        <i class="material-icons action locker '+s(o(null!=t?t.blocked:t,t))+'" data-element="'+s(o(null!=t?t.idItem:t,t))+'" title="'+s((a.l10n||t&&t.l10n||d).call(r,"design.lock",{name:"l10n",hash:{},data:i}))+'">lock_open</i>\r\n        <i class="material-icons action remover" data-element="'+s(o(null!=t?t.idItem:t,t))+'" title="'+s((a.l10n||t&&t.l10n||d).call(r,"design.delete",{name:"l10n",hash:{},data:i}))+'">delete</i>\r\n    </div>\r\n    <div class="sorting">\r\n        <i class="material-icons action dragging">open_with</i>\r\n    </div>\r\n    <div class="clearfix"></div>\r\n</div>'},useData:!0}),this.Genially.templates.listpins=Handlebars.template({1:function(e,t,a,n,i){var l=e.lambda,r=e.escapeExpression;return'<img id="'+r(l(null!=t?t.Id:t,t))+'" data-category="'+r(l(null!=t?t.Category:t,t))+'" class="pin-item item" src="'+r(l(null!=t?t.Source:t,t))+'">\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.pins=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c=null!=t?t:e.nullContext||{},u=a.helperMissing,p="function",g=a.blockHelperMissing,f='<div id="'+d(s(null!=t?t.Id:t,t))+'" data-type="pin" data-x="'+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+'" data-y="'+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+'" data-interactive="'+d((r=null!=(r=a.getTypeContent||(null!=t?t.getTypeContent:t))?r:u,typeof r===p?r.call(c,{name:"getTypeContent",hash:{},data:i}):r))+'" '+d((r=null!=(r=a.content||(null!=t?t.content:t))?r:u,typeof r===p?r.call(c,{name:"content",hash:{},data:i}):r))+' data-effect-hover="'+d(s(null!=t?t.EffectHover:t,t))+'" data-effect="'+d(s(null!=t?t.Effect:t,t))+'" data-effect-out="'+d(s(null!=t?t.EffectOut:t,t))+'" data-effect-in="'+d(s(null!=t?t.EffectIn:t,t))+'" data-vel-out="'+d(s(null!=t?t.DurationOut:t,t))+'" data-vel-in="'+d(s(null!=t?t.DurationIn:t,t))+'" data-delay-in="';return r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" data-delay-out="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+'" data-title="'+d(s(null!=t?t.Name:t,t))+'" class="pin-draggable pin-element element" data-position="'+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+","+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+'" style="left: '+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"px; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+'px;position: absolute; display: inline-block;">\r\n    <img class="'+d(s(null!=t?t.Size:t,t))+'" src="'+d(s(null!=t?t.Source:t,t))+'" />\r\n</div>\r\n'},2:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayIn:t,t))},4:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayOut:t,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.preview=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l=e.lambda,r=e.escapeExpression;return'<div style="width: 100%;">\r\n    <div style="position: relative; padding-bottom: '+r(l(null!=t?t.PaddingBottom:t,t))+'%; padding-top: 0; height: 0;">\r\n        <iframe frameborder="0" width="'+r(l(null!=t?t.Width:t,t))+'" height="'+r(l(null!=t?t.Height:t,t))+'" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://view.genial.ly/Preview/Index/'+r(l(null!=t?t.Id:t,t))+"?idSlide="+r(l(null!=t?t.IdSlide:t,t))+'" type="text/html" allowscriptaccess="always" allowfullscreen="true" scrolling="yes" allownetworking="all"></iframe>\r\n    </div>\r\n</div>'},useData:!0}),this.Genially.templates.richcontent=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c=null!=t?t:e.nullContext||{},u=a.helperMissing,p="function",g=a.blockHelperMissing,f='<div data-html2canvas-ignore id="'+d(s(null!=t?t.Id:t,t))+'" data-layer-title="'+d(s(null!=t?t.LayerTitle:t,t))+'" data-blocked="'+d(s(null!=t?t.Blocked:t,t))+'" data-type="content" data-effect-out="'+d(s(null!=t?t.EffectOut:t,t))+'" ';return r=null!=(r=a.dataPosition||(null!=t?t.dataPosition:t))?r:u,o={name:"dataPosition",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.dataPosition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' data-effect-in="'+d(s(null!=t?t.EffectIn:t,t))+'" data-vel-out="'+d(s(null!=t?t.DurationOut:t,t))+'" data-vel-in="'+d(s(null!=t?t.DurationIn:t,t))+'" data-delay-in="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" data-delay-out="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+'" class="content-draggable element-draggable element" style="z-index: '+d(s(null!=t?t.ZIndex:t,t))+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+"; position: absolute; display: inline-block; width: "+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+d(s(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+';">\r\n    <div class="content-element">'+(null!=(l=s(null!=t?t.Source:t,t))?l:"")+"</div>\r\n</div>\r\n"},2:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},4:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayIn:t,t))},6:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayOut:t,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.shareiframe=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l=e.lambda,r=e.escapeExpression;return'<div style="width: 100%;">\r\n    <div style="position: relative; padding-bottom: '+r(l(null!=t?t.PaddingBottom:t,t))+'%; padding-top: 0; height: 0;">\r\n        <iframe frameborder="0" width="'+r(l(null!=t?t.Width:t,t))+'" height="'+r(l(null!=t?t.Height:t,t))+'" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://view.genial.ly/'+r(l(null!=t?t.Id:t,t))+'" type="text/html" allowscriptaccess="always" allowfullscreen="true" scrolling="yes" allownetworking="all"></iframe>\r\n    </div>\r\n</div>'},useData:!0}),this.Genially.templates.slide=Handlebars.template({1:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},3:function(e,t,a,n,i){return e.escapeExpression(e.lambda(t,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l,r,o,s=null!=t?t:e.nullContext||{},d=a.helperMissing,c="function",u=e.escapeExpression,p=e.lambda,g=a.blockHelperMissing,f='<li class="to-clone-slide-goto" data-id="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'">\r\n    <div class="slide" id="slide-side-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" data-order="'+u((r=null!=(r=a.Order||(null!=t?t.Order:t))?r:d,typeof r===c?r.call(s,{name:"Order",hash:{},data:i}):r))+'">\r\n        <div class="slide-actions">\r\n            <i data-id="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" class="material-icons duplicate-slide action" title="'+u((a.l10n||t&&t.l10n||d).call(s,"slide.duplicate",{name:"l10n",hash:{},data:i}))+'">content_copy</i>\r\n            <i data-id="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" class="material-icons delete-slide action" title="'+u((a.l10n||t&&t.l10n||d).call(s,"slide.remove",{name:"l10n",hash:{},data:i}))+'">delete_forever</i>\r\n        </div>\r\n        <div class="slide-preview" id="slide-preview-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" data-id="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'">\r\n            <span class="order-number-slide">'+u((r=null!=(r=a.Order||(null!=t?t.Order:t))?r:d,typeof r===c?r.call(s,{name:"Order",hash:{},data:i}):r))+'</span>\r\n            <div class="sidebar-clone-slide" id="container-clone-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" >\r\n                <div id="slide-clone-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" style="position: absolute; overflow: hidden; width: '+u(p(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+u(p(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+";background-color: "+u((r=null!=(r=a.BackgroundColor||(null!=t?t.BackgroundColor:t))?r:d,typeof r===c?r.call(s,{name:"BackgroundColor",hash:{},data:i}):r))+';">\r\n\r\n                    <div style="width: '+u(p(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+u(p(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+';" class="slide-page-container">\r\n                        <img src="'+u((r=null!=(r=a.Background||(null!=t?t.Background:t))?r:d,typeof r===c?r.call(s,{name:"Background",hash:{},data:i}):r))+'" class="slide-page-clone-container" ';return r=null!=(r=a.getposition||(null!=t?t.getposition:t))?r:d,o={name:"getposition",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.getposition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' style="position: absolute; ',r=null!=(r=a.getbackground||(null!=t?t.getbackground:t))?r:d,o={name:"getbackground",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.getbackground||(l=g.call(t,l,o)),null!=l&&(f+=l),f+'" />\r\n                    </div>\r\n\r\n                </div>\r\n            </div>            \r\n        </div>\r\n        <div class="slide-title">\r\n            <input type="text" data-id="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" contenteditable="true" maxlength="60" value="'+u((r=null!=(r=a.Name||(null!=t?t.Name:t))?r:d,typeof r===c?r.call(s,{name:"Name",hash:{},data:i}):r))+'" />\r\n        </div>\r\n    </div>\r\n</li>'},useData:!0}),this.Genially.templates.svgs=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c=null!=t?t:e.nullContext||{},u=a.helperMissing,p="function",g=a.blockHelperMissing,f='<div id="'+d(s(null!=t?t.Id:t,t))+'" data-layer-title="'+d(s(null!=t?t.LayerTitle:t,t))+'" data-blocked="'+d(s(null!=t?t.Blocked:t,t))+'" data-type="svg" '+d((r=null!=(r=a.colors||(null!=t?t.colors:t))?r:u,typeof r===p?r.call(c,{name:"colors",hash:{},data:i}):r))+" ";return r=null!=(r=a.dataPosition||(null!=t?t.dataPosition:t))?r:u,o={name:"dataPosition",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.dataPosition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' data-interactive="'+d((r=null!=(r=a.getTypeContent||(null!=t?t.getTypeContent:t))?r:u,typeof r===p?r.call(c,{name:"getTypeContent",hash:{},data:i}):r))+'" data-aspect-ratio="'+d(s(null!=t?t.AspectRatio:t,t))+'" data-num-color="'+d(s(null!=t?t.ColorsCount:t,t))+'" data-effect-hover="'+d(s(null!=t?t.EffectHover:t,t))+'" data-effect="'+d(s(null!=t?t.Effect:t,t))+'" data-effect-out="'+d(s(null!=t?t.EffectOut:t,t))+'" data-effect-in="'+d(s(null!=t?t.EffectIn:t,t))+'" data-vel-out="'+d(s(null!=t?t.DurationOut:t,t))+'" data-vel-in="'+d(s(null!=t?t.DurationIn:t,t))+'" data-delay-in="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" data-delay-out="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" class="',r=null!=(r=a.rotatione||(null!=t?t.rotatione:t))?r:u,o={name:"rotatione",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.rotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' svg-draggable element-draggable element" style="z-index:'+d(s(null!=t?t.ZIndex:t,t))+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+"; position: absolute; display: inline-block;transform: ",r=null!=(r=a.fixRotatione||(null!=t?t.fixRotatione:t))?r:u,o={name:"fixRotatione",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.fixRotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+';">\r\n    <div class="wrapper-svg '+d(s(null!=t?t.Frame:t,t))+'" data-title="'+d(s(null!=t?t.Name:t,t))+'" style="width: '+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+d(s(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+"; opacity: "+d(s(null!=t?t.Opacity:t,t))+';">'+(null!=(l=s(null!=t?t.SourceSvg:t,t))?l:"")+"</div>\r\n</div>\r\n"},2:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},4:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayIn:t,t))},6:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayOut:t,t))},8:function(e,t,a,n,i){var l;return e.escapeExpression(e.lambda(null!=(l=null!=t?t.Rotation:t)?l.Rotatione:l,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0}),this.Genially.templates.template_slides=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=null!=t?t:e.nullContext||{},d=a.helperMissing,c="function",u=e.escapeExpression,p=e.lambda,g=a.blockHelperMissing,f='<div class="slide">\r\n    <div class="preview add-this" data-slide="'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" id="container-template-clone-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'">\r\n        <div id="slide-template-clone-'+u((r=null!=(r=a.Id||(null!=t?t.Id:t))?r:d,typeof r===c?r.call(s,{name:"Id",hash:{},data:i}):r))+'" style="position: absolute; overflow: hidden; width: '+u(p(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+u(p(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+";background-color: "+u((r=null!=(r=a.BackgroundColor||(null!=t?t.BackgroundColor:t))?r:d,typeof r===c?r.call(s,{name:"BackgroundColor",hash:{},data:i}):r))+';">\r\n            <div style="width: '+u(p(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; height: "+u(p(null!=(l=null!=t?t.Size:t)?l.Height:l,t))+';" class="slide-page-container">\r\n                <img src="'+u((r=null!=(r=a.Background||(null!=t?t.Background:t))?r:d,typeof r===c?r.call(s,{name:"Background",hash:{},data:i}):r))+'" class="slide-page-clone-container" ';return r=null!=(r=a.getposition||(null!=t?t.getposition:t))?r:d,o={name:"getposition",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.getposition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' style="position: absolute; ',r=null!=(r=a.getbackground||(null!=t?t.getbackground:t))?r:d,o={name:"getbackground",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i},l=typeof r===c?r.call(s,o):r,a.getbackground||(l=g.call(t,l,o)),null!=l&&(f+=l),f+'" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},2:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},4:function(e,t,a,n,i){return e.escapeExpression(e.lambda(t,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l,r=null!=t?t:e.nullContext||{};return'<div class="slide">\r\n    <div class="preview blank add-this" data-slide="0">'+e.escapeExpression((a.l10n||t&&t.l10n||a.helperMissing).call(r,"slide.blank",{name:"l10n",hash:{},data:i}))+"</div>\r\n</div>\r\n"+(null!=(l=a.each.call(r,null!=t?t.slides:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:"")},useData:!0}),this.Genially.templates.text=Handlebars.template({1:function(e,t,a,n,i){var l,r,o,s=e.lambda,d=e.escapeExpression,c=null!=t?t:e.nullContext||{},u=a.helperMissing,p="function",g=a.blockHelperMissing,f='<div id="'+d(s(null!=t?t.Id:t,t))+'" data-layer-title="'+d(s(null!=t?t.LayerTitle:t,t))+'" data-blocked="'+d(s(null!=t?t.Blocked:t,t))+'" data-type="text" data-interactive="'+d((r=null!=(r=a.getTypeContent||(null!=t?t.getTypeContent:t))?r:u,typeof r===p?r.call(c,{name:"getTypeContent",hash:{},data:i}):r))+'" '+d((r=null!=(r=a.content||(null!=t?t.content:t))?r:u,typeof r===p?r.call(c,{name:"content",hash:{},data:i}):r))+' data-effect-hover="'+d(s(null!=t?t.EffectHover:t,t))+'" ';return r=null!=(r=a.dataPosition||(null!=t?t.dataPosition:t))?r:u,o={name:"dataPosition",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.dataPosition||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=' data-effect="'+d(s(null!=t?t.Effect:t,t))+'" data-effect-out="'+d(s(null!=t?t.EffectOut:t,t))+'" data-effect-in="'+d(s(null!=t?t.EffectIn:t,t))+'" data-vel-out="'+d(s(null!=t?t.DurationOut:t,t))+'" data-vel-in="'+d(s(null!=t?t.DurationIn:t,t))+'" data-delay-in="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" data-delay-out="',r=null!=(r=a.replaceCommaByPoint||(null!=t?t.replaceCommaByPoint:t))?r:u,o={name:"replaceCommaByPoint",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.replaceCommaByPoint||(l=g.call(t,l,o)),null!=l&&(f+=l),f+='" class="',r=null!=(r=a.rotatione||(null!=t?t.rotatione:t))?r:u,o={name:"rotatione",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.rotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+=" "+d(s(null!=t?t.Shadow:t,t))+" text-draggable element-draggable element "+d(s(null!=t?t.Classes:t,t))+'" style="z-index: '+d(s(null!=t?t.ZIndex:t,t))+"; transform: ",r=null!=(r=a.fixRotatione||(null!=t?t.fixRotatione:t))?r:u,o={name:"fixRotatione",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i},l=typeof r===p?r.call(c,o):r,a.fixRotatione||(l=g.call(t,l,o)),null!=l&&(f+=l),f+"; font-family:"+d(s(null!=t?t.FontFamily:t,t))+"; left: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionLeft:l,t))+"; top: "+d(s(null!=(l=null!=t?t.Position:t)?l.PositionTop:l,t))+"; font-size: "+d(s(null!=t?t.FontSize:t,t))+"; color: "+d(s(null!=t?t.Color:t,t))+"; width: "+d(s(null!=(l=null!=t?t.Size:t)?l.Width:l,t))+"; background: "+d(s(null!=t?t.Background:t,t))+'; position: absolute; display: block;">\r\n    <div class="text-wrapper" style="padding: '+d(s(null!=t?t.Padding:t,t))+';">\r\n        <div spellcheck="false" contenteditable="false" class="text-div" style="opacity: '+d(s(null!=t?t.Opacity:t,t))+';">'+(null!=(l=s(null!=t?t.TextMessage:t,t))?l:"")+"</div>\r\n    </div>    \r\n</div>\r\n"},2:function(e,t,a,n,i){return" "+e.escapeExpression(e.lambda(t,t))+" "},4:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayIn:t,t))},6:function(e,t,a,n,i){return e.escapeExpression(e.lambda(null!=t?t.DelayOut:t,t))},8:function(e,t,a,n,i){var l;return e.escapeExpression(e.lambda(null!=(l=null!=t?t.Rotation:t)?l.Rotatione:l,t))},compiler:[7,">= 4.0.0"],main:function(e,t,a,n,i){var l;return null!=(l=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?l:""},useData:!0});